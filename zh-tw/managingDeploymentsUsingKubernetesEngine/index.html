<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<title>使用 GCP Kubernetes Engine 來管理部署 - Ray&#39;s Coding Journey</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="概述Dev Ops 實踐通常使用多重部署的方法來管理應用部署情境, 像是 “持續部署”, “Blue-Green 部署”, “Canary 部署”, 等等… 本教程主要提供擴充以及管理容器的方法, 所以你可以完成這些使用多重部署的通用情境。">
<meta name="keywords" content="QWIKLABS,GCP Kubernetes Engine,Kubernetes,Cloud Architecture,Kubernetes in the Google Cloud">
<meta property="og:type" content="article">
<meta property="og:title" content="使用 GCP Kubernetes Engine 來管理部署">
<meta property="og:url" content="https://tn710617.github.io/zh-tw/managingDeploymentsUsingKubernetesEngine/index.html">
<meta property="og:site_name" content="Ray&#39;s Coding Journey">
<meta property="og:description" content="概述Dev Ops 實踐通常使用多重部署的方法來管理應用部署情境, 像是 “持續部署”, “Blue-Green 部署”, “Canary 部署”, 等等… 本教程主要提供擴充以及管理容器的方法, 所以你可以完成這些使用多重部署的通用情境。">
<meta property="og:locale" content="zh-tw">
<meta property="og:image" content="https://lh3.googleusercontent.com/JoxRKMMSKbzKyCJ83rgcHWsp0GqmDd4VJyA2JHttJIWtbeuSIiuLjuSSxc4iqePChDXbxGcLwlK2Ak3L_XKUbYDDc02KsoQczJQUjhf54Va0RDUXYR3Rs41gZ6chzqI4yNHMtFh8n21uoOrorZxFgQW_zUF7DxoFbP2cud5EQHISGuRo46oC3y4twF9RdpS0TSSA4olJ7qOJOWkyI6BVt4W3xNBLoNQe1KpHMsh4yZmNy62qzpIPZzG6mOyWJhxoeQgDv_AJMUZeePJb07cQRL0A1Z2o4BOmY2yDMeQxeo6zLOUa2YQn03IyyXmRkOHITivPHxEUNTRwRpx692JGJ0xLiRXaTrR3zUHIshdqfeUgqqpu3IzBEyFeQf_uuq3SBcVam2n-82KYWus0e9V9JyPdc57OK88fPGEv2FQ8gL3BphZ2cGk4m8-r2aZlcUu8eyAc3xf0ggMczseovjEtSj-Yd3hf7qMhQj6kczUUNLQ3bzF5Xj3X_w4frm5zaeGneTpLzM3R0rCa1OG-97DkR22YNXTSZoAHeEyH6i5TIWUjLQZfUFgAaDe7yHFFFv6ykMXIosO0hR93UeNtSxfkwBmZ1YSvIM_GBF4u5kSqRJkiPkIv0wso8tkk6Lu0lrvEPMUDeLwu_c_7AM-gq0GPkFdXF4Q4ED4=w297-h293-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/7d6Sw0e-DdZsWhuQG4LieT4RhHJlEIYZ3PbCTTS9B1rLivIvMY7G-VFuy-sQl3bbaNBlVoWipPwQyAWu-oPHUEQYIU5WOnfxflf5JtqsPiaRjQZ32Euuzo5_GqdSZ_hTaGyOBdVq8PzLfoT0RXQGIIEX5GJpnQvm1H8V9VD54X7RACmwemGHdHnOIN3OEYaYDTu3tfMD7NMlmlxvfs4aw1ZuKKGg52cuhwFZQB8e-uOFILtjRwvlJLVEO_iwmv8DDefMd6bIJDh6UdkunTMPcozfKT1muTgaqD1ie8LlaXUgHg5Uqnk9peB7yFejJfL-AwG44agBDOehNad2fJZAIb10HF8ZsAv0_JM-MJzSGbNQ3GK8J0ghFWu1qCNA5udefx6IXzX3vcDz92ArWjSz1QyNBErc2Zkj8YAA5Mfa0CRdFqTmOfXdxt73q7dpQup3zu5aASM4lh37l6SMCQ1ZVy07vcYvCL1mFnQ_hjc4Dg0SqdI7SvravdzmNO3ZEsumpEYgaIIJsnkRU7tzOrmZbV8hH__b90cAkfAamsPmVlgp9sZIwqUzptuDvuPEDyBPBYZC4o9eo5KyQahlTN1grAvzKkPMKYNQfiuKZKch1vpV24M0zuvjgRZFUQnz3V2ERzreJVNRaT_REMv6ifmf1RetnnHYIHg=w356-h248-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/LTqcvw12A83DFUA6wBwrvyfkCfqOXSzirXjbsH-F2lXQSFeA-RLHZ7-OwmSo2KRMIyh4aeOIM3sH7OEcgtvyRBhBZ3XUT0KeCA6JCziJfbwWoHeo_yQJEM6L0yNrsOxxvYsTfi7vc0JcG2PCq16I_-VapQeMzCUG4YHfQ05FMXM_Qbk3Q5AS_Gz37Qnnb2LBnS_FEq6xB1P5JZQPg0ewtkXL_w4uzxXBuiTF20FD5Wmvozjka_hHRPg7sNNv_s7Gl5QozEPvCLluVaulnZRr_EgqkMDsFhAYQo6f40EJ3d2G7h-teXuZxzGUNNauapux1XG54aCL-dbHexnOLC-_zPGhCJcU8s51SPLH_-mscGdvTbSmM1bfacQb4jqn28Ce0YTeFk_GdKE_Yc1uBhzv7AX3hPI47EtVMoDTN1S_4VRalxoaCGMW1W8weYxiVOKvqvts_vKrXPNcQhID-XGtTLRbMxHVVJQM_CZVLMdbIS04olUmWMompFUREpOdVvogPOxCeMNiOZOrjY8I53D6SdKdDjepyNBVHpD1U9clBS88hczGUhhZbEMDqM5V91GG0OmpcFu0vgc0vnAhmpBvcUrA4xf0_16Nxq3fxYky9x7xLLUXS12pIfLwShDt9RWhU8hiDDTzGkugZB294m_e1d4rjHxTiOw=w1172-h266-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/NQiAOvTG-8VLhp5DpNDvWH8j61jQ_9siMi_WMu8ZkujJnJ1nDCddW6e25xxpJykZi9CppWFX3PUbQ-1DOGAVO68NF_qXSOB0ne3apVKL3-x-CFbxxOjDc6FMZ6QK6Xq9cOX1WRgLxk76IhOWGZq4KQ2JOpE6XcH8CMWaowuunUPBLURUdnYWsEh_uanRFPwvabcbMGDgaU8Y-rXOTlMaiC8rBanZtz94OziyEuW8quqpTUb0t9zsLb9WwbZn3dQzC7nK7IBwZ4Hn_F9oeTtGk4RWpd-C0GdqHeDvobjExPIKjkIaO1n56PZHPbkBIZi8ltEAEaR8IRp31u2ryYpKSDFtobrWVA4Px9zI1FyWed-MhwoCJVX2KE-8LJEahoYgO-d43oi_bolFsiCmjEkJj5q9UWeIF3SapHHZj3rHUtV3WRnlpP32UWXnltfOpaDvFfSgDC_IukM_uwrn64VHRo0mwyCPM8jZM280GWdg2CGJOLBf8T4tq-5Tj71vBj3toOtfcHYSa0_fTBfCwfQUeuzR3qncAHKYk0N7TVIxtcTQdmQX9fVTI3lB0ngg_suUB5NWIErLkfGhHpxNO5m6Iji5h1tBl4Cx3UqTBpqbQD4qqmuDpfYqjjxfyymoTGDGuFvYlyheBnx6LYz4R-5WTcgwpL06OCs=w1172-h266-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/NsZ_a6EE077gPoIPQHGUyv3oi-CS0ZXvCCqcqQRSHXNB5NJP_532CiuaTBPpV3bC6WZK9mP5xuRCsIQCHERH-qJc5Ez1ISujFlCPJXBgAPZSTi_vg7pQKIQwEDei7UrjelpPIFpu8nj5c48WcLyn7iy8ZB5rW1jMCCnaICN9ckEPST_Bq4mum0WyDA0vbxZ6s_prBqRwHP7BYqK-yv5LY5WU2Cp_u58T2EVXS-TJ3b460s-PNEaKgPC6SoCpdamnW9VY2YzsvCycviBIODgAH-pvIZf7AppQsTWF7fe9d6JLq0yvBT3fnO4isK-Tu_i3ZlzIHyb5Ccmb4oYBzt42FIm9NmgUF0sDhiVEi3y2qgts7aU-5S3Sd85uv1N9qVuHZqTcuZk0uNgAfjfKfZN6clp4JFcf-CsZWPxZOJ5QdxSFG8wKAxz02vgiQdopj-R9SEEBR--TikL2KiSl2zHFqmegWol-8TYaLQSI4ZKKRqgzrsLuDvf_nw3Z9RqvX-4_P7HY9cqmaRDIkwK5pP-KF0gOjurvuRRmbGpdSpNCbM7cVZbyCpQgV28UdUdLdd0N-7xHa2QT1hVJnVGwmn3e7dMdc5PuTnJ6TMm6h0mcLKVdvqF7cInxrhsqBrvGj1VAZwY5ej4O4VPF1r0XAEH7bnD4HqSXMWg=w993-h696-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/67XYRFIt0PZG-lcSS21Eum9KeVPQBBSZ6WedKsA578qdHbCrs43df3Url887daqVpEm5xJTYmhlu3g1IVQFf8QOwIU01QWXSqybAnT9oRhjnx31l9ykNLa_hJCc9Szr1ODStfEd7hEXnlknqkrawQx9KWHIVAfYQsv36VXHzNh8CFRRYC96L8G8TnWUh-3GDiijvkBIg30jPWDCXrcre6bKvQmiOS8RIdhYsmh8KaYXYsMJQ83pWyQeKaTkY8fAcwnuFHTLt1Fx6lVolrSIUFqTH7N_snLcLxqVVnBcr9jBWN_cz-hGEyNzYPCq-GR1XjY8REeisXM9wskHXtYKBIwzyIpSkrZqSF-yJ5Y83UL55nQQ3aqK1gPOMizYbApEBfVEEOai-o9bO9hiSgAzg2oNckT3e7zRNeak5WUe41e1RPK8qvZIRPgUDfTWAUhBJgYPFfzQtI-HC4M_6G8Cj9y_W1DWtc9h8MnEbdBU2ARIWEsOBPhGEIrVCfWjIFk_wg13j3SidpqUXvjy8oqoDhwzJ_dnrntwL_o22ZBn0wxzdhjltdIjAB079f19G6PqRcxtNHVfwn9J4BTliJ4JYDx_13LkVArVmi1o8ZmnBuBb-99qBscIcj1qPrGSVbE-f2AQ7to7pSZHuFpn0BuHrQNDYcfnqePs=w1267-h196-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/d4G9ykFcKqCjqjPHh1jlatPIjYqhEiUwG-TkSziSe4-iw8ZCfFEPKQmIIHDBTBi78bxRkT3OA-WflhAgJoDglVYk9_GHLt8YM8gSmkfpO2iuJ-RYeRHyHMl_gOJm58iTBAHff0YjRLI=w1280-h212-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/YulZo3ShEh4j29_yM-q2baQ4MOFyS7FABLffcW_ST_GHe_DfxAOxYfHaqwgyWgaQqzbkSHObqd7DUMdW0EsUgABuyv_bFNEoYOEhkR8k36eBTuCF6R_HFRgbhHXUlEVyaDv_aMZ39qeqTgDVT2kA6YoSdrj7qTdSGGdINcBEfmKIWTQksRYsEKXZuzMkODP9XCmRifEfT8PBy9csNJzcDbPZlllfhaBP8IDHzLkss_Y6V4lGR1KlVhSpu-_fNJVgQx-LUZeclOEAmN_7JqzD8xzG8KOaQ219BLiOMZWaSglq91mySEsjummJAgvsXOB7tBYpFEqV8DnfVvbKpgSzeAPaiAF1qbAnqXEbq9XVvjnN90DEdoPAAzrootk1PDyI6HqTJRE7v4YW8RK1NwWofW5XT5X5l-aMesm9G4WaBWBluYuMtPRqhZtvKPo5Oe4MT43a_W3SaLe7AP2rcke6asgQP8QRotDzOUz7pie7OPhte3ZroG5vFoatpZD4NBdCTsVPRhhEGGSVolaADK1kO2Fesc6ZJakdajY6ngTzdADCRP6Min6EqNc84a9tnmZLGOGygWpe_5d9Jf1KQo06ebWEMVQt04VE2nyUFpP1FcVGNvrR6ZCEsP00xOx9sKfrWrvVQAmGxsCYKlxJCCyqMFk8J_fLf1XNtR6uMk1S4YB4UqVx-qeKvVru2wKF8NPw3xIc_G9BJWihIjprqOmxtrHtD4GJE0G9Twyqpenv0KJ0zUvJ=w1174-h595-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/dByaqOMAot2uFVvVC8d3Bbl9FCl-5V-ZFK85nASWb4p2n4zOLP9Y8w5wSbd7lO3iCMnInISZy1k6Mp_EZ4r543fpK9VaqeP5J7MOd2125Y-1Rx6VP_DV43Wc8PI0XTv_EV_j6c_6NK2M91ov7CTi3a_EsySUshTsB4V7dhteawMmI-x9rrbYt8MCks2gPslZ95uWqGby7nfqz8nPsQPPgTydHIaIBqpDTQ-hKy3VAQQrzoijsmeP0xcNR1LzkjWPgA_hitR4o5JffXXoCJINFRfdS-8ze3PnnpXZWNeD-_KSDSkvIM5uDDrjCGqr_kz-nvF3dRNz-EyRW0-sjjGHga0ypbdv_HmP7vCKR1wWM80vd9Jjyzhd5729vlRzP2mYXyM9UQq_l3teIZUgs8n09mVQtQUlSlnHVUF-nKpI_92k_q1uEN4Wtlp1prB2YmxAgV3Neu8fGcrFXGBkJfzlT6GU80nhKb821wNXRUQF7biqzJrvUvDbFnef6GNJ5hieG4YsB4sNpWIQ2wBwO28Vn-t2sXrridjc-Vfwl1BwRlyO6pKMeN0OnZ7st4S4gUHcvlkd3AKkIVLDnJikZo8hI6vRDRfWz9r28HpeldbSiZPgiIpfHlIgvXIqVS-g9PqknY9ohNH_E5RS7bUuSIDKaCrD61b4hdXSPgFXoaoz2PC0_zbJHKgphg1loxOgYa8ATKtUwBTkIMbxDBSNxNhS4QmL1nB7ZA0xcwt1eVCYbjp5-8cC=w945-h618-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/4wsgxe7rn5pd6x5vPWs9SQs0lYcr8ZIdphNq4nlj7ClovmXhK7cmTMHyvXQe6b7UsgN_XK74hTJZ2b3IraF8osHaruM8LGuGWeW_i4Cx6orFHCT2wDJWesEWCpVbcb6q6tq1o9a1lHQ=w1280-h212-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/eOaxMaMwxTAAH-o6CkzzGIW49fQa2L5W6L8Mrb8nrGVgwdl_-PU-4HOJie0OTZhq8o4zlhZQLhUPALaE_heyXkqs5l-sqlUYwLXe2-e35TlcYv0li_YNNE5ZU5phxTATrd8fZ3LbacCEvLwJaGbY-zx6ucd1dN-Z6j8P2UHfYmykdE4PISQeKelLdkW7zuaOKxW5E0ZRn69bfXDgo0EYqDbi50obj7pfRALc5WRSRjy-P_BlOrQ547QnH3zpKn0-T6S-o7CbFGk5wPcPOG3DMh7yA49STT7ixlRekZDIca8Oefqq7o7WcpvSYmUQW0L2iTKMxxvLi8gOqUNyNdJvj0mNsk-CsD3fjY2aKVvhDd3O-OR8ILYvPswTiP_3RXzaE79GI5gspFNdod3x4aOV8AgCHeE9u6Es_fO8gFE3YFnvKuQWIV8SpGLsx902U6yTEwpWKlB4RkCm2qL9Apk7EvQTh7paD8tgrg-bk6P_hlIKLvH8135lvibhGxXg-6M2O6pkBQyaqYFCJZRLsAeQiGG6ZSXPMlpYNgDULES1HzU2ZFZiubXAe0O4yUuoaKlcgO3Uela2_8Vp_CuubVTgUWpk2S8s7Cm-wR_y_VMaqWOt9H03Abb6Frp2TVOIeZb4nJGKMh3q0Uvn9vzTb-fKlRQ2PLcrUl99HWf-nkmzguEqvp7HCScJzqphAMOkcvcjWH1_QL1xZJCsNYGeaJY7vMpB6478Nkfix0DCf4KesGfRqHoM=w950-h618-no">
<meta property="og:updated_time" content="2020-02-07T14:11:11.607Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用 GCP Kubernetes Engine 來管理部署">
<meta name="twitter:description" content="概述Dev Ops 實踐通常使用多重部署的方法來管理應用部署情境, 像是 “持續部署”, “Blue-Green 部署”, “Canary 部署”, 等等… 本教程主要提供擴充以及管理容器的方法, 所以你可以完成這些使用多重部署的通用情境。">
<meta name="twitter:image" content="https://lh3.googleusercontent.com/JoxRKMMSKbzKyCJ83rgcHWsp0GqmDd4VJyA2JHttJIWtbeuSIiuLjuSSxc4iqePChDXbxGcLwlK2Ak3L_XKUbYDDc02KsoQczJQUjhf54Va0RDUXYR3Rs41gZ6chzqI4yNHMtFh8n21uoOrorZxFgQW_zUF7DxoFbP2cud5EQHISGuRo46oC3y4twF9RdpS0TSSA4olJ7qOJOWkyI6BVt4W3xNBLoNQe1KpHMsh4yZmNy62qzpIPZzG6mOyWJhxoeQgDv_AJMUZeePJb07cQRL0A1Z2o4BOmY2yDMeQxeo6zLOUa2YQn03IyyXmRkOHITivPHxEUNTRwRpx692JGJ0xLiRXaTrR3zUHIshdqfeUgqqpu3IzBEyFeQf_uuq3SBcVam2n-82KYWus0e9V9JyPdc57OK88fPGEv2FQ8gL3BphZ2cGk4m8-r2aZlcUu8eyAc3xf0ggMczseovjEtSj-Yd3hf7qMhQj6kczUUNLQ3bzF5Xj3X_w4frm5zaeGneTpLzM3R0rCa1OG-97DkR22YNXTSZoAHeEyH6i5TIWUjLQZfUFgAaDe7yHFFFv6ykMXIosO0hR93UeNtSxfkwBmZ1YSvIM_GBF4u5kSqRJkiPkIv0wso8tkk6Lu0lrvEPMUDeLwu_c_7AM-gq0GPkFdXF4Q4ED4=w297-h293-no">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">


    <link href="/managingDeploymentsUsingKubernetesEngine/" rel="alternate" hreflang="en">








    <meta name="description" content="概述Dev Ops 實踐通常使用多重部署的方法來管理應用部署情境, 像是 “持續部署”, “Blue-Green 部署”, “Canary 部署”, 等等… 本教程主要提供擴充以及管理容器的方法, 所以你可以完成這些使用多重部署的通用情境。">
<meta name="keywords" content="QWIKLABS,GCP Kubernetes Engine,Kubernetes,Cloud Architecture,Kubernetes in the Google Cloud">
<meta property="og:type" content="article">
<meta property="og:title" content="使用 GCP Kubernetes Engine 來管理部署">
<meta property="og:url" content="https://tn710617.github.io/zh-tw/managingDeploymentsUsingKubernetesEngine/index.html">
<meta property="og:site_name" content="Ray&#39;s Coding Journey">
<meta property="og:description" content="概述Dev Ops 實踐通常使用多重部署的方法來管理應用部署情境, 像是 “持續部署”, “Blue-Green 部署”, “Canary 部署”, 等等… 本教程主要提供擴充以及管理容器的方法, 所以你可以完成這些使用多重部署的通用情境。">
<meta property="og:locale" content="zh-tw">
<meta property="og:image" content="https://lh3.googleusercontent.com/JoxRKMMSKbzKyCJ83rgcHWsp0GqmDd4VJyA2JHttJIWtbeuSIiuLjuSSxc4iqePChDXbxGcLwlK2Ak3L_XKUbYDDc02KsoQczJQUjhf54Va0RDUXYR3Rs41gZ6chzqI4yNHMtFh8n21uoOrorZxFgQW_zUF7DxoFbP2cud5EQHISGuRo46oC3y4twF9RdpS0TSSA4olJ7qOJOWkyI6BVt4W3xNBLoNQe1KpHMsh4yZmNy62qzpIPZzG6mOyWJhxoeQgDv_AJMUZeePJb07cQRL0A1Z2o4BOmY2yDMeQxeo6zLOUa2YQn03IyyXmRkOHITivPHxEUNTRwRpx692JGJ0xLiRXaTrR3zUHIshdqfeUgqqpu3IzBEyFeQf_uuq3SBcVam2n-82KYWus0e9V9JyPdc57OK88fPGEv2FQ8gL3BphZ2cGk4m8-r2aZlcUu8eyAc3xf0ggMczseovjEtSj-Yd3hf7qMhQj6kczUUNLQ3bzF5Xj3X_w4frm5zaeGneTpLzM3R0rCa1OG-97DkR22YNXTSZoAHeEyH6i5TIWUjLQZfUFgAaDe7yHFFFv6ykMXIosO0hR93UeNtSxfkwBmZ1YSvIM_GBF4u5kSqRJkiPkIv0wso8tkk6Lu0lrvEPMUDeLwu_c_7AM-gq0GPkFdXF4Q4ED4=w297-h293-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/7d6Sw0e-DdZsWhuQG4LieT4RhHJlEIYZ3PbCTTS9B1rLivIvMY7G-VFuy-sQl3bbaNBlVoWipPwQyAWu-oPHUEQYIU5WOnfxflf5JtqsPiaRjQZ32Euuzo5_GqdSZ_hTaGyOBdVq8PzLfoT0RXQGIIEX5GJpnQvm1H8V9VD54X7RACmwemGHdHnOIN3OEYaYDTu3tfMD7NMlmlxvfs4aw1ZuKKGg52cuhwFZQB8e-uOFILtjRwvlJLVEO_iwmv8DDefMd6bIJDh6UdkunTMPcozfKT1muTgaqD1ie8LlaXUgHg5Uqnk9peB7yFejJfL-AwG44agBDOehNad2fJZAIb10HF8ZsAv0_JM-MJzSGbNQ3GK8J0ghFWu1qCNA5udefx6IXzX3vcDz92ArWjSz1QyNBErc2Zkj8YAA5Mfa0CRdFqTmOfXdxt73q7dpQup3zu5aASM4lh37l6SMCQ1ZVy07vcYvCL1mFnQ_hjc4Dg0SqdI7SvravdzmNO3ZEsumpEYgaIIJsnkRU7tzOrmZbV8hH__b90cAkfAamsPmVlgp9sZIwqUzptuDvuPEDyBPBYZC4o9eo5KyQahlTN1grAvzKkPMKYNQfiuKZKch1vpV24M0zuvjgRZFUQnz3V2ERzreJVNRaT_REMv6ifmf1RetnnHYIHg=w356-h248-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/LTqcvw12A83DFUA6wBwrvyfkCfqOXSzirXjbsH-F2lXQSFeA-RLHZ7-OwmSo2KRMIyh4aeOIM3sH7OEcgtvyRBhBZ3XUT0KeCA6JCziJfbwWoHeo_yQJEM6L0yNrsOxxvYsTfi7vc0JcG2PCq16I_-VapQeMzCUG4YHfQ05FMXM_Qbk3Q5AS_Gz37Qnnb2LBnS_FEq6xB1P5JZQPg0ewtkXL_w4uzxXBuiTF20FD5Wmvozjka_hHRPg7sNNv_s7Gl5QozEPvCLluVaulnZRr_EgqkMDsFhAYQo6f40EJ3d2G7h-teXuZxzGUNNauapux1XG54aCL-dbHexnOLC-_zPGhCJcU8s51SPLH_-mscGdvTbSmM1bfacQb4jqn28Ce0YTeFk_GdKE_Yc1uBhzv7AX3hPI47EtVMoDTN1S_4VRalxoaCGMW1W8weYxiVOKvqvts_vKrXPNcQhID-XGtTLRbMxHVVJQM_CZVLMdbIS04olUmWMompFUREpOdVvogPOxCeMNiOZOrjY8I53D6SdKdDjepyNBVHpD1U9clBS88hczGUhhZbEMDqM5V91GG0OmpcFu0vgc0vnAhmpBvcUrA4xf0_16Nxq3fxYky9x7xLLUXS12pIfLwShDt9RWhU8hiDDTzGkugZB294m_e1d4rjHxTiOw=w1172-h266-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/NQiAOvTG-8VLhp5DpNDvWH8j61jQ_9siMi_WMu8ZkujJnJ1nDCddW6e25xxpJykZi9CppWFX3PUbQ-1DOGAVO68NF_qXSOB0ne3apVKL3-x-CFbxxOjDc6FMZ6QK6Xq9cOX1WRgLxk76IhOWGZq4KQ2JOpE6XcH8CMWaowuunUPBLURUdnYWsEh_uanRFPwvabcbMGDgaU8Y-rXOTlMaiC8rBanZtz94OziyEuW8quqpTUb0t9zsLb9WwbZn3dQzC7nK7IBwZ4Hn_F9oeTtGk4RWpd-C0GdqHeDvobjExPIKjkIaO1n56PZHPbkBIZi8ltEAEaR8IRp31u2ryYpKSDFtobrWVA4Px9zI1FyWed-MhwoCJVX2KE-8LJEahoYgO-d43oi_bolFsiCmjEkJj5q9UWeIF3SapHHZj3rHUtV3WRnlpP32UWXnltfOpaDvFfSgDC_IukM_uwrn64VHRo0mwyCPM8jZM280GWdg2CGJOLBf8T4tq-5Tj71vBj3toOtfcHYSa0_fTBfCwfQUeuzR3qncAHKYk0N7TVIxtcTQdmQX9fVTI3lB0ngg_suUB5NWIErLkfGhHpxNO5m6Iji5h1tBl4Cx3UqTBpqbQD4qqmuDpfYqjjxfyymoTGDGuFvYlyheBnx6LYz4R-5WTcgwpL06OCs=w1172-h266-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/NsZ_a6EE077gPoIPQHGUyv3oi-CS0ZXvCCqcqQRSHXNB5NJP_532CiuaTBPpV3bC6WZK9mP5xuRCsIQCHERH-qJc5Ez1ISujFlCPJXBgAPZSTi_vg7pQKIQwEDei7UrjelpPIFpu8nj5c48WcLyn7iy8ZB5rW1jMCCnaICN9ckEPST_Bq4mum0WyDA0vbxZ6s_prBqRwHP7BYqK-yv5LY5WU2Cp_u58T2EVXS-TJ3b460s-PNEaKgPC6SoCpdamnW9VY2YzsvCycviBIODgAH-pvIZf7AppQsTWF7fe9d6JLq0yvBT3fnO4isK-Tu_i3ZlzIHyb5Ccmb4oYBzt42FIm9NmgUF0sDhiVEi3y2qgts7aU-5S3Sd85uv1N9qVuHZqTcuZk0uNgAfjfKfZN6clp4JFcf-CsZWPxZOJ5QdxSFG8wKAxz02vgiQdopj-R9SEEBR--TikL2KiSl2zHFqmegWol-8TYaLQSI4ZKKRqgzrsLuDvf_nw3Z9RqvX-4_P7HY9cqmaRDIkwK5pP-KF0gOjurvuRRmbGpdSpNCbM7cVZbyCpQgV28UdUdLdd0N-7xHa2QT1hVJnVGwmn3e7dMdc5PuTnJ6TMm6h0mcLKVdvqF7cInxrhsqBrvGj1VAZwY5ej4O4VPF1r0XAEH7bnD4HqSXMWg=w993-h696-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/67XYRFIt0PZG-lcSS21Eum9KeVPQBBSZ6WedKsA578qdHbCrs43df3Url887daqVpEm5xJTYmhlu3g1IVQFf8QOwIU01QWXSqybAnT9oRhjnx31l9ykNLa_hJCc9Szr1ODStfEd7hEXnlknqkrawQx9KWHIVAfYQsv36VXHzNh8CFRRYC96L8G8TnWUh-3GDiijvkBIg30jPWDCXrcre6bKvQmiOS8RIdhYsmh8KaYXYsMJQ83pWyQeKaTkY8fAcwnuFHTLt1Fx6lVolrSIUFqTH7N_snLcLxqVVnBcr9jBWN_cz-hGEyNzYPCq-GR1XjY8REeisXM9wskHXtYKBIwzyIpSkrZqSF-yJ5Y83UL55nQQ3aqK1gPOMizYbApEBfVEEOai-o9bO9hiSgAzg2oNckT3e7zRNeak5WUe41e1RPK8qvZIRPgUDfTWAUhBJgYPFfzQtI-HC4M_6G8Cj9y_W1DWtc9h8MnEbdBU2ARIWEsOBPhGEIrVCfWjIFk_wg13j3SidpqUXvjy8oqoDhwzJ_dnrntwL_o22ZBn0wxzdhjltdIjAB079f19G6PqRcxtNHVfwn9J4BTliJ4JYDx_13LkVArVmi1o8ZmnBuBb-99qBscIcj1qPrGSVbE-f2AQ7to7pSZHuFpn0BuHrQNDYcfnqePs=w1267-h196-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/d4G9ykFcKqCjqjPHh1jlatPIjYqhEiUwG-TkSziSe4-iw8ZCfFEPKQmIIHDBTBi78bxRkT3OA-WflhAgJoDglVYk9_GHLt8YM8gSmkfpO2iuJ-RYeRHyHMl_gOJm58iTBAHff0YjRLI=w1280-h212-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/YulZo3ShEh4j29_yM-q2baQ4MOFyS7FABLffcW_ST_GHe_DfxAOxYfHaqwgyWgaQqzbkSHObqd7DUMdW0EsUgABuyv_bFNEoYOEhkR8k36eBTuCF6R_HFRgbhHXUlEVyaDv_aMZ39qeqTgDVT2kA6YoSdrj7qTdSGGdINcBEfmKIWTQksRYsEKXZuzMkODP9XCmRifEfT8PBy9csNJzcDbPZlllfhaBP8IDHzLkss_Y6V4lGR1KlVhSpu-_fNJVgQx-LUZeclOEAmN_7JqzD8xzG8KOaQ219BLiOMZWaSglq91mySEsjummJAgvsXOB7tBYpFEqV8DnfVvbKpgSzeAPaiAF1qbAnqXEbq9XVvjnN90DEdoPAAzrootk1PDyI6HqTJRE7v4YW8RK1NwWofW5XT5X5l-aMesm9G4WaBWBluYuMtPRqhZtvKPo5Oe4MT43a_W3SaLe7AP2rcke6asgQP8QRotDzOUz7pie7OPhte3ZroG5vFoatpZD4NBdCTsVPRhhEGGSVolaADK1kO2Fesc6ZJakdajY6ngTzdADCRP6Min6EqNc84a9tnmZLGOGygWpe_5d9Jf1KQo06ebWEMVQt04VE2nyUFpP1FcVGNvrR6ZCEsP00xOx9sKfrWrvVQAmGxsCYKlxJCCyqMFk8J_fLf1XNtR6uMk1S4YB4UqVx-qeKvVru2wKF8NPw3xIc_G9BJWihIjprqOmxtrHtD4GJE0G9Twyqpenv0KJ0zUvJ=w1174-h595-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/dByaqOMAot2uFVvVC8d3Bbl9FCl-5V-ZFK85nASWb4p2n4zOLP9Y8w5wSbd7lO3iCMnInISZy1k6Mp_EZ4r543fpK9VaqeP5J7MOd2125Y-1Rx6VP_DV43Wc8PI0XTv_EV_j6c_6NK2M91ov7CTi3a_EsySUshTsB4V7dhteawMmI-x9rrbYt8MCks2gPslZ95uWqGby7nfqz8nPsQPPgTydHIaIBqpDTQ-hKy3VAQQrzoijsmeP0xcNR1LzkjWPgA_hitR4o5JffXXoCJINFRfdS-8ze3PnnpXZWNeD-_KSDSkvIM5uDDrjCGqr_kz-nvF3dRNz-EyRW0-sjjGHga0ypbdv_HmP7vCKR1wWM80vd9Jjyzhd5729vlRzP2mYXyM9UQq_l3teIZUgs8n09mVQtQUlSlnHVUF-nKpI_92k_q1uEN4Wtlp1prB2YmxAgV3Neu8fGcrFXGBkJfzlT6GU80nhKb821wNXRUQF7biqzJrvUvDbFnef6GNJ5hieG4YsB4sNpWIQ2wBwO28Vn-t2sXrridjc-Vfwl1BwRlyO6pKMeN0OnZ7st4S4gUHcvlkd3AKkIVLDnJikZo8hI6vRDRfWz9r28HpeldbSiZPgiIpfHlIgvXIqVS-g9PqknY9ohNH_E5RS7bUuSIDKaCrD61b4hdXSPgFXoaoz2PC0_zbJHKgphg1loxOgYa8ATKtUwBTkIMbxDBSNxNhS4QmL1nB7ZA0xcwt1eVCYbjp5-8cC=w945-h618-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/4wsgxe7rn5pd6x5vPWs9SQs0lYcr8ZIdphNq4nlj7ClovmXhK7cmTMHyvXQe6b7UsgN_XK74hTJZ2b3IraF8osHaruM8LGuGWeW_i4Cx6orFHCT2wDJWesEWCpVbcb6q6tq1o9a1lHQ=w1280-h212-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/eOaxMaMwxTAAH-o6CkzzGIW49fQa2L5W6L8Mrb8nrGVgwdl_-PU-4HOJie0OTZhq8o4zlhZQLhUPALaE_heyXkqs5l-sqlUYwLXe2-e35TlcYv0li_YNNE5ZU5phxTATrd8fZ3LbacCEvLwJaGbY-zx6ucd1dN-Z6j8P2UHfYmykdE4PISQeKelLdkW7zuaOKxW5E0ZRn69bfXDgo0EYqDbi50obj7pfRALc5WRSRjy-P_BlOrQ547QnH3zpKn0-T6S-o7CbFGk5wPcPOG3DMh7yA49STT7ixlRekZDIca8Oefqq7o7WcpvSYmUQW0L2iTKMxxvLi8gOqUNyNdJvj0mNsk-CsD3fjY2aKVvhDd3O-OR8ILYvPswTiP_3RXzaE79GI5gspFNdod3x4aOV8AgCHeE9u6Es_fO8gFE3YFnvKuQWIV8SpGLsx902U6yTEwpWKlB4RkCm2qL9Apk7EvQTh7paD8tgrg-bk6P_hlIKLvH8135lvibhGxXg-6M2O6pkBQyaqYFCJZRLsAeQiGG6ZSXPMlpYNgDULES1HzU2ZFZiubXAe0O4yUuoaKlcgO3Uela2_8Vp_CuubVTgUWpk2S8s7Cm-wR_y_VMaqWOt9H03Abb6Frp2TVOIeZb4nJGKMh3q0Uvn9vzTb-fKlRQ2PLcrUl99HWf-nkmzguEqvp7HCScJzqphAMOkcvcjWH1_QL1xZJCsNYGeaJY7vMpB6478Nkfix0DCf4KesGfRqHoM=w950-h618-no">
<meta property="og:updated_time" content="2020-02-07T14:11:11.607Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用 GCP Kubernetes Engine 來管理部署">
<meta name="twitter:description" content="概述Dev Ops 實踐通常使用多重部署的方法來管理應用部署情境, 像是 “持續部署”, “Blue-Green 部署”, “Canary 部署”, 等等… 本教程主要提供擴充以及管理容器的方法, 所以你可以完成這些使用多重部署的通用情境。">
<meta name="twitter:image" content="https://lh3.googleusercontent.com/JoxRKMMSKbzKyCJ83rgcHWsp0GqmDd4VJyA2JHttJIWtbeuSIiuLjuSSxc4iqePChDXbxGcLwlK2Ak3L_XKUbYDDc02KsoQczJQUjhf54Va0RDUXYR3Rs41gZ6chzqI4yNHMtFh8n21uoOrorZxFgQW_zUF7DxoFbP2cud5EQHISGuRo46oC3y4twF9RdpS0TSSA4olJ7qOJOWkyI6BVt4W3xNBLoNQe1KpHMsh4yZmNy62qzpIPZzG6mOyWJhxoeQgDv_AJMUZeePJb07cQRL0A1Z2o4BOmY2yDMeQxeo6zLOUa2YQn03IyyXmRkOHITivPHxEUNTRwRpx692JGJ0xLiRXaTrR3zUHIshdqfeUgqqpu3IzBEyFeQf_uuq3SBcVam2n-82KYWus0e9V9JyPdc57OK88fPGEv2FQ8gL3BphZ2cGk4m8-r2aZlcUu8eyAc3xf0ggMczseovjEtSj-Yd3hf7qMhQj6kczUUNLQ3bzF5Xj3X_w4frm5zaeGneTpLzM3R0rCa1OG-97DkR22YNXTSZoAHeEyH6i5TIWUjLQZfUFgAaDe7yHFFFv6ykMXIosO0hR93UeNtSxfkwBmZ1YSvIM_GBF4u5kSqRJkiPkIv0wso8tkk6Lu0lrvEPMUDeLwu_c_7AM-gq0GPkFdXF4Q4ED4=w297-h293-no">





    <link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/sunburst.min.css">

<link rel="stylesheet" href="/css/style.css">

<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
        
    
        
    
        
    
        
    
        
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135063928-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-135063928-1');
</script>


    


</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/zh-tw">
                
                    
                    不學會死
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item " href="/zh-tw/archives">歸檔</a>
            
            <a class="navbar-item " href="/zh-tw/categories">分類</a>
            
            <a class="navbar-item " href="/zh-tw/tags">標籤</a>
            
            <a class="navbar-item " href="/zh-tw/schedule">行程</a>
            
            <a class="navbar-item " href="/zh-tw/about">關於</a>
            
            <a class="navbar-item " href="/zh-tw/japanese">日語</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="搜尋" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="目錄">
                    <i class="fa fa-list"></i>
                </a>
                <div class="navbar-dropdown is-right">
                    
                    
                    
                    
                    <a class="navbar-item" href="#概述">1&nbsp;&nbsp;<b>概述</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#你將會做什麼？">1.1&nbsp;&nbsp;你將會做什麼？</a>
                    
                    
                    
                    <a class="navbar-item" href="#事先準備">1.2&nbsp;&nbsp;事先準備</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#deployments-介紹">2&nbsp;&nbsp;<b>deployments 介紹</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#設定及要求">3&nbsp;&nbsp;<b>設定及要求</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#啟動-Google-Cloud-Shell">3.1&nbsp;&nbsp;啟動 Google Cloud Shell</a>
                    
                    
                    
                    <a class="navbar-item" href="#設定-zone">3.2&nbsp;&nbsp;設定 zone</a>
                    
                    
                    
                    <a class="navbar-item" href="#取得本教程範例程式碼">3.3&nbsp;&nbsp;取得本教程範例程式碼</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#理解-deployment-物件">4&nbsp;&nbsp;<b>理解 deployment 物件</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#建立-deployment">5&nbsp;&nbsp;<b>建立 deployment</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#擴縮-Deployment">5.1&nbsp;&nbsp;擴縮 Deployment</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#rolling-update-滾動升級">6&nbsp;&nbsp;<b>rolling update (滾動升級)</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#觸發滾動升級">6.1&nbsp;&nbsp;觸發滾動升級</a>
                    
                    
                    
                    <a class="navbar-item" href="#暫停滾動升級">6.2&nbsp;&nbsp;暫停滾動升級</a>
                    
                    
                    
                    <a class="navbar-item" href="#繼續滾動升級">6.3&nbsp;&nbsp;繼續滾動升級</a>
                    
                    
                    
                    <a class="navbar-item" href="#回滾">6.4&nbsp;&nbsp;回滾</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#金絲雀部署-Canary-Deployments">7&nbsp;&nbsp;<b>金絲雀部署 (Canary Deployments)</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#建立一個金絲雀部署-canary-deployment">7.1&nbsp;&nbsp;建立一個金絲雀部署 (canary deployment)</a>
                    
                    
                    
                    <a class="navbar-item" href="#確認-canary-deployment">7.2&nbsp;&nbsp;確認 canary deployment</a>
                    
                    
                    
                    <a class="navbar-item" href="#在正式環境中的-Canary-deployments-session-affinity">7.3&nbsp;&nbsp;在正式環境中的 Canary deployments - session affinity</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#Blue-green-deployment">8&nbsp;&nbsp;<b>Blue-green deployment</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#The-service-服務">8.1&nbsp;&nbsp;The service (服務)</a>
                    
                    
                    
                    <a class="navbar-item" href="#更新使用-Blue-Green-deployment">8.2&nbsp;&nbsp;更新使用 Blue-Green deployment</a>
                    
                    
                    
                    <a class="navbar-item" href="#Blue-Green-回滾">8.3&nbsp;&nbsp;Blue-Green 回滾</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#恭喜">9&nbsp;&nbsp;<b>恭喜</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#Q-amp-A">10&nbsp;&nbsp;<b>Q&amp;amp;amp;A</b></a>
                    
                </div>
            </div>
            

            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true" aria-controls="dropdown-menu7">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>繁體中文</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu" style="top:100%">
            <div class="dropdown-content">
            
                <a href="/managingDeploymentsUsingKubernetesEngine/" class="dropdown-item">
                    English
                </a>
            
                <a href="/zh-tw/managingDeploymentsUsingKubernetesEngine/" class="dropdown-item">
                    繁體中文
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            使用 GCP Kubernetes Engine 來管理部署
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2020-02-07T14:01:24.000Z" itemprop="datePublished">2月 7 2020</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/zh-tw/categories/GCP/">GCP</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            1 小时 讀完 (大概 7841 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>Dev Ops 實踐通常使用多重部署的方法來管理應用部署情境, 像是 “持續部署”, “Blue-Green 部署”, “Canary 部署”, 等等… 本教程主要提供擴充以及管理容器的方法, 所以你可以完成這些使用多重部署的通用情境。</p>
<p><br><br><a id="more"></a></p>
<h3 id="你將會做什麼？"><a href="#你將會做什麼？" class="headerlink" title="你將會做什麼？"></a>你將會做什麼？</h3><ul>
<li>Kubectl 工具的練習</li>
<li>建立 deployment yaml 檔案</li>
<li>啟動, 更新, 以及擴充 deployments</li>
<li>更新 deployments 以及 部署風格的練習</li>
</ul>
<p><br></p>
<h3 id="事先準備"><a href="#事先準備" class="headerlink" title="事先準備"></a>事先準備</h3><ul>
<li>在開始本教程之前, 你應該至少完成 <a href="https://google.qwiklabs.com/catalog_lab/944" target="_blank" rel="noopener">Introduction to Docker</a> 以及 <a href="https://google.qwiklabs.com/catalog_lab/468" target="_blank" rel="noopener">Hello Node Kubernetes</a></li>
<li>Linux 系統管理技能</li>
<li>Dev Ops 理論： 持續部署的概念</li>
</ul>
<p><br><br><br></p>
<h2 id="deployments-介紹"><a href="#deployments-介紹" class="headerlink" title="deployments 介紹"></a>deployments 介紹</h2><p>Heterogeneous deployments (多種類部署) 一般來說包含兩個或多個基礎設施或地區以解決特定技術或運作需求。 Heterogeneous deployments 又被稱為 “hybrid”, “multi-cloud”, 或 “public-private”, 取決於部署細節。<br>在本教程中, heterogeneous deployments 包含地區橫跨單一雲端環境, 多公開雲端環境 (multi-cloud), 或是內部部署以及公開雲端的結合 (hybrid 或 public-private)</p>
<p>單一環境或地區的部署可能會在業務邏輯上或技術上有一些問題</p>
<ul>
<li><strong>資源耗盡</strong>: 在單一環境中, 尤其是內部部署環境, 你可能沒有正式環境需要的計算, 網路, 或儲存資源</li>
<li><strong>被限制的觸及地區</strong>: 單一環境的部署需要不同區域的人們存取不同區域的部署, 他們的流量可能會繞了世界一周之後才到達一個中間地區</li>
<li><strong>被限制的可用性</strong>: 網路擴充流量模式對應用保持容錯以及適應, 會是一個挑戰</li>
<li><strong>供應商鎖定</strong>: 供應商等級的平台以及基礎設施抽象將讓應用移植變得困難</li>
<li><strong>不靈活的資源</strong>: 你的資源可能會被限制在一組特定的計算機, 儲存區, 或網路</li>
</ul>
<p>Heterogeneous 可幫我們解決這些難題, 但他們必須被建構在可程式化以及確定性的程序以及步驟。 一次性的或點對點的部署步驟會造成部署或程序脆弱, 以及容錯能力降低。 點對點程序會丟失資料或丟棄流量。 一個好的部署程序需要是可重複的, 使用已確認可用的方法來管理提供, 設定, 以及維護。</p>
<p>三個 heterogeneous 通用的情境, 分別是 multi-cloud deployments (多雲端部署), fronting on-premises data (前端導向內部資料), 以及 CI/CD (持續整合 / 持續部署) 程序</p>
<p>以下的練習會實作一些 heterogeneous deployments 通用使用情境, 以及透過良好架構的 Kubernetes 方法以及其他的基礎設施資源來達成</p>
<p><br><br><br></p>
<h2 id="設定及要求"><a href="#設定及要求" class="headerlink" title="設定及要求"></a>設定及要求</h2><p><strong>在你按下 Start Lab 按鈕之前</strong></p>
<p>詳讀所有的教學。 Labs 是有時間限制的, 而且你不可以停止時間倒數。 倒數計時器在你按下 Start Lab 按鈕後開始倒數, 上面顯示的時間為你還能使用 Cloud 資源的時間。</p>
<p>Qwiklabs 的手把手環境, 讓你可以在真實環境中來操作進行 Qwiklabs 上提供的課程, 而不是在一個模擬或是展示的環境。 我們透過提供你一個全新的、暫時的帳號密碼, 在計時器歸零之前, 你可以用來登入並存取 Google Cloud Platform。</p>
<p><strong>你需要什麼？</strong></p>
<p>要完成這個 lab, 你需要:</p>
<ul>
<li>一個一般的網路瀏覽器（推薦 Chrome）</li>
<li>完成這個 lab 的時間</li>
</ul>
<p><strong>備註：</strong> 如果你已經有你自己的個人 GCP 帳號或專案,請不要使用在這一個 lab</p>
<p>現在你已經開始你的 <code>lab</code>, 你將會登入 <code>Google Cloud Shell</code> 主控台, 然後開啟命令列工具</p>
<p><strong>如何開始你的 lab, 然後登入 Console?</strong></p>
<ul>
<li>按下 <b>Start Lab</b> 按鈕。 如果你需要付費, 會有一個彈出視窗來讓你選擇付費的方式。 在左方你會看到一個面板, 上面有暫時的帳號密碼, 你必須使用這些帳號密碼在此次 lab</li>
</ul>
<p><img src="https://lh3.googleusercontent.com/JoxRKMMSKbzKyCJ83rgcHWsp0GqmDd4VJyA2JHttJIWtbeuSIiuLjuSSxc4iqePChDXbxGcLwlK2Ak3L_XKUbYDDc02KsoQczJQUjhf54Va0RDUXYR3Rs41gZ6chzqI4yNHMtFh8n21uoOrorZxFgQW_zUF7DxoFbP2cud5EQHISGuRo46oC3y4twF9RdpS0TSSA4olJ7qOJOWkyI6BVt4W3xNBLoNQe1KpHMsh4yZmNy62qzpIPZzG6mOyWJhxoeQgDv_AJMUZeePJb07cQRL0A1Z2o4BOmY2yDMeQxeo6zLOUa2YQn03IyyXmRkOHITivPHxEUNTRwRpx692JGJ0xLiRXaTrR3zUHIshdqfeUgqqpu3IzBEyFeQf_uuq3SBcVam2n-82KYWus0e9V9JyPdc57OK88fPGEv2FQ8gL3BphZ2cGk4m8-r2aZlcUu8eyAc3xf0ggMczseovjEtSj-Yd3hf7qMhQj6kczUUNLQ3bzF5Xj3X_w4frm5zaeGneTpLzM3R0rCa1OG-97DkR22YNXTSZoAHeEyH6i5TIWUjLQZfUFgAaDe7yHFFFv6ykMXIosO0hR93UeNtSxfkwBmZ1YSvIM_GBF4u5kSqRJkiPkIv0wso8tkk6Lu0lrvEPMUDeLwu_c_7AM-gq0GPkFdXF4Q4ED4=w297-h293-no" alt></p>
<ul>
<li>複製 <code>username</code>, 然後點擊 <code>Open Google Console</code>。 Lab 會開啟另外一個視窗, 顯示<code>選擇帳號</code>的頁面</li>
</ul>
<p><strong>tip:</strong> 開啟一個全新的視窗,然後跟原本的頁面並排</p>
<ul>
<li>在<code>選擇帳號</code>頁面, 點擊 <code>Use Another Account</code></li>
</ul>
<p><img src="https://lh3.googleusercontent.com/7d6Sw0e-DdZsWhuQG4LieT4RhHJlEIYZ3PbCTTS9B1rLivIvMY7G-VFuy-sQl3bbaNBlVoWipPwQyAWu-oPHUEQYIU5WOnfxflf5JtqsPiaRjQZ32Euuzo5_GqdSZ_hTaGyOBdVq8PzLfoT0RXQGIIEX5GJpnQvm1H8V9VD54X7RACmwemGHdHnOIN3OEYaYDTu3tfMD7NMlmlxvfs4aw1ZuKKGg52cuhwFZQB8e-uOFILtjRwvlJLVEO_iwmv8DDefMd6bIJDh6UdkunTMPcozfKT1muTgaqD1ie8LlaXUgHg5Uqnk9peB7yFejJfL-AwG44agBDOehNad2fJZAIb10HF8ZsAv0_JM-MJzSGbNQ3GK8J0ghFWu1qCNA5udefx6IXzX3vcDz92ArWjSz1QyNBErc2Zkj8YAA5Mfa0CRdFqTmOfXdxt73q7dpQup3zu5aASM4lh37l6SMCQ1ZVy07vcYvCL1mFnQ_hjc4Dg0SqdI7SvravdzmNO3ZEsumpEYgaIIJsnkRU7tzOrmZbV8hH__b90cAkfAamsPmVlgp9sZIwqUzptuDvuPEDyBPBYZC4o9eo5KyQahlTN1grAvzKkPMKYNQfiuKZKch1vpV24M0zuvjgRZFUQnz3V2ERzreJVNRaT_REMv6ifmf1RetnnHYIHg=w356-h248-no" alt></p>
<ul>
<li>登入頁面開啟, 貼上之前複製的 <code>username</code> 以及 <code>password</code>, 然後貼上</li>
</ul>
<p><strong>重要：</strong> 必須使用之前於 <code>Connection Details 面板</code> 取得的帳號密碼,不要使用你自己的 Qwiklabs 帳號密碼。 如果你有自己的 GCP 帳號, 請不要用在這裡（避免產生費用）</p>
<ul>
<li>點擊並通過接下來的頁面:<ul>
<li>接受 <code>terms</code> 以及 <code>conditions</code></li>
<li>不要增加 <code>recovery optoins</code> 或 <code>two factor authentication</code> (因為這只是一個臨時帳號)</li>
<li>不要註冊免費體驗</li>
</ul>
</li>
</ul>
<p>稍待一些時候, GCP 控制台將會在這個視窗開啟。</p>
<p><strong>注意：</strong> 按下左上方位於 <code>Google Cloud Platform</code> 隔壁的 <code>Navigation menu</code>, 你可以瀏覽選單, 裡面有一系列的 GCP 產品以及服務<br><img src="https://lh3.googleusercontent.com/LTqcvw12A83DFUA6wBwrvyfkCfqOXSzirXjbsH-F2lXQSFeA-RLHZ7-OwmSo2KRMIyh4aeOIM3sH7OEcgtvyRBhBZ3XUT0KeCA6JCziJfbwWoHeo_yQJEM6L0yNrsOxxvYsTfi7vc0JcG2PCq16I_-VapQeMzCUG4YHfQ05FMXM_Qbk3Q5AS_Gz37Qnnb2LBnS_FEq6xB1P5JZQPg0ewtkXL_w4uzxXBuiTF20FD5Wmvozjka_hHRPg7sNNv_s7Gl5QozEPvCLluVaulnZRr_EgqkMDsFhAYQo6f40EJ3d2G7h-teXuZxzGUNNauapux1XG54aCL-dbHexnOLC-_zPGhCJcU8s51SPLH_-mscGdvTbSmM1bfacQb4jqn28Ce0YTeFk_GdKE_Yc1uBhzv7AX3hPI47EtVMoDTN1S_4VRalxoaCGMW1W8weYxiVOKvqvts_vKrXPNcQhID-XGtTLRbMxHVVJQM_CZVLMdbIS04olUmWMompFUREpOdVvogPOxCeMNiOZOrjY8I53D6SdKdDjepyNBVHpD1U9clBS88hczGUhhZbEMDqM5V91GG0OmpcFu0vgc0vnAhmpBvcUrA4xf0_16Nxq3fxYky9x7xLLUXS12pIfLwShDt9RWhU8hiDDTzGkugZB294m_e1d4rjHxTiOw=w1172-h266-no" alt></p>
<p><br></p>
<h3 id="啟動-Google-Cloud-Shell"><a href="#啟動-Google-Cloud-Shell" class="headerlink" title="啟動 Google Cloud Shell"></a>啟動 Google Cloud Shell</h3><p><code>Google Cloud Shell</code> 是載有開發工具的虛擬機器。 它提供了5GB的 home 資料夾, 並且運行在 <code>Google Cloud</code> 上。 <code>Google Cloud Shell</code> 讓你可以利用 command-line 存取 <code>GCP</code> 資源</p>
<ul>
<li>在 <code>GCP 控制台</code>, 右上的工具列,點擊 <code>Open Cloud Shell</code> 按鈕</li>
</ul>
<p><img src="https://lh3.googleusercontent.com/NQiAOvTG-8VLhp5DpNDvWH8j61jQ_9siMi_WMu8ZkujJnJ1nDCddW6e25xxpJykZi9CppWFX3PUbQ-1DOGAVO68NF_qXSOB0ne3apVKL3-x-CFbxxOjDc6FMZ6QK6Xq9cOX1WRgLxk76IhOWGZq4KQ2JOpE6XcH8CMWaowuunUPBLURUdnYWsEh_uanRFPwvabcbMGDgaU8Y-rXOTlMaiC8rBanZtz94OziyEuW8quqpTUb0t9zsLb9WwbZn3dQzC7nK7IBwZ4Hn_F9oeTtGk4RWpd-C0GdqHeDvobjExPIKjkIaO1n56PZHPbkBIZi8ltEAEaR8IRp31u2ryYpKSDFtobrWVA4Px9zI1FyWed-MhwoCJVX2KE-8LJEahoYgO-d43oi_bolFsiCmjEkJj5q9UWeIF3SapHHZj3rHUtV3WRnlpP32UWXnltfOpaDvFfSgDC_IukM_uwrn64VHRo0mwyCPM8jZM280GWdg2CGJOLBf8T4tq-5Tj71vBj3toOtfcHYSa0_fTBfCwfQUeuzR3qncAHKYk0N7TVIxtcTQdmQX9fVTI3lB0ngg_suUB5NWIErLkfGhHpxNO5m6Iji5h1tBl4Cx3UqTBpqbQD4qqmuDpfYqjjxfyymoTGDGuFvYlyheBnx6LYz4R-5WTcgwpL06OCs=w1172-h266-no" alt></p>
<ul>
<li>在打開的對話框裡, 按下 <code>START CLOUD SHELL</code>:</li>
</ul>
<p><img src="https://lh3.googleusercontent.com/NsZ_a6EE077gPoIPQHGUyv3oi-CS0ZXvCCqcqQRSHXNB5NJP_532CiuaTBPpV3bC6WZK9mP5xuRCsIQCHERH-qJc5Ez1ISujFlCPJXBgAPZSTi_vg7pQKIQwEDei7UrjelpPIFpu8nj5c48WcLyn7iy8ZB5rW1jMCCnaICN9ckEPST_Bq4mum0WyDA0vbxZ6s_prBqRwHP7BYqK-yv5LY5WU2Cp_u58T2EVXS-TJ3b460s-PNEaKgPC6SoCpdamnW9VY2YzsvCycviBIODgAH-pvIZf7AppQsTWF7fe9d6JLq0yvBT3fnO4isK-Tu_i3ZlzIHyb5Ccmb4oYBzt42FIm9NmgUF0sDhiVEi3y2qgts7aU-5S3Sd85uv1N9qVuHZqTcuZk0uNgAfjfKfZN6clp4JFcf-CsZWPxZOJ5QdxSFG8wKAxz02vgiQdopj-R9SEEBR--TikL2KiSl2zHFqmegWol-8TYaLQSI4ZKKRqgzrsLuDvf_nw3Z9RqvX-4_P7HY9cqmaRDIkwK5pP-KF0gOjurvuRRmbGpdSpNCbM7cVZbyCpQgV28UdUdLdd0N-7xHa2QT1hVJnVGwmn3e7dMdc5PuTnJ6TMm6h0mcLKVdvqF7cInxrhsqBrvGj1VAZwY5ej4O4VPF1r0XAEH7bnD4HqSXMWg=w993-h696-no" alt></p>
<p>你可以立即按下 <code>START CLOUD SHELL</code> 當對話視窗打開。</p>
<p>連結並提供環境會需要一點時間。 當你連結成功, 這代表你已成功獲得授權, 且此專案已被設為你的專案ID, 例如：</p>
<p><img src="https://lh3.googleusercontent.com/67XYRFIt0PZG-lcSS21Eum9KeVPQBBSZ6WedKsA578qdHbCrs43df3Url887daqVpEm5xJTYmhlu3g1IVQFf8QOwIU01QWXSqybAnT9oRhjnx31l9ykNLa_hJCc9Szr1ODStfEd7hEXnlknqkrawQx9KWHIVAfYQsv36VXHzNh8CFRRYC96L8G8TnWUh-3GDiijvkBIg30jPWDCXrcre6bKvQmiOS8RIdhYsmh8KaYXYsMJQ83pWyQeKaTkY8fAcwnuFHTLt1Fx6lVolrSIUFqTH7N_snLcLxqVVnBcr9jBWN_cz-hGEyNzYPCq-GR1XjY8REeisXM9wskHXtYKBIwzyIpSkrZqSF-yJ5Y83UL55nQQ3aqK1gPOMizYbApEBfVEEOai-o9bO9hiSgAzg2oNckT3e7zRNeak5WUe41e1RPK8qvZIRPgUDfTWAUhBJgYPFfzQtI-HC4M_6G8Cj9y_W1DWtc9h8MnEbdBU2ARIWEsOBPhGEIrVCfWjIFk_wg13j3SidpqUXvjy8oqoDhwzJ_dnrntwL_o22ZBn0wxzdhjltdIjAB079f19G6PqRcxtNHVfwn9J4BTliJ4JYDx_13LkVArVmi1o8ZmnBuBb-99qBscIcj1qPrGSVbE-f2AQ7to7pSZHuFpn0BuHrQNDYcfnqePs=w1267-h196-no" alt></p>
<p><strong>gcloud</strong> 是 <code>Google Cloud Platform</code> 的 command-line 工具, 他已事先被安裝在 <code>Cloud Shell</code> 並且支援自動補齊</p>
<p>使用這個 command, 你可以列出有效帳戶名稱:<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">gcloud auth list</span><br></pre></td></tr></table></figure></p>
<p>輸出:<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">Credentialed accounts:</span><br><span class="line"> - &lt;myaccount&gt;@&lt;mydomain&gt;.com (active)</span><br></pre></td></tr></table></figure></p>
<p>範例輸出:<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">Credentialed accounts:</span><br><span class="line"> - google1623327_student@qwiklabs.net</span><br></pre></td></tr></table></figure></p>
<p>你可以使用以下 command 來列出專案 ID</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">gcloud config list project</span><br></pre></td></tr></table></figure>
<p>輸出：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[core]</span><br><span class="line">project = &lt;project_ID&gt;</span><br></pre></td></tr></table></figure></p>
<p>範例輸出：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[core]</span><br><span class="line">project = qwiklabs-gcp-44776a13dea667a6</span><br></pre></td></tr></table></figure></p>
<p><code>gcloud</code> 的完整文件可以參閱 <a href="https://cloud.google.com/sdk/gcloud" target="_blank" rel="noopener">Google Cloud gcloud Overview</a></p>
<p><br></p>
<h3 id="設定-zone"><a href="#設定-zone" class="headerlink" title="設定 zone"></a>設定 zone</h3><p>執行以下指令來設定你的 GCP zone, 將 local zone <code>us-central1-a</code> 替換掉<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">gcloud config <span class="hljs-built_in">set</span> compute/zone us-central1<span class="hljs-_">-a</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="取得本教程範例程式碼"><a href="#取得本教程範例程式碼" class="headerlink" title="取得本教程範例程式碼"></a>取得本教程範例程式碼</h3><p>取得建立, 運行容器以及 deployments 的範例程式碼<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">git <span class="hljs-built_in">clone</span> https://github.com/googlecodelabs/orchestrate-with-kubernetes.git</span><br><span class="line"><span class="hljs-built_in">cd</span> orchestrate-with-kubernetes/kubernetes</span><br></pre></td></tr></table></figure></p>
<p>建立一個含有 5 台 <code>n1-standard-1</code> node 的叢集 (會需要幾分鐘時間完成)</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">gcloud container clusters create bootcamp --num-nodes 5 --scopes <span class="hljs-string">"https://www.googleapis.com/auth/projecthosting,storage-rw"</span></span><br></pre></td></tr></table></figure>
<p><br><br><br></p>
<h2 id="理解-deployment-物件"><a href="#理解-deployment-物件" class="headerlink" title="理解 deployment 物件"></a>理解 deployment 物件</h2><p>讓我們從 Deployments 開始。 首先檢視一下 Deployment 物件。 <code>kubectl</code> 的 <code>explain</code> 指令可以告訴我們有關 Deployment 物件的資訊<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl explain deployment</span><br></pre></td></tr></table></figure></p>
<p>我們可以使用 <code>--resursive</code> 選項來檢視所有的欄位<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl explain deployment --recursive</span><br></pre></td></tr></table></figure></p>
<p>在你進行本教程的過程中, 你可以使用 explain 來更了解 Deployment 物件的結構, 以及每個欄位做什麼事<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl explain deployment.metadata.name</span><br></pre></td></tr></table></figure></p>
<p><br><br><br></p>
<h2 id="建立-deployment"><a href="#建立-deployment" class="headerlink" title="建立 deployment"></a>建立 deployment</h2><p>更新 <code>deployments/auth.yaml</code> cs 檔案：<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">vim deployments/auth.yaml</span><br></pre></td></tr></table></figure></p>
<p>開始編輯模式<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">i</span><br></pre></td></tr></table></figure></p>
<p>將 container 區塊內的 <code>image</code> 變更如下：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">containers:</span><br><span class="line">- name: auth</span><br><span class="line">  image: kelseyhightower/auth:1.0.0</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>儲存 <code>auth.yaml</code> 檔案, 按下 <code>&lt;Esc&gt;</code>, 然後：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">:wq</span><br></pre></td></tr></table></figure></p>
<p>現在讓我們來建立一個簡單的 deployment 。 檢視 deployment 設定檔<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">cat deployments/auth.yaml</span><br></pre></td></tr></table></figure></p>
<p>(輸出)<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">apiVersion: extensions/v1beta1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: auth</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: auth</span><br><span class="line">        track: stable</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">        - name: auth</span><br><span class="line">          image: &quot;kelseyhightower/auth:1.0.0&quot;</span><br><span class="line">          ports:</span><br><span class="line">            - name: http</span><br><span class="line">              containerPort: 80</span><br><span class="line">            - name: health</span><br><span class="line">              containerPort: 81</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>注意到 Deployment 是如何建立一個 replica 且使用 auth container 的 version 1.0.0</p>
<p>當你執行 <code>kubectl create</code> 指令來建立 auth deployment 時, 一個符合 Deployment 設定檔的 pod 將會被建立。 這表示說, 我們可以藉由變更 <code>replica</code> 欄位的數量擴縮 Pods 的數量</p>
<p>使用 <code>kubectl create</code> 來建立 deployment 物件<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl create -f deployments/auth.yaml</span><br></pre></td></tr></table></figure></p>
<p>一旦你已經建立 Depolyment, 你可以確認看看它是否有被建立<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get deployments</span><br></pre></td></tr></table></figure></p>
<p>一旦 deployment 被建立了, Kubernetes 會建立一個相對應的 ReplicaSet 。 我們可以確認對應該 Deployment 的 ReplicaSet 是否有被建立<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get replicasets</span><br></pre></td></tr></table></figure></p>
<p>我們應會看到一個名為 <code>auth-xxxxxx</code> 的 ReplicaSet</p>
<p>最後, 我們可以檢視 Pods, 它是 Deployment 的一部分。 當 ReplicaSet 被建立, Kubernetes 會建立一個 Pod<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get pods</span><br></pre></td></tr></table></figure></p>
<p>是時候建立一個 auth deployment 的 service 。 你已經看過 service 的設定檔, 所以在這我們不會探究更多細節。 使用 <code>kubectl create</code> 指令來建立 auth service<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl create -f services/auth.yaml</span><br></pre></td></tr></table></figure></p>
<p>現在, 同樣的步驟, 讓我們建立以及暴露 hello Deployment<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl create -f deployments/hello.yaml</span><br><span class="line">kubectl create -f services/hello.yaml</span><br></pre></td></tr></table></figure></p>
<p>然後再一次, 建立以及暴露 frontend Deployment<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl create secret generic tls-certs --from-file tls/</span><br><span class="line">kubectl create configmap nginx-frontend-conf --from-file=nginx/frontend.conf</span><br><span class="line">kubectl create -f deployments/frontend.yaml</span><br><span class="line">kubectl create -f services/frontend.yaml</span><br></pre></td></tr></table></figure></p>
<p><strong>注意:</strong> 你為 frontend 建立了一個 ConfigMap</p>
<p>取得 frontend 的外部 IP 然後使用 curl 與它互動<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get services frontend</span><br><span class="line">curl -ks https://EXTERNAL-IP</span><br></pre></td></tr></table></figure></p>
<p>然後你會得到一個 hello 的回應<br>你也可以使用 <code>kubectl</code> 的輸出模板功能搭配 curl, 讓指令變成只需要一行<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">curl -ks https://`kubectl get svc frontend -o=jsonpath=<span class="hljs-string">"&#123;.status.loadBalancer.ingress[0].ip&#125;"</span>`</span><br></pre></td></tr></table></figure></p>
<p><strong>測試進度</strong><br>點擊 <strong>Check my progress</strong> 來確認目前的進度。如果你已經成功建立了 Kubernetes 叢集以及 Auth, Hello, 跟 Frontend deployments, 你將獲得一個評價分數。</p>
<p><img src="https://lh3.googleusercontent.com/d4G9ykFcKqCjqjPHh1jlatPIjYqhEiUwG-TkSziSe4-iw8ZCfFEPKQmIIHDBTBi78bxRkT3OA-WflhAgJoDglVYk9_GHLt8YM8gSmkfpO2iuJ-RYeRHyHMl_gOJm58iTBAHff0YjRLI=w1280-h212-no" alt></p>
<h3 id="擴縮-Deployment"><a href="#擴縮-Deployment" class="headerlink" title="擴縮 Deployment"></a>擴縮 Deployment</h3><p>現在我們已建立一個 Deployment, 我們可以擴縮它。 可以藉由更新 spec.replicas 欄位來達成。 你可以再次使用 <code>Kubectl explain</code> 指令來檢視這個欄位的解釋<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl explain deployment.spec.replicas</span><br></pre></td></tr></table></figure></p>
<p>更新 replicas 欄位最簡單的方法就是使用 <code>kubectl scale</code> 指令<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl scale deployment hello --replicas=5</span><br></pre></td></tr></table></figure></p>
<p><strong>注意</strong>: 要讓全部的 pods 都啟動且運行約需要幾分鐘<br>Deployment 建立後, Kubernetes 會自動地更新相對應的 ReplicaSet 以及啟動新的 Pods, 讓 Pods 的總數量等於 5</p>
<p>確認是否有 5 個 <code>hello</code> Pods 運行中：<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get pods | grep hello- | wc -l</span><br></pre></td></tr></table></figure></p>
<p>現在擴縮回原本的數量<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl scale deployment hello --replicas=3</span><br></pre></td></tr></table></figure></p>
<p>再一次, 確認 Pods 的數量是正確的<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get pods | grep hello- | wc -l</span><br></pre></td></tr></table></figure></p>
<p>你已經學習了 Kubernetes deployments 以及如何管理 &amp; 擴縮 Pods 群組</p>
<p><br><br><br></p>
<h2 id="rolling-update-滾動升級"><a href="#rolling-update-滾動升級" class="headerlink" title="rolling update (滾動升級)"></a>rolling update (滾動升級)</h2><p>Deployments 支援透過滾動升級的機制進行鏡像升級。 當 Deployment 被更新成新的版本, 它會建立一個新的 ReplicaSet, 並且慢慢的增加新版的 replicas 的數量, 同時, 也慢慢地減少舊版的 replicas 數量<br><img src="https://lh3.googleusercontent.com/YulZo3ShEh4j29_yM-q2baQ4MOFyS7FABLffcW_ST_GHe_DfxAOxYfHaqwgyWgaQqzbkSHObqd7DUMdW0EsUgABuyv_bFNEoYOEhkR8k36eBTuCF6R_HFRgbhHXUlEVyaDv_aMZ39qeqTgDVT2kA6YoSdrj7qTdSGGdINcBEfmKIWTQksRYsEKXZuzMkODP9XCmRifEfT8PBy9csNJzcDbPZlllfhaBP8IDHzLkss_Y6V4lGR1KlVhSpu-_fNJVgQx-LUZeclOEAmN_7JqzD8xzG8KOaQ219BLiOMZWaSglq91mySEsjummJAgvsXOB7tBYpFEqV8DnfVvbKpgSzeAPaiAF1qbAnqXEbq9XVvjnN90DEdoPAAzrootk1PDyI6HqTJRE7v4YW8RK1NwWofW5XT5X5l-aMesm9G4WaBWBluYuMtPRqhZtvKPo5Oe4MT43a_W3SaLe7AP2rcke6asgQP8QRotDzOUz7pie7OPhte3ZroG5vFoatpZD4NBdCTsVPRhhEGGSVolaADK1kO2Fesc6ZJakdajY6ngTzdADCRP6Min6EqNc84a9tnmZLGOGygWpe_5d9Jf1KQo06ebWEMVQt04VE2nyUFpP1FcVGNvrR6ZCEsP00xOx9sKfrWrvVQAmGxsCYKlxJCCyqMFk8J_fLf1XNtR6uMk1S4YB4UqVx-qeKvVru2wKF8NPw3xIc_G9BJWihIjprqOmxtrHtD4GJE0G9Twyqpenv0KJ0zUvJ=w1174-h595-no" alt></p>
<p><br></p>
<h3 id="觸發滾動升級"><a href="#觸發滾動升級" class="headerlink" title="觸發滾動升級"></a>觸發滾動升級</h3><p>執行以下指令來更新 Deployment:<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl edit deployment hello</span><br></pre></td></tr></table></figure></p>
<p>將 containers 區塊內的 <code>image</code> 變更如下：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">containers:</span><br><span class="line">- name: hello</span><br><span class="line">  image: kelseyhightower/hello:2.0.0</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>儲存並離開<br>一但你成功的儲存編輯器, 更新的 Deployment 會被儲存到你的叢集, 然後 Kubernetes 將會開始滾動升級。<br>檢視 Kubernetes 新建立的 ReplicaSet<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get replicaset</span><br></pre></td></tr></table></figure></p>
<p>同時你也可以檢視 rollout 的紀錄<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl rollout <span class="hljs-built_in">history</span> deployment/hello</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="暫停滾動升級"><a href="#暫停滾動升級" class="headerlink" title="暫停滾動升級"></a>暫停滾動升級</h3><p>如果在滾動升級的過程中, 你發現一些問題, 你可以停止升級<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl rollout pause deployment/hello</span><br></pre></td></tr></table></figure></p>
<p>確認目前的滾動狀態<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl rollout status deployment/hello</span><br></pre></td></tr></table></figure></p>
<p>你也可以直接透過 Pods 資訊來確認<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get pods -o jsonpath --template=<span class="hljs-string">'&#123;range .items[*]&#125;&#123;.metadata.name&#125;&#123;"\t"&#125;&#123;"\t"&#125;&#123;.spec.containers[0].image&#125;&#123;"\n"&#125;&#123;end&#125;'</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="繼續滾動升級"><a href="#繼續滾動升級" class="headerlink" title="繼續滾動升級"></a>繼續滾動升級</h3><p>滾動升級被中斷了, 這表示有一些 Pods 正運行著新版本而有些 Pods 運行舊版本。 我們可以使用以下的 <code>resume</code> 指令來繼續未完成的滾動<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl rollout resume deployment/hello</span><br></pre></td></tr></table></figure></p>
<p>當滾動完成了, 你執行 <code>status</code> 指令時, 應會看到輸出如下：<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl rollout status deployment/hello</span><br></pre></td></tr></table></figure></p>
<p>(輸出)<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">deployment &quot;hello&quot; successfully rolled out</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="回滾"><a href="#回滾" class="headerlink" title="回滾"></a>回滾</h3><p>假設我們在新版本發現了一個 bug 。 因為新版本有問題, 任何存取新的 Pods 資源的使用者都會遇到這個問題<br>你會想要回滾之前的版本, 所以你可以看看出了什麼問題, 待修復後再發布一個新的版本<br>使用 <code>rollout</code> 指令來回滾到之前的版本<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl rollout undo deployment/hello</span><br></pre></td></tr></table></figure></p>
<p>確認回滾歷史<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl rollout <span class="hljs-built_in">history</span> deployment/hello</span><br></pre></td></tr></table></figure></p>
<p>最後, 確認所有的 Pods 都有回滾到之前的版本<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get pods -o jsonpath --template=<span class="hljs-string">'&#123;range .items[*]&#125;&#123;.metadata.name&#125;&#123;"\t"&#125;&#123;"\t"&#125;&#123;.spec.containers[0].image&#125;&#123;"\n"&#125;&#123;end&#125;'</span></span><br></pre></td></tr></table></figure></p>
<p>帥氣！ 你已經學會 Kubernetes 的滾動升級, 以及如何 0 downtime 的更新你的應用</p>
<p><br><br><br></p>
<h2 id="金絲雀部署-Canary-Deployments"><a href="#金絲雀部署-Canary-Deployments" class="headerlink" title="金絲雀部署 (Canary Deployments)"></a>金絲雀部署 (Canary Deployments)</h2><p>當你想要在正式環境只對一部分的使用者進行新版本的測試, 你可以使用金絲雀部署。 金絲雀部署讓你可以只發布變更到一小部分的使用者, 降低新發布的風險</p>
<p><br></p>
<h3 id="建立一個金絲雀部署-canary-deployment"><a href="#建立一個金絲雀部署-canary-deployment" class="headerlink" title="建立一個金絲雀部署 (canary deployment)"></a>建立一個金絲雀部署 (canary deployment)</h3><p>金絲雀部署包含分開的 deployment, 以及一個共同的 service, 這個 service 可以導向穩定, 一般的版本, 以及金絲雀版本<br><img src="https://lh3.googleusercontent.com/dByaqOMAot2uFVvVC8d3Bbl9FCl-5V-ZFK85nASWb4p2n4zOLP9Y8w5wSbd7lO3iCMnInISZy1k6Mp_EZ4r543fpK9VaqeP5J7MOd2125Y-1Rx6VP_DV43Wc8PI0XTv_EV_j6c_6NK2M91ov7CTi3a_EsySUshTsB4V7dhteawMmI-x9rrbYt8MCks2gPslZ95uWqGby7nfqz8nPsQPPgTydHIaIBqpDTQ-hKy3VAQQrzoijsmeP0xcNR1LzkjWPgA_hitR4o5JffXXoCJINFRfdS-8ze3PnnpXZWNeD-_KSDSkvIM5uDDrjCGqr_kz-nvF3dRNz-EyRW0-sjjGHga0ypbdv_HmP7vCKR1wWM80vd9Jjyzhd5729vlRzP2mYXyM9UQq_l3teIZUgs8n09mVQtQUlSlnHVUF-nKpI_92k_q1uEN4Wtlp1prB2YmxAgV3Neu8fGcrFXGBkJfzlT6GU80nhKb821wNXRUQF7biqzJrvUvDbFnef6GNJ5hieG4YsB4sNpWIQ2wBwO28Vn-t2sXrridjc-Vfwl1BwRlyO6pKMeN0OnZ7st4S4gUHcvlkd3AKkIVLDnJikZo8hI6vRDRfWz9r28HpeldbSiZPgiIpfHlIgvXIqVS-g9PqknY9ohNH_E5RS7bUuSIDKaCrD61b4hdXSPgFXoaoz2PC0_zbJHKgphg1loxOgYa8ATKtUwBTkIMbxDBSNxNhS4QmL1nB7ZA0xcwt1eVCYbjp5-8cC=w945-h618-no" alt></p>
<p>首先, 建立一個新的金絲雀 deployment<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">cat deployments/hello-canary.yaml</span><br></pre></td></tr></table></figure></p>
<p>(輸出)<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">apiVersion: extensions/v1beta1</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: hello-canary</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: hello</span><br><span class="line">        track: canary</span><br><span class="line">        # Use ver 1.0.0 so it matches version on service selector</span><br><span class="line">        version: 1.0.0</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">        - name: hello</span><br><span class="line">          image: kelseyhightower/hello:2.0.0</span><br><span class="line">          ports:</span><br><span class="line">            - name: http</span><br><span class="line">              containerPort: 80</span><br><span class="line">            - name: health</span><br><span class="line">              containerPort: 81</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p>確認有更新到版本 1.0.0 (如果你的版本是指向其他的)<br>現在建立一個金絲雀 deployment<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl create -f deployments/hello-canary.yaml</span><br></pre></td></tr></table></figure></p>
<p>金絲雀 deployment 被建立後, 你應會有兩個 deployments, <code>hello</code> 以及 <code>hello-canary</code> 。 使用以下的 <code>kubectl</code> 指令來確認:<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl get deployments</span><br></pre></td></tr></table></figure></p>
<p>在 <code>hello</code> service, selector 使用 <code>app:hello</code> selector, 這將會<strong>同時</strong>符合 prod deployment 以及 canary deployment 。 然而, 因為 canary deployment 的 pods 數量較少, 所以它對使用者的可見度來說是相對低的。</p>
<p><br></p>
<h3 id="確認-canary-deployment"><a href="#確認-canary-deployment" class="headerlink" title="確認 canary deployment"></a>確認 canary deployment</h3><p>你可以發請求, 並經由以下指令來確認服務該請求的 <code>hello</code> 版本<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">curl -ks https://`kubectl get svc frontend -o=jsonpath=<span class="hljs-string">"&#123;.status.loadBalancer.ingress[0].ip&#125;"</span>`/version</span><br></pre></td></tr></table></figure></p>
<p>執行這個指令多次, 你應會看到有一些請求是由 hello 1.0.0 所服務, 而有一小部分 (1/4 = 25%) 的請求是由 2.0.0 所服務</p>
<p><strong>測試進度</strong><br>點擊 <strong>Check my progress</strong> 來確認目前的進度。如果你已經建立金絲雀部署, 你將獲得一個評價分數。</p>
<p><img src="https://lh3.googleusercontent.com/4wsgxe7rn5pd6x5vPWs9SQs0lYcr8ZIdphNq4nlj7ClovmXhK7cmTMHyvXQe6b7UsgN_XK74hTJZ2b3IraF8osHaruM8LGuGWeW_i4Cx6orFHCT2wDJWesEWCpVbcb6q6tq1o9a1lHQ=w1280-h212-no" alt></p>
<p><br></p>
<h3 id="在正式環境中的-Canary-deployments-session-affinity"><a href="#在正式環境中的-Canary-deployments-session-affinity" class="headerlink" title="在正式環境中的 Canary deployments - session affinity"></a>在正式環境中的 Canary deployments - session affinity</h3><p>在本教程中, 每個發往 Nginx 服務的請求都有機率由 canary deployment 所服務。 但如果是你不想要某些使用者是由 canary deployment 來服務呢？ 一個使用情境是當你 canary deployment 的 UI 有變動, 而你不想要讓使用者覺得疑惑。 在這個使用情境中, 你想要讓使用者們可以固定的被不同的 deployment 所服務, 不會一直切換來切換去的。</p>
<p>你可以建立一個賦有 session affinity 的 service 。 這個方法會讓使用者總是被同一個版本的 deployment 服務。 在以下的範例中, service 跟之前的沒什麼不同, 但多了一個 <code>sessionAffinity</code> 欄位, 並設定成 ClientIP 。 所有有著相同 IP 的客戶端將會由相同的 <code>hello</code> 版本的應用所服務<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">kind: Service</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  name: &quot;hello&quot;</span><br><span class="line">spec:</span><br><span class="line">  sessionAffinity: ClientIP</span><br><span class="line">  selector:</span><br><span class="line">    app: &quot;hello&quot;</span><br><span class="line">  ports:</span><br><span class="line">    - protocol: &quot;TCP&quot;</span><br><span class="line">      port: 80</span><br><span class="line">      targetPort: 80</span><br></pre></td></tr></table></figure></p>
<p>因為這個情境比較難測試, 所以我們不必在此測試, 但你可能會想要在正式環境中使用 <code>sessionAffinity</code></p>
<p><br><br><br></p>
<h2 id="Blue-green-deployment"><a href="#Blue-green-deployment" class="headerlink" title="Blue-green deployment"></a>Blue-green deployment</h2><p>滾動升級是個理想的部署方式, 因為它讓我們可以用最小效能影響, downtime, 以及花費來部署應用。 然而在某些情況中, 待新版本部署完成後, 修改平衡負載指向新版本, 這種方式會是比較有利的。 在這樣的使用情境下, blue-green 部署會是我們需要的方式<br>Kubernetes 藉由建立兩個分開的 deployments 來達成這個目的; 一個舊的 “blue” 版本的 deployment 以及一個新的 “green” 版本的 deployment 。 使用已存在的 <code>hello</code> 來作為 “blue” 版本。 這個 deployment 將會透過一個角色為路由的 Service 來被存取。 一旦新的 “green” 版本已成功啟動並且運行中, 你可以藉由更新這個 service 來切換使用新版本。<br><img src="https://lh3.googleusercontent.com/eOaxMaMwxTAAH-o6CkzzGIW49fQa2L5W6L8Mrb8nrGVgwdl_-PU-4HOJie0OTZhq8o4zlhZQLhUPALaE_heyXkqs5l-sqlUYwLXe2-e35TlcYv0li_YNNE5ZU5phxTATrd8fZ3LbacCEvLwJaGbY-zx6ucd1dN-Z6j8P2UHfYmykdE4PISQeKelLdkW7zuaOKxW5E0ZRn69bfXDgo0EYqDbi50obj7pfRALc5WRSRjy-P_BlOrQ547QnH3zpKn0-T6S-o7CbFGk5wPcPOG3DMh7yA49STT7ixlRekZDIca8Oefqq7o7WcpvSYmUQW0L2iTKMxxvLi8gOqUNyNdJvj0mNsk-CsD3fjY2aKVvhDd3O-OR8ILYvPswTiP_3RXzaE79GI5gspFNdod3x4aOV8AgCHeE9u6Es_fO8gFE3YFnvKuQWIV8SpGLsx902U6yTEwpWKlB4RkCm2qL9Apk7EvQTh7paD8tgrg-bk6P_hlIKLvH8135lvibhGxXg-6M2O6pkBQyaqYFCJZRLsAeQiGG6ZSXPMlpYNgDULES1HzU2ZFZiubXAe0O4yUuoaKlcgO3Uela2_8Vp_CuubVTgUWpk2S8s7Cm-wR_y_VMaqWOt9H03Abb6Frp2TVOIeZb4nJGKMh3q0Uvn9vzTb-fKlRQ2PLcrUl99HWf-nkmzguEqvp7HCScJzqphAMOkcvcjWH1_QL1xZJCsNYGeaJY7vMpB6478Nkfix0DCf4KesGfRqHoM=w950-h618-no" alt></p>
<p>blue-green deployments 有一個主要的缺點, 那就是你必須在叢集中要有至少 2 組以上的資源來運行你的應用。 在你同時部署兩個版本的應用到叢集之前, 務必確認你有足夠的資源。</p>
<p><br></p>
<h3 id="The-service-服務"><a href="#The-service-服務" class="headerlink" title="The service (服務)"></a>The service (服務)</h3><p>使用已存在的 hello service, 但是把它的 selector 更新成 <code>app:hello</code>, <code>version: 1.0.0</code> 。 這個 selector 會符合 “blue” deployment, 但不會符合 “green” deployment 因為它使用不同的版本<br>首先更新服務：<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl apply -f services/hello-blue.yaml</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="更新使用-Blue-Green-deployment"><a href="#更新使用-Blue-Green-deployment" class="headerlink" title="更新使用 Blue-Green deployment"></a>更新使用 Blue-Green deployment</h3><p>我們將建立一個新版本 “green” deployment 來支援 blue-green deployment 風格。 這個 green deployment 更新了版本標籤以及鏡像路徑。<br><figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">hello-green</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">3</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line"><span class="hljs-attr">        version:</span> <span class="hljs-number">2.0</span><span class="hljs-number">.0</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">kelseyhightower/hello:2.0.0</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">          resources:</span></span><br><span class="line"><span class="hljs-attr">            limits:</span></span><br><span class="line"><span class="hljs-attr">              cpu:</span> <span class="hljs-number">0.2</span></span><br><span class="line"><span class="hljs-attr">              memory:</span> <span class="hljs-number">10</span><span class="hljs-string">Mi</span></span><br><span class="line"><span class="hljs-attr">          livenessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/healthz</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            periodSeconds:</span> <span class="hljs-number">15</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">          readinessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/readiness</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">1</span></span><br></pre></td></tr></table></figure></p>
<p>建立 green deployment<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl create -f deployments/hello-green.yaml</span><br></pre></td></tr></table></figure></p>
<p>一但你已經建立好 green deployment, 並且它已經被正確啟動且運行, 確認目前是否還是使用 1.0.0 的版本<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">curl -ks https://`kubectl get svc frontend -o=jsonpath=<span class="hljs-string">"&#123;.status.loadBalancer.ingress[0].ip&#125;"</span>`/version</span><br></pre></td></tr></table></figure></p>
<p>現在更新服務來指向新的 deployment 版本<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl apply -f services/hello-green.yaml</span><br></pre></td></tr></table></figure></p>
<p>當 service 被更新後, “green” deployment 會立即地被使用。 你可以確認新版本是否一直被使用著<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">curl -ks https://`kubectl get svc frontend -o=jsonpath=<span class="hljs-string">"&#123;.status.loadBalancer.ingress[0].ip&#125;"</span>`/version</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="Blue-Green-回滾"><a href="#Blue-Green-回滾" class="headerlink" title="Blue-Green 回滾"></a>Blue-Green 回滾</h3><p>如果需要的話, 你也可以使用同樣的方式回滾到舊的版本。 儘管 “blue” deployment 還在運行著, 可以直接更新 service 到舊的版本<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">kubectl apply -f services/hello-blue.yaml</span><br></pre></td></tr></table></figure></p>
<p>一但你更新了服務, 回滾也就完成了。 再一次, 確認看看目前使用中的是否是正確的版本<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">curl -ks https://`kubectl get svc frontend -o=jsonpath=<span class="hljs-string">"&#123;.status.loadBalancer.ingress[0].ip&#125;"</span>`/version</span><br></pre></td></tr></table></figure></p>
<p>你做到了！ 你已經學到 blue-green deployment 以及如何立即全部一次切換的部署方法</p>
<p><br><br><br></p>
<h2 id="恭喜"><a href="#恭喜" class="headerlink" title="恭喜"></a>恭喜</h2><p>你已經完成本教程!</p>
<p><br><br><br></p>
<h2 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h2><ul>
<li><p><strong>以下的 deployment yaml 檔設定分別代表什麼意思？</strong></p>
<ul>
<li><p><strong>deployment yaml</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">1</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">"kelseyhightower/auth:1.0.0"</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Answer</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-comment"># apiVersion: 版本, 會隨著版本而變動, 可參考[文件](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.16/#-strong-api-overview-strong-)</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-comment"># 種類, 可參考[文件](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.16/#-strong-api-overview-strong-)</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-comment"># 該 Deployment 的 metadata</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-comment"># 該 deployment 的 name</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-comment"># 該 deployment 運行的規格</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-comment"># pod 數量</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">1</span></span><br><span class="line">  <span class="hljs-comment"># pod 樣板</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line">    <span class="hljs-comment"># pod 的 metadata</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line">      <span class="hljs-comment"># label, 可被 selector 挑選, 為 key/value pair</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line">    <span class="hljs-comment"># pod 運行規格</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line">      <span class="hljs-comment"># 定義容器</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line">          <span class="hljs-comment"># 容器名稱</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">auth</span></span><br><span class="line">          <span class="hljs-comment"># 鏡像名稱</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">"kelseyhightower/auth:1.0.0"</span></span><br><span class="line">          <span class="hljs-comment"># 定義 port</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line">              <span class="hljs-comment"># port 名稱</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line">              <span class="hljs-comment"># port 號</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line">              <span class="hljs-comment"># port 名稱</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line">              <span class="hljs-comment"># port 號</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>以下的 Kubernetes yaml 設定檔的意思是？</strong></p>
<ul>
<li><p><strong>yaml 檔</strong></p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">1</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">"kelseyhightower/auth:2.0.0"</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">          resources:</span></span><br><span class="line"><span class="hljs-attr">            limits:</span></span><br><span class="line"><span class="hljs-attr">              cpu:</span> <span class="hljs-number">0.2</span></span><br><span class="line"><span class="hljs-attr">              memory:</span> <span class="hljs-string">"10Mi"</span></span><br><span class="line"><span class="hljs-attr">          livenessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/healthz</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            periodSeconds:</span> <span class="hljs-number">15</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">          readinessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/readiness</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Answer</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-comment"># api 版本</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-comment"># 種類為 Deployment</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-comment"># Deployment 的 metadata</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-comment"># Deployment 的 name</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-comment"># 該 Deployment 運行的規格</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-comment"># 該 Deployment 共會啟動幾個 Pod</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">1</span></span><br><span class="line">  <span class="hljs-comment"># 該 Pod 的詳細資料</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line">    <span class="hljs-comment"># 該 Pod 的 metadata</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line">      <span class="hljs-comment"># 該 Pod 的 label, 可透過 selector 被選取</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line">        <span class="hljs-comment"># 自定義的 key/value pair</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">auth</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line">    <span class="hljs-comment"># 該 Pod 的規格</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line">      <span class="hljs-comment"># 容器規格</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line">          <span class="hljs-comment"># 容器名稱</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">auth</span></span><br><span class="line">          <span class="hljs-comment"># 鏡像名稱</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">"kelseyhightower/auth:2.0.0"</span></span><br><span class="line">          <span class="hljs-comment"># 該容器的 port 定義</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line">              <span class="hljs-comment"># port 名稱</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line">              <span class="hljs-comment"># port 號</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line">              <span class="hljs-comment"># port 名稱</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line">              <span class="hljs-comment"># port 號</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br><span class="line">          <span class="hljs-comment"># 容器的資源定義</span></span><br><span class="line"><span class="hljs-attr">          resources:</span></span><br><span class="line">            <span class="hljs-comment"># 限制</span></span><br><span class="line"><span class="hljs-attr">            limits:</span></span><br><span class="line"><span class="hljs-attr">              cpu:</span> <span class="hljs-number">0.2</span></span><br><span class="line"><span class="hljs-attr">              memory:</span> <span class="hljs-string">"10Mi"</span></span><br><span class="line">          <span class="hljs-comment"># 存活探針</span></span><br><span class="line"><span class="hljs-attr">          livenessProbe:</span></span><br><span class="line">            <span class="hljs-comment"># 探測類型</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line">              <span class="hljs-comment"># 探測路徑</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/healthz</span></span><br><span class="line">              <span class="hljs-comment"># 探測 port 號</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line">            <span class="hljs-comment"># 首次執行探針時需要延遲的時間, 以確保容器內各項工作都已準備就緒, 如果一啟動就探測的話很可能會直接失敗</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">            <span class="hljs-comment"># 每隔 15 秒探測一次</span></span><br><span class="line"><span class="hljs-attr">            periodSeconds:</span> <span class="hljs-number">15</span></span><br><span class="line">            <span class="hljs-comment"># 探測時, 如果超過幾秒沒回覆視為失敗</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">          <span class="hljs-comment"># 就緒探針, 如果尚未就緒, service 不會將流量導向該容器</span></span><br><span class="line"><span class="hljs-attr">          readinessProbe:</span></span><br><span class="line">            <span class="hljs-comment"># 探測方式為 httpGet</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line">              <span class="hljs-comment"># 探測 url</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/readiness</span></span><br><span class="line">              <span class="hljs-comment"># 探測 port 號</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line">              <span class="hljs-comment"># 使用 http 還是 https</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line">            <span class="hljs-comment"># 首次啟動 readinessProbe 時, 等待五秒</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">            <span class="hljs-comment"># 若超過 1 秒沒有 response, 視為失敗</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>請解釋以下 kubernetes yaml file 中的每一條 directive</strong></p>
<ul>
<li><p><strong>yaml file</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">frontend</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">1</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">frontend</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">nginx</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">"nginx:1.9.14"</span></span><br><span class="line"><span class="hljs-attr">          lifecycle:</span></span><br><span class="line"><span class="hljs-attr">            preStop:</span></span><br><span class="line"><span class="hljs-attr">              exec:</span></span><br><span class="line"><span class="hljs-attr">                command:</span> <span class="hljs-string">["/usr/sbin/nginx","-s","quit"]</span></span><br><span class="line"><span class="hljs-attr">          volumeMounts:</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">"nginx-frontend-conf"</span></span><br><span class="line"><span class="hljs-attr">              mountPath:</span> <span class="hljs-string">"/etc/nginx/conf.d"</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">"tls-certs"</span></span><br><span class="line"><span class="hljs-attr">              mountPath:</span> <span class="hljs-string">"/etc/tls"</span></span><br><span class="line"><span class="hljs-attr">      volumes:</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">"tls-certs"</span></span><br><span class="line"><span class="hljs-attr">          secret:</span></span><br><span class="line"><span class="hljs-attr">            secretName:</span> <span class="hljs-string">"tls-certs"</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">"nginx-frontend-conf"</span></span><br><span class="line"><span class="hljs-attr">          configMap:</span></span><br><span class="line"><span class="hljs-attr">            name:</span> <span class="hljs-string">"nginx-frontend-conf"</span></span><br><span class="line"><span class="hljs-attr">            items:</span></span><br><span class="line"><span class="hljs-attr">              - key:</span> <span class="hljs-string">"frontend.conf"</span></span><br><span class="line"><span class="hljs-attr">                path:</span> <span class="hljs-string">"frontend.conf"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Answer</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-comment"># API 版本</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-comment"># 種類為 Deployment</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-comment"># 該 Deployment metadata</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-comment"># 該 Deployment name 為 frontend</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">frontend</span></span><br><span class="line"><span class="hljs-comment"># 該 Deployment 運行規格</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-comment"># 啟動 1 個 pod</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">1</span></span><br><span class="line">  <span class="hljs-comment"># 該 pod 模板</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line">    <span class="hljs-comment"># 該 pod metadata</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line">      <span class="hljs-comment"># label, 可被 selector 選擇</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">frontend</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line">    <span class="hljs-comment"># 該 pod 運行規格</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line">      <span class="hljs-comment"># 定義容器</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line">          <span class="hljs-comment"># 容器名稱</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">nginx</span></span><br><span class="line">          <span class="hljs-comment"># 鏡像名稱</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">"nginx:1.9.14"</span></span><br><span class="line">          <span class="hljs-comment"># 定義生命週期</span></span><br><span class="line"><span class="hljs-attr">          lifecycle:</span></span><br><span class="line">            <span class="hljs-comment"># preStop hook</span></span><br><span class="line"><span class="hljs-attr">            preStop:</span></span><br><span class="line">              <span class="hljs-comment"># hook handler 為 exec</span></span><br><span class="line"><span class="hljs-attr">              exec:</span></span><br><span class="line">                <span class="hljs-comment"># 執行指令, 用意為在停止前優雅退出 nginx</span></span><br><span class="line"><span class="hljs-attr">                command:</span> <span class="hljs-string">["/usr/sbin/nginx","-s","quit"]</span></span><br><span class="line">          <span class="hljs-comment"># 掛載 volume</span></span><br><span class="line"><span class="hljs-attr">          volumeMounts:</span></span><br><span class="line">              <span class="hljs-comment"># 使用的 volume name</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">"nginx-frontend-conf"</span></span><br><span class="line">              <span class="hljs-comment"># 掛載於容器內的位置</span></span><br><span class="line"><span class="hljs-attr">              mountPath:</span> <span class="hljs-string">"/etc/nginx/conf.d"</span></span><br><span class="line">              <span class="hljs-comment"># 使用的 volume name</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">"tls-certs"</span></span><br><span class="line">              <span class="hljs-comment"># 掛載於容器內的位置</span></span><br><span class="line"><span class="hljs-attr">              mountPath:</span> <span class="hljs-string">"/etc/tls"</span></span><br><span class="line">      <span class="hljs-comment"># 定義容器</span></span><br><span class="line"><span class="hljs-attr">      volumes:</span></span><br><span class="line">          <span class="hljs-comment"># 定義 volume name</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">"tls-certs"</span></span><br><span class="line">          <span class="hljs-comment"># volume 來源為 secret</span></span><br><span class="line"><span class="hljs-attr">          secret:</span></span><br><span class="line">            <span class="hljs-comment"># 使用的 secret name</span></span><br><span class="line"><span class="hljs-attr">            secretName:</span> <span class="hljs-string">"tls-certs"</span></span><br><span class="line">          <span class="hljs-comment"># 定義 volume name</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">"nginx-frontend-conf"</span></span><br><span class="line">          <span class="hljs-comment"># volume 來源為 configMap</span></span><br><span class="line"><span class="hljs-attr">          configMap:</span></span><br><span class="line">            <span class="hljs-comment"># 使用的 configMap name</span></span><br><span class="line"><span class="hljs-attr">            name:</span> <span class="hljs-string">"nginx-frontend-conf"</span></span><br><span class="line">            <span class="hljs-comment"># 指定該 configMap 內的 key</span></span><br><span class="line"><span class="hljs-attr">            items:</span></span><br><span class="line">                <span class="hljs-comment"># 取得  nginx-frontend-conf configMap 中的 frontend.conf 的 key</span></span><br><span class="line"><span class="hljs-attr">              - key:</span> <span class="hljs-string">"frontend.conf"</span></span><br><span class="line">                <span class="hljs-comment"># 指定掛載後的位置</span></span><br><span class="line"><span class="hljs-attr">                path:</span> <span class="hljs-string">"frontend.conf"</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>請解釋以下 kubernetes yaml file 中的每一條 directive</strong></p>
<ul>
<li><p><strong>yaml file</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">hello-canary</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">1</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">canary</span></span><br><span class="line"><span class="hljs-attr">        version:</span> <span class="hljs-number">2.0</span><span class="hljs-number">.0</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">kelseyhightower/hello:2.0.0</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">          resources:</span></span><br><span class="line"><span class="hljs-attr">            limits:</span></span><br><span class="line"><span class="hljs-attr">              cpu:</span> <span class="hljs-number">0.2</span></span><br><span class="line"><span class="hljs-attr">              memory:</span> <span class="hljs-number">10</span><span class="hljs-string">Mi</span></span><br><span class="line"><span class="hljs-attr">          livenessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/healthz</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            periodSeconds:</span> <span class="hljs-number">15</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">          readinessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/readiness</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Answer</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-comment"># API 版本</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-comment"># 種類為 Deployment</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-comment"># 該 Deployment metadata</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-comment"># 該 Deployment name</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">hello-canary</span></span><br><span class="line"><span class="hljs-comment"># 該 Deployment 運行規格</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-comment"># 啟動一個 pod</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">1</span></span><br><span class="line">  <span class="hljs-comment"># 該 Pod 範本</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line">    <span class="hljs-comment"># 該 pod 的 metadata</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line">      <span class="hljs-comment"># 定義 labels</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">canary</span></span><br><span class="line"><span class="hljs-attr">        version:</span> <span class="hljs-number">2.0</span><span class="hljs-number">.0</span></span><br><span class="line">    <span class="hljs-comment"># 該 pod 運行規格</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line">      <span class="hljs-comment"># 定義容器</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line">          <span class="hljs-comment"># 容器 name</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">hello</span></span><br><span class="line">          <span class="hljs-comment"># 使用鏡像</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">kelseyhightower/hello:2.0.0</span></span><br><span class="line">          <span class="hljs-comment"># 定義 ports</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line">              <span class="hljs-comment"># port name</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line">              <span class="hljs-comment"># 容器內的 port</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line">              <span class="hljs-comment"># port name</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line">              <span class="hljs-comment"># 容器內的 port</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br><span class="line">          <span class="hljs-comment"># 定義資源限制</span></span><br><span class="line"><span class="hljs-attr">          resources:</span></span><br><span class="line">            <span class="hljs-comment"># 定義 limits 類型資源限制</span></span><br><span class="line"><span class="hljs-attr">            limits:</span></span><br><span class="line"><span class="hljs-attr">              cpu:</span> <span class="hljs-number">0.2</span></span><br><span class="line"><span class="hljs-attr">              memory:</span> <span class="hljs-number">10</span><span class="hljs-string">Mi</span></span><br><span class="line">          <span class="hljs-comment"># 定義存活探針</span></span><br><span class="line"><span class="hljs-attr">          livenessProbe:</span></span><br><span class="line">            <span class="hljs-comment"># 使用 httpGet 方式探測</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line">              <span class="hljs-comment"># 指定探測的 path</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/healthz</span></span><br><span class="line">              <span class="hljs-comment"># 指定探測的 port</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line">              <span class="hljs-comment"># 指定探測的 scheme</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line">            <span class="hljs-comment"># 容器啟動後延遲五秒再開始探測</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">            <span class="hljs-comment"># 每十五秒探測一次</span></span><br><span class="line"><span class="hljs-attr">            periodSeconds:</span> <span class="hljs-number">15</span></span><br><span class="line">            <span class="hljs-comment"># 超過五秒沒回應, 視為失敗</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">          <span class="hljs-comment"># 定義就緒探針</span></span><br><span class="line"><span class="hljs-attr">          readinessProbe:</span></span><br><span class="line">            <span class="hljs-comment"># 使用 httpGet 方式探測</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line">              <span class="hljs-comment"># 指定探測的 path</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/readiness</span></span><br><span class="line">              <span class="hljs-comment"># 指定探測的 port</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line">              <span class="hljs-comment"># 指定探測的 scheme</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line">            <span class="hljs-comment"># 容器啟動後延遲五秒再開始探測</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">            <span class="hljs-comment"># 超過五秒沒回應, 視為失敗</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>請解釋以下 kubernetes yaml file 中的每一條 directive</strong></p>
<ul>
<li><p><strong>yaml file</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">hello-green</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">3</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line"><span class="hljs-attr">        version:</span> <span class="hljs-number">2.0</span><span class="hljs-number">.0</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">kelseyhightower/hello:2.0.0</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">          resources:</span></span><br><span class="line"><span class="hljs-attr">            limits:</span></span><br><span class="line"><span class="hljs-attr">              cpu:</span> <span class="hljs-number">0.2</span></span><br><span class="line"><span class="hljs-attr">              memory:</span> <span class="hljs-number">10</span><span class="hljs-string">Mi</span></span><br><span class="line"><span class="hljs-attr">          livenessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/healthz</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            periodSeconds:</span> <span class="hljs-number">15</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">          readinessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/readiness</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Answer</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-comment"># API version</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-comment"># The kind is Deployment</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-comment"># The metadata of the Deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-comment"># The name of the Deployment</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">hello-green</span></span><br><span class="line"><span class="hljs-comment"># The spec</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-comment"># Desired number of pod is 3</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">3</span></span><br><span class="line">  <span class="hljs-comment"># the template of the pod</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line">    <span class="hljs-comment"># the metadata of the pod</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line">      <span class="hljs-comment"># labels, could be selected by selector</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line"><span class="hljs-attr">        version:</span> <span class="hljs-number">2.0</span><span class="hljs-number">.0</span></span><br><span class="line">    <span class="hljs-comment"># spec of the pod</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line">      <span class="hljs-comment"># define containers</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">kelseyhightower/hello:2.0.0</span></span><br><span class="line">          <span class="hljs-comment"># define ports</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br><span class="line">          <span class="hljs-comment"># define constraint resources</span></span><br><span class="line"><span class="hljs-attr">          resources:</span></span><br><span class="line"><span class="hljs-attr">            limits:</span></span><br><span class="line"><span class="hljs-attr">              cpu:</span> <span class="hljs-number">0.2</span></span><br><span class="line"><span class="hljs-attr">              memory:</span> <span class="hljs-number">10</span><span class="hljs-string">Mi</span></span><br><span class="line">          <span class="hljs-comment"># define liveness probe</span></span><br><span class="line"><span class="hljs-attr">          livenessProbe:</span></span><br><span class="line">            <span class="hljs-comment"># use httpGet probe</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/healthz</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line">            <span class="hljs-comment"># wait for 5 seconds after the container starts before starting to probe</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">            <span class="hljs-comment"># probe every 15 seconds </span></span><br><span class="line"><span class="hljs-attr">            periodSeconds:</span> <span class="hljs-number">15</span></span><br><span class="line">            <span class="hljs-comment"># consider it fails if not get responses for 5 seconds</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">          <span class="hljs-comment"># define readiness probe</span></span><br><span class="line"><span class="hljs-attr">          readinessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/readiness</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>請解釋以下 kubernetes yaml file 中的每一條 directive</strong></p>
<ul>
<li><p><strong>yaml file</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">3</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line"><span class="hljs-attr">        version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">"kelseyhightower/hello:1.0.0"</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">          resources:</span></span><br><span class="line"><span class="hljs-attr">            limits:</span></span><br><span class="line"><span class="hljs-attr">              cpu:</span> <span class="hljs-number">0.2</span></span><br><span class="line"><span class="hljs-attr">              memory:</span> <span class="hljs-string">"10Mi"</span></span><br><span class="line"><span class="hljs-attr">          livenessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/healthz</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            periodSeconds:</span> <span class="hljs-number">15</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">          readinessProbe:</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/readiness</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Answer</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-comment"># API 版本</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">extensions/v1beta1</span></span><br><span class="line"><span class="hljs-comment"># 種類為 Deployment</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span></span><br><span class="line"><span class="hljs-comment"># the metadata of the deployment</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-comment"># define the deployment name</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-comment"># define the spec of the deployment</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-comment"># it will start 3 pods</span></span><br><span class="line"><span class="hljs-attr">  replicas:</span> <span class="hljs-number">3</span></span><br><span class="line">  <span class="hljs-comment"># define the template of the pod</span></span><br><span class="line"><span class="hljs-attr">  template:</span></span><br><span class="line">    <span class="hljs-comment"># define the metadata of the pod</span></span><br><span class="line"><span class="hljs-attr">    metadata:</span></span><br><span class="line">      <span class="hljs-comment"># define teh labels, which could be selected by Selector</span></span><br><span class="line"><span class="hljs-attr">      labels:</span></span><br><span class="line"><span class="hljs-attr">        app:</span> <span class="hljs-string">hello</span></span><br><span class="line"><span class="hljs-attr">        track:</span> <span class="hljs-string">stable</span></span><br><span class="line"><span class="hljs-attr">        version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span></span><br><span class="line">    <span class="hljs-comment"># define the spec of the pod</span></span><br><span class="line"><span class="hljs-attr">    spec:</span></span><br><span class="line">      <span class="hljs-comment"># define containers</span></span><br><span class="line"><span class="hljs-attr">      containers:</span></span><br><span class="line">          <span class="hljs-comment"># define container name</span></span><br><span class="line"><span class="hljs-attr">        - name:</span> <span class="hljs-string">hello</span></span><br><span class="line">          <span class="hljs-comment"># used image</span></span><br><span class="line"><span class="hljs-attr">          image:</span> <span class="hljs-string">"kelseyhightower/hello:1.0.0"</span></span><br><span class="line">          <span class="hljs-comment"># define ports</span></span><br><span class="line"><span class="hljs-attr">          ports:</span></span><br><span class="line">              <span class="hljs-comment"># define port name</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">http</span></span><br><span class="line">              <span class="hljs-comment"># define port inside the container</span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">80</span></span><br><span class="line">              <span class="hljs-comment"># define port name</span></span><br><span class="line"><span class="hljs-attr">            - name:</span> <span class="hljs-string">health</span></span><br><span class="line">              <span class="hljs-comment"># define port inside the container </span></span><br><span class="line"><span class="hljs-attr">              containerPort:</span> <span class="hljs-number">81</span></span><br><span class="line">          <span class="hljs-comment"># define resources</span></span><br><span class="line"><span class="hljs-attr">          resources:</span></span><br><span class="line">            <span class="hljs-comment"># define limits resources</span></span><br><span class="line"><span class="hljs-attr">            limits:</span></span><br><span class="line"><span class="hljs-attr">              cpu:</span> <span class="hljs-number">0.2</span></span><br><span class="line"><span class="hljs-attr">              memory:</span> <span class="hljs-string">"10Mi"</span></span><br><span class="line">          <span class="hljs-comment"># define liveness probe</span></span><br><span class="line"><span class="hljs-attr">          livenessProbe:</span></span><br><span class="line">            <span class="hljs-comment"># using httpGet probe</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line">              <span class="hljs-comment"># define probe path</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/healthz</span></span><br><span class="line">              <span class="hljs-comment"># define probe port</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line">              <span class="hljs-comment"># define probe scheme</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line">            <span class="hljs-comment"># the liveness probe will start to probe 5 seconds after the container starts</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">            <span class="hljs-comment"># probe every 15 seconds</span></span><br><span class="line"><span class="hljs-attr">            periodSeconds:</span> <span class="hljs-number">15</span></span><br><span class="line">            <span class="hljs-comment"># if the probe doesn't receive responses for 5 seconds, it's considered failed</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">          <span class="hljs-comment"># define readiness probe</span></span><br><span class="line"><span class="hljs-attr">          readinessProbe:</span></span><br><span class="line">            <span class="hljs-comment"># use httpGet probe</span></span><br><span class="line"><span class="hljs-attr">            httpGet:</span></span><br><span class="line">              <span class="hljs-comment"># specify probe path</span></span><br><span class="line"><span class="hljs-attr">              path:</span> <span class="hljs-string">/readiness</span></span><br><span class="line">              <span class="hljs-comment"># specify probe port</span></span><br><span class="line"><span class="hljs-attr">              port:</span> <span class="hljs-number">81</span></span><br><span class="line">              <span class="hljs-comment"># specify probe scheme</span></span><br><span class="line"><span class="hljs-attr">              scheme:</span> <span class="hljs-string">HTTP</span></span><br><span class="line">            <span class="hljs-comment"># the readiness probe will start to probe 5 seconds after the container starts</span></span><br><span class="line"><span class="hljs-attr">            initialDelaySeconds:</span> <span class="hljs-number">5</span></span><br><span class="line">            <span class="hljs-comment"># if the probe doesn't receive responses for 5 seconds, it's considered failed</span></span><br><span class="line"><span class="hljs-attr">            timeoutSeconds:</span> <span class="hljs-number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>請解釋以下 kubernetes yaml file 中的每一條 directive</strong></p>
<ul>
<li><p><strong>yaml file</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">"auth"</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  selector:</span></span><br><span class="line"><span class="hljs-attr">    app:</span> <span class="hljs-string">"auth"</span></span><br><span class="line"><span class="hljs-attr">  ports:</span></span><br><span class="line"><span class="hljs-attr">    - protocol:</span> <span class="hljs-string">"TCP"</span></span><br><span class="line"><span class="hljs-attr">      port:</span> <span class="hljs-number">80</span></span><br><span class="line"><span class="hljs-attr">      targetPort:</span> <span class="hljs-number">80</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Answer</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-comment"># 種類為 Service</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span></span><br><span class="line"><span class="hljs-comment"># API 版本為 v1</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span></span><br><span class="line"><span class="hljs-comment"># 此 Service 的 metadata</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-comment"># 此 Service 的 name</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">"auth"</span></span><br><span class="line"><span class="hljs-comment"># 此 Service 的運行規格</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-comment"># 可選擇指定 label, 並將流量導向這些 pod</span></span><br><span class="line"><span class="hljs-attr">  selector:</span></span><br><span class="line"><span class="hljs-attr">    app:</span> <span class="hljs-string">"auth"</span></span><br><span class="line">  <span class="hljs-comment"># 定義 port</span></span><br><span class="line"><span class="hljs-attr">  ports:</span></span><br><span class="line">      <span class="hljs-comment"># 使用 TCP protocol</span></span><br><span class="line"><span class="hljs-attr">    - protocol:</span> <span class="hljs-string">"TCP"</span></span><br><span class="line">      <span class="hljs-comment"># service 的 port 為 80</span></span><br><span class="line"><span class="hljs-attr">      port:</span> <span class="hljs-number">80</span></span><br><span class="line">      <span class="hljs-comment"># 目標對象的 port 為 80</span></span><br><span class="line"><span class="hljs-attr">      targetPort:</span> <span class="hljs-number">80</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>請解釋以下的 kubernetes yaml file 中的每一條 directive</strong></p>
<ul>
<li><p><strong>yaml file</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">"monolith"</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  selector:</span></span><br><span class="line"><span class="hljs-attr">    app:</span> <span class="hljs-string">"monolith"</span></span><br><span class="line"><span class="hljs-attr">    secure:</span> <span class="hljs-string">"enabled"</span></span><br><span class="line"><span class="hljs-attr">  ports:</span></span><br><span class="line"><span class="hljs-attr">    - protocol:</span> <span class="hljs-string">"TCP"</span></span><br><span class="line"><span class="hljs-attr">      port:</span> <span class="hljs-number">443</span></span><br><span class="line"><span class="hljs-attr">      targetPort:</span> <span class="hljs-number">443</span></span><br><span class="line"><span class="hljs-attr">      nodePort:</span> <span class="hljs-number">31000</span></span><br><span class="line"><span class="hljs-attr">  type:</span> <span class="hljs-string">NodePort</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Answer</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-comment"># 種類為 Service</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span></span><br><span class="line"><span class="hljs-comment"># API 版本為 v1</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span></span><br><span class="line"><span class="hljs-comment"># 該 service 的 metadata</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-comment"># 該 service name</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">"monolith"</span></span><br><span class="line"><span class="hljs-comment"># 該 service 運行規格</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-comment"># 會將流量導向符合此 label 的 pod</span></span><br><span class="line"><span class="hljs-attr">  selector:</span></span><br><span class="line"><span class="hljs-attr">    app:</span> <span class="hljs-string">"monolith"</span></span><br><span class="line"><span class="hljs-attr">    secure:</span> <span class="hljs-string">"enabled"</span></span><br><span class="line">  <span class="hljs-comment"># 定義 ports</span></span><br><span class="line"><span class="hljs-attr">  ports:</span></span><br><span class="line">      <span class="hljs-comment"># protocol 為 TCP</span></span><br><span class="line"><span class="hljs-attr">    - protocol:</span> <span class="hljs-string">"TCP"</span></span><br><span class="line">      <span class="hljs-comment"># service 的 port 為 443</span></span><br><span class="line"><span class="hljs-attr">      port:</span> <span class="hljs-number">443</span></span><br><span class="line">      <span class="hljs-comment"># 目標對象的 port 為 443</span></span><br><span class="line"><span class="hljs-attr">      targetPort:</span> <span class="hljs-number">443</span></span><br><span class="line">      <span class="hljs-comment"># 定義 node 的 31000 port 將流量導向 service 的 clusterIP</span></span><br><span class="line"><span class="hljs-attr">      nodePort:</span> <span class="hljs-number">31000</span></span><br><span class="line">  <span class="hljs-comment"># 使用 NodePort</span></span><br><span class="line"><span class="hljs-attr">  type:</span> <span class="hljs-string">NodePort</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>請解釋以下的 Kubernetes yaml file 中的每一條 directive</strong> </p>
<ul>
<li><p><strong>yaml file</strong></p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">"frontend"</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line"><span class="hljs-attr">  selector:</span></span><br><span class="line"><span class="hljs-attr">    app:</span> <span class="hljs-string">"frontend"</span></span><br><span class="line"><span class="hljs-attr">  ports:</span></span><br><span class="line"><span class="hljs-attr">    - protocol:</span> <span class="hljs-string">"TCP"</span></span><br><span class="line"><span class="hljs-attr">      port:</span> <span class="hljs-number">443</span></span><br><span class="line"><span class="hljs-attr">      targetPort:</span> <span class="hljs-number">443</span></span><br><span class="line"><span class="hljs-attr">  type:</span> <span class="hljs-string">LoadBalancer</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Answer</strong>:</p>
<figure class="highlight yaml hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-comment"># kind is service</span></span><br><span class="line"><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span></span><br><span class="line"><span class="hljs-comment"># api version is v1</span></span><br><span class="line"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span></span><br><span class="line"><span class="hljs-comment"># the metadata of the serivice</span></span><br><span class="line"><span class="hljs-attr">metadata:</span></span><br><span class="line">  <span class="hljs-comment"># the name of the service</span></span><br><span class="line"><span class="hljs-attr">  name:</span> <span class="hljs-string">"frontend"</span></span><br><span class="line"><span class="hljs-comment"># the spec of the service</span></span><br><span class="line"><span class="hljs-attr">spec:</span></span><br><span class="line">  <span class="hljs-comment"># those selected by this selector will be the endpoint to which the traffic is redirected</span></span><br><span class="line"><span class="hljs-attr">  selector:</span></span><br><span class="line">    <span class="hljs-comment"># an arbitrary key / value pair</span></span><br><span class="line"><span class="hljs-attr">    app:</span> <span class="hljs-string">"frontend"</span></span><br><span class="line">  <span class="hljs-comment"># define ports</span></span><br><span class="line"><span class="hljs-attr">  ports:</span></span><br><span class="line">      <span class="hljs-comment"># define the protocol</span></span><br><span class="line"><span class="hljs-attr">    - protocol:</span> <span class="hljs-string">"TCP"</span></span><br><span class="line">      <span class="hljs-comment"># define service port</span></span><br><span class="line"><span class="hljs-attr">      port:</span> <span class="hljs-number">443</span></span><br><span class="line">      <span class="hljs-comment"># define target endpoint' ports</span></span><br><span class="line"><span class="hljs-attr">      targetPort:</span> <span class="hljs-number">443</span></span><br><span class="line">  <span class="hljs-comment"># this option is only for cloud provider</span></span><br><span class="line"><span class="hljs-attr">  type:</span> <span class="hljs-string">LoadBalancer</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/zh-tw/tags/QWIKLABS/">#QWIKLABS</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/zh-tw/tags/GCP-Kubernetes-Engine/">#GCP Kubernetes Engine</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/zh-tw/tags/Kubernetes/">#Kubernetes</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/zh-tw/tags/Cloud-Architecture/">#Cloud Architecture</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/zh-tw/tags/Kubernetes-in-the-Google-Cloud/">#Kubernetes in the Google Cloud</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/zh-tw/laravel-basics-middleware/">Laravel - Basics - Middleware</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/zh-tw/kubernetes-workloads-controllers-deployments/">Kubernetes - Deployments</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="sharethis-inline-share-buttons"></div>
<script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5c72643b9ea706001139fd89&amp;product=inline-share-buttons" async="async"></script>

</div>



<div class="comments">
    <h3 class="title is-4">留言</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'https://tn710617.github.io/zh-tw/managingDeploymentsUsingKubernetesEngine/';
        this.page.identifier = 'zh-tw/managingDeploymentsUsingKubernetesEngine/';
        
        this.language = 'zh';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'rayscodingjourney' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2020 Ray&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            
                       <a class="navbar-item" title="GitHub" href="https://github.com/tn710617">
                           
                           <i class="fab fa-github"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="Medium" href="https://medium.com/@raycodingjourney">
                           
                           <i class="fab fa-medium"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="Linkedin" href="https://www.linkedin.com/in/ray-lee-99315315a">
                           
                           <i class="fab fa-linkedin"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="Facebook" href="https://www.facebook.com/profile.php?id=100001626039430">
                           
                           <i class="fab fa-facebook"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="CakeResume" href="https://www.cakeresume.com/resumes/ray-6edaef/edit">
                           
                           <i class="far fa-address-card"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="E-Mail" href="mailto:tn710617@gmail.com">
                           
                           <i class="far fa-envelope"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="Skype" href="skype:adad0310?call|chat">
                           
                           <i class="fab fa-skype"></i>
                           
                       </a>
                          
                       
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    


<script src="/js/script.js"></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="站內搜尋">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '頁面',
                CATEGORIES: '分類',
                TAGS: '標籤',
                UNTITLED: '(無標題)',
            },
            CONTENT_URL: '/content.zh-tw.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script>
    
</body>
</html>