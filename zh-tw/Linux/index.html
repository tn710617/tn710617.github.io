<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<title>Linux 基礎篇 - 學習筆記 - Ray&#39;s Coding Journey</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="前言這是一份未整理過的 Linux 學習筆記OS 系統為 GCP 上的 Linux 18.04 LTS內容參考出處：   鳥哥的 Linux 的私房菜 Internet">
<meta name="keywords" content="Linux">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 基礎篇 - 學習筆記">
<meta property="og:url" content="https://tn710617.github.io/zh-tw/Linux/index.html">
<meta property="og:site_name" content="Ray&#39;s Coding Journey">
<meta property="og:description" content="前言這是一份未整理過的 Linux 學習筆記OS 系統為 GCP 上的 Linux 18.04 LTS內容參考出處：   鳥哥的 Linux 的私房菜 Internet">
<meta property="og:locale" content="zh-tw">
<meta property="og:image" content="https://i.imgur.com/KqrTrVt.png">
<meta property="og:image" content="https://lh3.googleusercontent.com/ujo1cwLgxb9GgqIIdqpGbiVwAHTCD9z48ZKfMkBQq7UXS7kCVJaLDDrLGXnWPu6DhZmVrED0m0tq8Hw_ICWU31KNHbKBmhDMa0Yj-CyKY0J2zp6uVfNuty7NfHKWDe8y902-8-8Xc7tMw-PX_2EF3DMafEh-dFJXKXk4eSmBTArex8YnpqPdyKPIm1zkCK9KJ_EsVWxsC_vWU4w4UF2_zre0luizW27nPvUPCZ9Z9_Zm_hwP7xAM7TwbSSzA3_FB9oAgDSq70GRtk17wRM6davPmRCSmyV_G0PKHFu0W8EuSXMOfh6Ia8GQMDDBGx7peuoDNKhmReyBq4bYrgjpq2AQZMPF8pySqiZS1UDMJEzx2vESxznp2HCyrbyJL21peGC2ZPkwNKWatU9Q9JZQ8LWtFi1cFkQZQn7rJFNQ_95vDDZlmUZ2SOuigVGVh_GDWgCi9RIgsTqWQUMt6SklYnQE_kuQ9OjZrM8nAjF2QAgSufOhH_aKBFN6Dthsv60RJbfbpkS79Cs0L1HhkYM6LlCcXd35oHcVvbuKXQi4_XXbTvG6iXOD5LHYe9OzWzIl7pjP3hWxvItzXfAR24ASFg1nncoiDQ2WORrH9j7OFNGkdjEnEeW6KXj36GnwjoEb7WN7Lft3kbp-zAo1hPch7tCYuMfH5G1g=w493-h202-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/kiQmhpIYtgM4l2t1KCPxJkhAwZsd4J31bfbeKi2ORAiZJiLWiTyyvqY-qLUawL2l2Fm-PuQzYR2cl9eA-I9s30KbnOlscqATGTlcYbifeM1GjUauPH9aCxOOhegj2GOfoBGFOPVp8g=w285-h212-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/ClZmDGa1AqGInMNdmvEpVcdcwXs2xTfeyoyQPDdpyETIleyfMiE9-kG7oa862PU_IfGE1r7_DgAFJcc4DcbK6woPujZKaL4w4mnt_QCgpWuKxfHF6vMWfELK0MBmWO_5dN5Ge23EErmHe_DXWgby7hIrCrdIDXbvsHDEMzhI41nLqYVU63U3ITzFwIhQci4yt4VFRt1DrDTXrhOoznXxZvLMaPRQ-vLwGR6e7AtFe1gbHVskfPUOwyeVbZM1FtAsVPLreLCSpHAJE8uvWE4gwyPf9C8KVtJd0JyO32OsCBVAyBkL74SRgMELsfHvWYlZVmQ2mVWPpT5M-PXrFruk_-saaWUVDBRTQc4EJi6R9fxqOux_8dRLRncp8GVEI1ehzr5b5bAdkO-G0XceyWKUlihkhHE9obt-55oRS_qJALzJBXY5WPdwg9giTAnSBMSREbYwmSdjc9saUcVDuFzqKTv8LHE-2Thu-O7rvNAdg230r8Wpgr2q0ZfAfHc_5FJ9gSxk0ou0PNeKz2Qhs5tH384TEJoY_ysAPGRNFb9iBIKONYsYQXV9qdMXL1dx6-IApbstuSuoBQ-6J-GxtrC1P7nBVOOnrYRhbzlDOihNKEND4rq32Qc5lHVSGFXECMn6ZoifyvbEIFUYcaaC3xsbHrmFUBHSstU=w288-h411-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/jrRJScb-pQMJCDVUtEsOT5wvTB-VDkwyo5O0Rxz7NGrty0dO2n-51ewRk0G36FreHEeNZ5yn9ZsPQaDbiOR5cEeIal3heroIdozwlzaSw6dKYTAiykMa7Vik7P2niLeo_2devH-z7HSqt7b62hdjMJVGMy-l6DFwag_J04pdByCBMRgvQFjFV0BJkk9-5CivP99nkq97HRJ71Q5OeQ2Gz7iJYt7iJRPUOre4ZBXsDqqgCLtz__7sLX-H1cAmmxiUR5CoD_ZGCplK1I_dmog9pkCjjJMiLHq6a--WZtntCE3BgPthkKMUjoAbNiUIXMZs4fMkBsreYprosZS-YZ3tlNU2ktJ0o0IErBEVrLlHSnnSej431wuUwgok3Mm7SIo5a0OeBU7IusUJW4nAdJ1miQxT0ChmV2G1yGYsuIUP1xt2phgwmM0AbbC7ufv4Ie6wYgjtF8tCx0foKbR_CDV9ieP1fdmtJTJrS1GsryeIJBd77m1gRAnttA2q5DbgMbMsBDVPr8oEKpWSBc246eOJ6-2IgRNf94YhGPU1TUE8CahfrE8rMpxU_mHXio9s7EyrPoWhByfNZYJtl-WmSSTj5_f1KwGhfiBBOztcmBQy0jy-I70qxdqGn4hFhHoh_wie-QZQrLxO4PGRO_PoP72aAQL_f_27M8_KDI8Zq9SEP99QbAaed32EIzo=w976-h138-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/d6tEtO4_J_LcDP0YYQA1lwdmswV8N9YGLnXNVe5tx0oqVdyP_1OAW_R0DSmxNbVnpUvzVV4OWp3oYsL0CYCMgqf0DgSw1qZ-_mbvzlNdCMukoAiiSeppxH43gUBI9Am_ghjIVrljdOthya0XRQmDx1kqBL5m6EzWjiansImEfV6G37OfJxlyyi7q4bfKDjA0jFbFMHXAYJcc7X3t1_P2lKat8KwhO903Bv0WFyKMFRVMbtIg2zUmOHeSIG1NGdqjFbAhCPDViiGO5DJpaj8KgHAMLHlD4d3EUTC8NqdqhhfTRwUKi3jTcrvj4ymhbMchvXU3x-X56EN1qwcGvY_Z9AFXnK_1dnUOmD9sCy5o9xnc5Kez6MuvkspjKKttxw-a_xW0vkXP49biRDKUtpWXaM9kV8256925pqdc_bliYa3XDHVfTJz7O_fOjtzqlDUu_igu0Pxw3oV7V6aKtuOzN0inl4e5M5dhkCIVNcFKfw-1TyevCQNy7Zjm7gFdbZIj6f7Tu1FIoGvYfTL7b8sx7jSCHtjQ9CxZ3dAIn47rVjzqwg8ZzcNnzMzhS4GhKiFnH7z2zcaq-8w2A1SxALM2M9cvBmLCmoH-4sGbr-0VLEhu8wAObMFF9pSuwHHIEBCL6fPkaSDvV2-X4heMzET9mhEZxMYaSN0H_f6szQs_sSIbrU_ZKGLgKyY=w954-h304-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/pzdhfNflqtMI6cZjYXZVg9tJHaT5pJ-BxwH4MVG-niRbTDO4ex_SMTtevellUzgvtlI0UF1DlITGSe0cRjhsHF17f6HbMoVgrP665q0eJJ6mluUn9kmPhGjKG6t1QEQ6Mb8rB3oqLry8_-J06MMkEy2t_YJ6Kze2QVN_p7e72DRdHoNCmSCDUBGvHHRfJrystXFHqHq3kmN4zjTjaXIuXuapEgpLmxriroXgJP90pX5JUNylr60H20WEdT6WHHK9P2m7cDFVXUAvlIHv3P5l-AnxfmpWnnzxQDjYM_EzevIcs5-_xWMQ-E37PmFY2cISVZqJCy2-2sDhpi1aDVrFRK-yILq_yShfWcCiy-A2Lt2aIokyTbr05ISh6FlMAMmdXE5DU7mWYWfzNg7NruNJIwaD2BJiIQrXNvZB_W6ObUJeQqGXu8JI-oYLEm_SsLOuo-VBTY-ifmMZpJoaOMmaybwtRO-ZRWqhiOyT26Xse1a6rUkgCbmwRNFzjawQI9UF8dNRtJfQylNiUxFq8MD3XyNQH1kfPWDzSX_Uk2nDVB7MaRn5fX8btMxKM2a4DopA81ZYRXsc5WDcZe2cvFZlUJ5bRVEGETcznIESVnmA0GjhLBWBVeCc2no57UpB1bSmOUURZbkgcy3PQ-kyMEhY1ldFg2Kbp5GMPEoF5gJV60cOHg9NU9UwBS1sTuevj-HtH7WPa_hZ985HS3fZYc-xqFD7WPAxn0CfQYrOzxTqzw9-pyI2=w912-h234-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/chhghZWzziGWqyIby201KuMqTvUYYYxhRHDtBxgHrR6GRDRwbt3OLGqK8KjxgfBDhpcBvDjAsRknThJ1Hbvtf571SsMs4zCZEnjNkO72bQ4VFqlG2NjN5Tqj16eTZyUl51rTIR1qxPccQCYLJgDLMc5MWrSZBxbnoOyxvVLugwYiTmodZCXnWfADCtKwWOS1cgWkFNzjOKfsNlGTPtzgEOXleGVV-kEArO7UfgrAe0GwGnu89adWeC1Ik2VYz0qLgJJlSrtiiXCQo6DwSwoBqwyikRph_aZrCdAGf3c0hmGQLzpYs3juia0wZjTsf41zk0vOO8V31RuwuqW8_GBNATPweny30XsXsN0ytAFet_yYTNOdmZEA7g8n_8SdvdhNT02VLMdG63BSoDl5NMQ8iacTFs9gFBg2orFLTpcS5d8uS5bmZ6lrJf1_ydFBhP7JCI9SZvlGfHzY8_ywqcyV_5329HOQZ8ZNE0nQ0o8w71Hc53LpXV9FKZ76iGnESBblQryhYm4taD4ri5crFGU3QmVXeCH2BE7oQ0JoQB_JLtHQNkzR20qwYixsKkeA0TbAajnEXiVgGZ4C70A2tVr_k4-vPxKq3JFopYmza1D3NfJsVLKLhW8JbGoUoy-0BC7zuMk0QhvjqVqP6eUGleQgY5nekURG-3xYX0jAlqwI7EYDKyD4YnhLZq3iFWZkFOT_V8ucAWsSp2KQMby7-1H5M67HWukvduDxfXe9EqFNdZsCVSrB=w955-h386-no">
<meta property="og:updated_time" content="2019-10-30T10:07:42.308Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux 基礎篇 - 學習筆記">
<meta name="twitter:description" content="前言這是一份未整理過的 Linux 學習筆記OS 系統為 GCP 上的 Linux 18.04 LTS內容參考出處：   鳥哥的 Linux 的私房菜 Internet">
<meta name="twitter:image" content="https://i.imgur.com/KqrTrVt.png">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">


    <link href="/Linux/" rel="alternate" hreflang="en">








    <meta name="description" content="前言這是一份未整理過的 Linux 學習筆記OS 系統為 GCP 上的 Linux 18.04 LTS內容參考出處：   鳥哥的 Linux 的私房菜 Internet">
<meta name="keywords" content="Linux">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 基礎篇 - 學習筆記">
<meta property="og:url" content="https://tn710617.github.io/zh-tw/Linux/index.html">
<meta property="og:site_name" content="Ray&#39;s Coding Journey">
<meta property="og:description" content="前言這是一份未整理過的 Linux 學習筆記OS 系統為 GCP 上的 Linux 18.04 LTS內容參考出處：   鳥哥的 Linux 的私房菜 Internet">
<meta property="og:locale" content="zh-tw">
<meta property="og:image" content="https://i.imgur.com/KqrTrVt.png">
<meta property="og:image" content="https://lh3.googleusercontent.com/ujo1cwLgxb9GgqIIdqpGbiVwAHTCD9z48ZKfMkBQq7UXS7kCVJaLDDrLGXnWPu6DhZmVrED0m0tq8Hw_ICWU31KNHbKBmhDMa0Yj-CyKY0J2zp6uVfNuty7NfHKWDe8y902-8-8Xc7tMw-PX_2EF3DMafEh-dFJXKXk4eSmBTArex8YnpqPdyKPIm1zkCK9KJ_EsVWxsC_vWU4w4UF2_zre0luizW27nPvUPCZ9Z9_Zm_hwP7xAM7TwbSSzA3_FB9oAgDSq70GRtk17wRM6davPmRCSmyV_G0PKHFu0W8EuSXMOfh6Ia8GQMDDBGx7peuoDNKhmReyBq4bYrgjpq2AQZMPF8pySqiZS1UDMJEzx2vESxznp2HCyrbyJL21peGC2ZPkwNKWatU9Q9JZQ8LWtFi1cFkQZQn7rJFNQ_95vDDZlmUZ2SOuigVGVh_GDWgCi9RIgsTqWQUMt6SklYnQE_kuQ9OjZrM8nAjF2QAgSufOhH_aKBFN6Dthsv60RJbfbpkS79Cs0L1HhkYM6LlCcXd35oHcVvbuKXQi4_XXbTvG6iXOD5LHYe9OzWzIl7pjP3hWxvItzXfAR24ASFg1nncoiDQ2WORrH9j7OFNGkdjEnEeW6KXj36GnwjoEb7WN7Lft3kbp-zAo1hPch7tCYuMfH5G1g=w493-h202-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/kiQmhpIYtgM4l2t1KCPxJkhAwZsd4J31bfbeKi2ORAiZJiLWiTyyvqY-qLUawL2l2Fm-PuQzYR2cl9eA-I9s30KbnOlscqATGTlcYbifeM1GjUauPH9aCxOOhegj2GOfoBGFOPVp8g=w285-h212-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/ClZmDGa1AqGInMNdmvEpVcdcwXs2xTfeyoyQPDdpyETIleyfMiE9-kG7oa862PU_IfGE1r7_DgAFJcc4DcbK6woPujZKaL4w4mnt_QCgpWuKxfHF6vMWfELK0MBmWO_5dN5Ge23EErmHe_DXWgby7hIrCrdIDXbvsHDEMzhI41nLqYVU63U3ITzFwIhQci4yt4VFRt1DrDTXrhOoznXxZvLMaPRQ-vLwGR6e7AtFe1gbHVskfPUOwyeVbZM1FtAsVPLreLCSpHAJE8uvWE4gwyPf9C8KVtJd0JyO32OsCBVAyBkL74SRgMELsfHvWYlZVmQ2mVWPpT5M-PXrFruk_-saaWUVDBRTQc4EJi6R9fxqOux_8dRLRncp8GVEI1ehzr5b5bAdkO-G0XceyWKUlihkhHE9obt-55oRS_qJALzJBXY5WPdwg9giTAnSBMSREbYwmSdjc9saUcVDuFzqKTv8LHE-2Thu-O7rvNAdg230r8Wpgr2q0ZfAfHc_5FJ9gSxk0ou0PNeKz2Qhs5tH384TEJoY_ysAPGRNFb9iBIKONYsYQXV9qdMXL1dx6-IApbstuSuoBQ-6J-GxtrC1P7nBVOOnrYRhbzlDOihNKEND4rq32Qc5lHVSGFXECMn6ZoifyvbEIFUYcaaC3xsbHrmFUBHSstU=w288-h411-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/jrRJScb-pQMJCDVUtEsOT5wvTB-VDkwyo5O0Rxz7NGrty0dO2n-51ewRk0G36FreHEeNZ5yn9ZsPQaDbiOR5cEeIal3heroIdozwlzaSw6dKYTAiykMa7Vik7P2niLeo_2devH-z7HSqt7b62hdjMJVGMy-l6DFwag_J04pdByCBMRgvQFjFV0BJkk9-5CivP99nkq97HRJ71Q5OeQ2Gz7iJYt7iJRPUOre4ZBXsDqqgCLtz__7sLX-H1cAmmxiUR5CoD_ZGCplK1I_dmog9pkCjjJMiLHq6a--WZtntCE3BgPthkKMUjoAbNiUIXMZs4fMkBsreYprosZS-YZ3tlNU2ktJ0o0IErBEVrLlHSnnSej431wuUwgok3Mm7SIo5a0OeBU7IusUJW4nAdJ1miQxT0ChmV2G1yGYsuIUP1xt2phgwmM0AbbC7ufv4Ie6wYgjtF8tCx0foKbR_CDV9ieP1fdmtJTJrS1GsryeIJBd77m1gRAnttA2q5DbgMbMsBDVPr8oEKpWSBc246eOJ6-2IgRNf94YhGPU1TUE8CahfrE8rMpxU_mHXio9s7EyrPoWhByfNZYJtl-WmSSTj5_f1KwGhfiBBOztcmBQy0jy-I70qxdqGn4hFhHoh_wie-QZQrLxO4PGRO_PoP72aAQL_f_27M8_KDI8Zq9SEP99QbAaed32EIzo=w976-h138-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/d6tEtO4_J_LcDP0YYQA1lwdmswV8N9YGLnXNVe5tx0oqVdyP_1OAW_R0DSmxNbVnpUvzVV4OWp3oYsL0CYCMgqf0DgSw1qZ-_mbvzlNdCMukoAiiSeppxH43gUBI9Am_ghjIVrljdOthya0XRQmDx1kqBL5m6EzWjiansImEfV6G37OfJxlyyi7q4bfKDjA0jFbFMHXAYJcc7X3t1_P2lKat8KwhO903Bv0WFyKMFRVMbtIg2zUmOHeSIG1NGdqjFbAhCPDViiGO5DJpaj8KgHAMLHlD4d3EUTC8NqdqhhfTRwUKi3jTcrvj4ymhbMchvXU3x-X56EN1qwcGvY_Z9AFXnK_1dnUOmD9sCy5o9xnc5Kez6MuvkspjKKttxw-a_xW0vkXP49biRDKUtpWXaM9kV8256925pqdc_bliYa3XDHVfTJz7O_fOjtzqlDUu_igu0Pxw3oV7V6aKtuOzN0inl4e5M5dhkCIVNcFKfw-1TyevCQNy7Zjm7gFdbZIj6f7Tu1FIoGvYfTL7b8sx7jSCHtjQ9CxZ3dAIn47rVjzqwg8ZzcNnzMzhS4GhKiFnH7z2zcaq-8w2A1SxALM2M9cvBmLCmoH-4sGbr-0VLEhu8wAObMFF9pSuwHHIEBCL6fPkaSDvV2-X4heMzET9mhEZxMYaSN0H_f6szQs_sSIbrU_ZKGLgKyY=w954-h304-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/pzdhfNflqtMI6cZjYXZVg9tJHaT5pJ-BxwH4MVG-niRbTDO4ex_SMTtevellUzgvtlI0UF1DlITGSe0cRjhsHF17f6HbMoVgrP665q0eJJ6mluUn9kmPhGjKG6t1QEQ6Mb8rB3oqLry8_-J06MMkEy2t_YJ6Kze2QVN_p7e72DRdHoNCmSCDUBGvHHRfJrystXFHqHq3kmN4zjTjaXIuXuapEgpLmxriroXgJP90pX5JUNylr60H20WEdT6WHHK9P2m7cDFVXUAvlIHv3P5l-AnxfmpWnnzxQDjYM_EzevIcs5-_xWMQ-E37PmFY2cISVZqJCy2-2sDhpi1aDVrFRK-yILq_yShfWcCiy-A2Lt2aIokyTbr05ISh6FlMAMmdXE5DU7mWYWfzNg7NruNJIwaD2BJiIQrXNvZB_W6ObUJeQqGXu8JI-oYLEm_SsLOuo-VBTY-ifmMZpJoaOMmaybwtRO-ZRWqhiOyT26Xse1a6rUkgCbmwRNFzjawQI9UF8dNRtJfQylNiUxFq8MD3XyNQH1kfPWDzSX_Uk2nDVB7MaRn5fX8btMxKM2a4DopA81ZYRXsc5WDcZe2cvFZlUJ5bRVEGETcznIESVnmA0GjhLBWBVeCc2no57UpB1bSmOUURZbkgcy3PQ-kyMEhY1ldFg2Kbp5GMPEoF5gJV60cOHg9NU9UwBS1sTuevj-HtH7WPa_hZ985HS3fZYc-xqFD7WPAxn0CfQYrOzxTqzw9-pyI2=w912-h234-no">
<meta property="og:image" content="https://lh3.googleusercontent.com/chhghZWzziGWqyIby201KuMqTvUYYYxhRHDtBxgHrR6GRDRwbt3OLGqK8KjxgfBDhpcBvDjAsRknThJ1Hbvtf571SsMs4zCZEnjNkO72bQ4VFqlG2NjN5Tqj16eTZyUl51rTIR1qxPccQCYLJgDLMc5MWrSZBxbnoOyxvVLugwYiTmodZCXnWfADCtKwWOS1cgWkFNzjOKfsNlGTPtzgEOXleGVV-kEArO7UfgrAe0GwGnu89adWeC1Ik2VYz0qLgJJlSrtiiXCQo6DwSwoBqwyikRph_aZrCdAGf3c0hmGQLzpYs3juia0wZjTsf41zk0vOO8V31RuwuqW8_GBNATPweny30XsXsN0ytAFet_yYTNOdmZEA7g8n_8SdvdhNT02VLMdG63BSoDl5NMQ8iacTFs9gFBg2orFLTpcS5d8uS5bmZ6lrJf1_ydFBhP7JCI9SZvlGfHzY8_ywqcyV_5329HOQZ8ZNE0nQ0o8w71Hc53LpXV9FKZ76iGnESBblQryhYm4taD4ri5crFGU3QmVXeCH2BE7oQ0JoQB_JLtHQNkzR20qwYixsKkeA0TbAajnEXiVgGZ4C70A2tVr_k4-vPxKq3JFopYmza1D3NfJsVLKLhW8JbGoUoy-0BC7zuMk0QhvjqVqP6eUGleQgY5nekURG-3xYX0jAlqwI7EYDKyD4YnhLZq3iFWZkFOT_V8ucAWsSp2KQMby7-1H5M67HWukvduDxfXe9EqFNdZsCVSrB=w955-h386-no">
<meta property="og:updated_time" content="2019-10-30T10:07:42.308Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux 基礎篇 - 學習筆記">
<meta name="twitter:description" content="前言這是一份未整理過的 Linux 學習筆記OS 系統為 GCP 上的 Linux 18.04 LTS內容參考出處：   鳥哥的 Linux 的私房菜 Internet">
<meta name="twitter:image" content="https://i.imgur.com/KqrTrVt.png">





    <link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/sunburst.min.css">

<link rel="stylesheet" href="/css/style.css">

<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
        
    
        
    
        
    
        
    
        
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-135063928-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-135063928-1');
</script>


    


</head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/zh-tw">
                
                    
                    Ray 的技術捲軸
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item " href="/zh-tw/archives">歸檔</a>
            
            <a class="navbar-item " href="/zh-tw/categories">分類</a>
            
            <a class="navbar-item " href="/zh-tw/tags">標籤</a>
            
            <a class="navbar-item " href="/zh-tw/schedule">行程</a>
            
            <a class="navbar-item " href="/zh-tw/about">關於</a>
            
            <a class="navbar-item " href="/zh-tw/friends">好友</a>
            
            <a class="navbar-item " href="/zh-tw/japanese">日語</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="搜尋" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            <div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only toc">
                <a class="navbar-item" title="目錄">
                    <i class="fa fa-list"></i>
                </a>
                <div class="navbar-dropdown is-right">
                    
                    
                    
                    
                    <a class="navbar-item" href="#前言">1.1&nbsp;&nbsp;前言</a>
                    
                    
                    
                    <a class="navbar-item" href="#find">1.2&nbsp;&nbsp;find</a>
                    
                    
                    
                    <a class="navbar-item" href="#搜尋屬於特定-user-或-group-的檔案">1.2.1&nbsp;&nbsp;搜尋屬於特定 user 或 group 的檔案</a>
                    
                    
                    
                    <a class="navbar-item" href="#搜尋屬於特定-user-或-group-的資料夾">1.2.2&nbsp;&nbsp;搜尋屬於特定 user 或 group 的資料夾</a>
                    
                    
                    
                    <a class="navbar-item" href="#搜尋-分鐘內的檔案或資料夾-只搜尋當層">1.2.3&nbsp;&nbsp;搜尋 $分鐘內的檔案或資料夾, 只搜尋當層</a>
                    
                    
                    
                    <a class="navbar-item" href="#ps">1.3&nbsp;&nbsp;ps</a>
                    
                    
                    
                    <a class="navbar-item" href="#kill">1.4&nbsp;&nbsp;kill</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法">1.4.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#指令">1.4.2&nbsp;&nbsp;指令</a>
                    
                    
                    
                    <a class="navbar-item" href="#killall">1.5&nbsp;&nbsp;killall</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-1">1.5.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#ln">1.6&nbsp;&nbsp;ln</a>
                    
                    
                    
                    <a class="navbar-item" href="#du">1.7&nbsp;&nbsp;du</a>
                    
                    
                    
                    <a class="navbar-item" href="#df">1.8&nbsp;&nbsp;df</a>
                    
                    
                    
                    <a class="navbar-item" href="#">1.9&nbsp;&nbsp;[[]]</a>
                    
                    
                    
                    <a class="navbar-item" href="#grep">1.10&nbsp;&nbsp;grep</a>
                    
                    
                    
                    <a class="navbar-item" href="#groupdel">1.11&nbsp;&nbsp;groupdel</a>
                    
                    
                    
                    <a class="navbar-item" href="#userdel">1.12&nbsp;&nbsp;userdel</a>
                    
                    
                    
                    <a class="navbar-item" href="#useradd">1.13&nbsp;&nbsp;useradd</a>
                    
                    
                    
                    <a class="navbar-item" href="#useradd-之後，系統會幫我們做哪些事？">1.13.1&nbsp;&nbsp;useradd 之後，系統會幫我們做哪些事？</a>
                    
                    
                    
                    <a class="navbar-item" href="#useradd-參考檔">1.13.2&nbsp;&nbsp;useradd 參考檔</a>
                    
                    
                    
                    <a class="navbar-item" href="#UID-GID-還有密碼參數">1.14&nbsp;&nbsp;UID/GID 還有密碼參數</a>
                    
                    
                    
                    <a class="navbar-item" href="#usermod">1.15&nbsp;&nbsp;usermod</a>
                    
                    
                    
                    <a class="navbar-item" href="#chmod">1.16&nbsp;&nbsp;chmod</a>
                    
                    
                    
                    <a class="navbar-item" href="#passwd">1.17&nbsp;&nbsp;passwd</a>
                    
                    
                    
                    <a class="navbar-item" href="#確認-OS-種類以及版本">1.18&nbsp;&nbsp;確認 OS 種類以及版本</a>
                    
                    
                    
                    <a class="navbar-item" href="#curl">1.19&nbsp;&nbsp;curl</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-2">1.19.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例">1.19.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#bash-環境配置文件">1.20&nbsp;&nbsp;bash 環境配置文件</a>
                    
                    
                    
                    <a class="navbar-item" href="#bash-會根據有沒有登入來讀取相對應的環境配置文件">1.20.1&nbsp;&nbsp;bash 會根據有沒有登入來讀取相對應的環境配置文件</a>
                    
                    
                    
                    <a class="navbar-item" href="#流程圖">1.20.2&nbsp;&nbsp;流程圖</a>
                    
                    
                    
                    <a class="navbar-item" href="#不小心刪除了-bashrc-或是沒有這個文件，想創建怎麼辦？">1.20.3&nbsp;&nbsp;不小心刪除了 ~/.bashrc, 或是沒有這個文件，想創建怎麼辦？</a>
                    
                    
                    
                    <a class="navbar-item" href="#Base-64-decode">1.21&nbsp;&nbsp;Base 64 decode</a>
                    
                    
                    
                    <a class="navbar-item" href="#ncftp">1.22&nbsp;&nbsp;ncftp</a>
                    
                    
                    
                    <a class="navbar-item" href="#ufw">1.23&nbsp;&nbsp;ufw</a>
                    
                    
                    
                    <a class="navbar-item" href="#install">1.24&nbsp;&nbsp;install</a>
                    
                    
                    
                    <a class="navbar-item" href="#yum">1.25&nbsp;&nbsp;yum</a>
                    
                    
                    
                    <a class="navbar-item" href="#whatprovides">1.25.1&nbsp;&nbsp;whatprovides</a>
                    
                    
                    
                    <a class="navbar-item" href="#install-1">1.25.2&nbsp;&nbsp;install</a>
                    
                    
                    
                    <a class="navbar-item" href="#regular-expression-regex-正則表達式">1.26&nbsp;&nbsp;regular expression (regex) (正則表達式)</a>
                    
                    
                    
                    <a class="navbar-item" href="#特殊符號表">1.26.1&nbsp;&nbsp;特殊符號表</a>
                    
                    
                    
                    <a class="navbar-item" href="#表達式彙整">1.26.2&nbsp;&nbsp;表達式彙整</a>
                    
                    
                    
                    <a class="navbar-item" href="#基礎正規表達式字符彙整">1.26.3&nbsp;&nbsp;基礎正規表達式字符彙整</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-1">1.26.4&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#crontab">1.27&nbsp;&nbsp;crontab</a>
                    
                    
                    
                    <a class="navbar-item" href="#安裝">1.27.1&nbsp;&nbsp;安裝</a>
                    
                    
                    
                    <a class="navbar-item" href="#代表意義">1.27.2&nbsp;&nbsp;代表意義</a>
                    
                    
                    
                    <a class="navbar-item" href="#etc-crontab">1.27.3&nbsp;&nbsp;/etc/crontab</a>
                    
                    
                    
                    <a class="navbar-item" href="#crond-服務讀取配置文件">1.27.4&nbsp;&nbsp;crond 服務讀取配置文件</a>
                    
                    
                    
                    <a class="navbar-item" href="#其他">1.27.5&nbsp;&nbsp;其他</a>
                    
                    
                    
                    <a class="navbar-item" href="#anacron">1.27.6&nbsp;&nbsp;anacron</a>
                    
                    
                    
                    <a class="navbar-item" href="#cron-與-anacron-與目錄之間的關係">1.27.7&nbsp;&nbsp;cron 與 anacron 與目錄之間的關係</a>
                    
                    
                    
                    <a class="navbar-item" href="#test">1.28&nbsp;&nbsp;test</a>
                    
                    
                    
                    <a class="navbar-item" href="#變量">1.29&nbsp;&nbsp;變量</a>
                    
                    
                    
                    <a class="navbar-item" href="#變量的設置">1.29.1&nbsp;&nbsp;變量的設置</a>
                    
                    
                    
                    <a class="navbar-item" href="#Script-變量帶入規則：">1.29.2&nbsp;&nbsp;Script 變量帶入規則：</a>
                    
                    
                    
                    <a class="navbar-item" href="#可以在-script-裡面使用的特殊變量">1.29.3&nbsp;&nbsp;可以在 script 裡面使用的特殊變量</a>
                    
                    
                    
                    <a class="navbar-item" href="#條件判斷">1.30&nbsp;&nbsp;條件判斷</a>
                    
                    
                    
                    <a class="navbar-item" href="#單一判斷式">1.30.1&nbsp;&nbsp;單一判斷式</a>
                    
                    
                    
                    <a class="navbar-item" href="#多重、複雜條件判斷式">1.30.2&nbsp;&nbsp;多重、複雜條件判斷式</a>
                    
                    
                    
                    <a class="navbar-item" href="#利用-case-…-esac-判斷">1.30.3&nbsp;&nbsp;利用 case ….. esac 判斷</a>
                    
                    
                    
                    <a class="navbar-item" href="#練習題">1.30.4&nbsp;&nbsp;練習題</a>
                    
                    
                    
                    <a class="navbar-item" href="#netstat">1.31&nbsp;&nbsp;netstat</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-4">1.31.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#function">1.32&nbsp;&nbsp;function</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法：">1.32.1&nbsp;&nbsp;語法：</a>
                    
                    
                    
                    <a class="navbar-item" href="#注意：">1.32.2&nbsp;&nbsp;注意：</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例：">1.32.3&nbsp;&nbsp;範例：</a>
                    
                    
                    
                    <a class="navbar-item" href="#loop">1.33&nbsp;&nbsp;loop</a>
                    
                    
                    
                    <a class="navbar-item" href="#while-do-done-until-do-done-不定循環">1.33.1&nbsp;&nbsp;while do done, until do done (不定循環)</a>
                    
                    
                    
                    <a class="navbar-item" href="#for…do…done-固定循環">1.33.2&nbsp;&nbsp;for…do…done (固定循環)</a>
                    
                    
                    
                    <a class="navbar-item" href="#for…do…done-的數值處理">1.33.3&nbsp;&nbsp;for…do…done 的數值處理</a>
                    
                    
                    
                    <a class="navbar-item" href="#搭配亂數與陣列的實驗">1.33.4&nbsp;&nbsp;搭配亂數與陣列的實驗</a>
                    
                    
                    
                    <a class="navbar-item" href="#loop-array">1.33.5&nbsp;&nbsp;loop array</a>
                    
                    
                    
                    <a class="navbar-item" href="#shell-script-的追蹤與-debug">1.34&nbsp;&nbsp;shell script 的追蹤與 debug</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-9">1.34.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-6">1.34.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#練習題-1">1.35&nbsp;&nbsp;練習題</a>
                    
                    
                    
                    <a class="navbar-item" href="#etc-passwd-文件架構">1.36&nbsp;&nbsp;/etc/passwd 文件架構</a>
                    
                    
                    
                    <a class="navbar-item" href="#etc-shadow-文件結構">1.37&nbsp;&nbsp;/etc/shadow 文件結構</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-7">1.37.1&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#獲取-shadow-的加密機制">1.37.2&nbsp;&nbsp;獲取 shadow 的加密機制</a>
                    
                    
                    
                    <a class="navbar-item" href="#關於群組：-有效與初始群組、groups-newgrp">1.38&nbsp;&nbsp;關於群組： 有效與初始群組、groups, newgrp</a>
                    
                    
                    
                    <a class="navbar-item" href="#etc-group-文件結構">1.38.1&nbsp;&nbsp;/etc/group 文件結構</a>
                    
                    
                    
                    <a class="navbar-item" href="#etc-gshadow-文件結構">1.38.2&nbsp;&nbsp;/etc/gshadow 文件結構</a>
                    
                    
                    
                    <a class="navbar-item" href="#etc-passwd-與-etc-group-與-etc-shadow-示意圖">1.39&nbsp;&nbsp;/etc/passwd 與 /etc/group 與 /etc/shadow 示意圖</a>
                    
                    
                    
                    <a class="navbar-item" href="#finger">1.40&nbsp;&nbsp;finger</a>
                    
                    
                    
                    <a class="navbar-item" href="#chfn">1.41&nbsp;&nbsp;chfn</a>
                    
                    
                    
                    <a class="navbar-item" href="#chage">1.42&nbsp;&nbsp;chage</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-10">1.42.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-8">1.42.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#chsh">1.43&nbsp;&nbsp;chsh</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法：-1">1.43.1&nbsp;&nbsp;語法：</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-9">1.43.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#groupadd">1.44&nbsp;&nbsp;groupadd</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-11">1.44.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-10">1.44.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#groupmod">1.45&nbsp;&nbsp;groupmod</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-12">1.45.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-11">1.45.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#groupdel-1">1.46&nbsp;&nbsp;groupdel</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-13">1.46.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#gpasswd">1.47&nbsp;&nbsp;gpasswd</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-14">1.47.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-12">1.47.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#ACL">1.48&nbsp;&nbsp;ACL</a>
                    
                    
                    
                    <a class="navbar-item" href="#setfacl">1.48.1&nbsp;&nbsp;setfacl</a>
                    
                    
                    
                    <a class="navbar-item" href="#getfacl">1.48.2&nbsp;&nbsp;getfacl</a>
                    
                    
                    
                    <a class="navbar-item" href="#su">1.49&nbsp;&nbsp;su</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-17">1.49.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#sudo">1.50&nbsp;&nbsp;sudo</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-18">1.50.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#sudoers">1.51&nbsp;&nbsp;sudoers</a>
                    
                    
                    
                    <a class="navbar-item" href="#更改設置">1.51.1&nbsp;&nbsp;更改設置</a>
                    
                    
                    
                    <a class="navbar-item" href="#visudo">1.52&nbsp;&nbsp;visudo</a>
                    
                    
                    
                    <a class="navbar-item" href="#PAM-模塊設置語法">1.53&nbsp;&nbsp;PAM 模塊設置語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#程序與-PAM-的關係圖">1.53.1&nbsp;&nbsp;程序與 PAM 的關係圖</a>
                    
                    
                    
                    <a class="navbar-item" href="#程序調用-PAM-的流程">1.53.2&nbsp;&nbsp;程序調用 PAM 的流程</a>
                    
                    
                    
                    <a class="navbar-item" href="#配置文件內容">1.53.3&nbsp;&nbsp;配置文件內容</a>
                    
                    
                    
                    <a class="navbar-item" href="#jobs">1.54&nbsp;&nbsp;jobs</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-19">1.54.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#fg">1.55&nbsp;&nbsp;fg</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-20">1.55.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#ps-1">1.56&nbsp;&nbsp;ps</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-21">1.56.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#觀察自己的-bash-相關程序">1.56.2&nbsp;&nbsp;觀察自己的 bash 相關程序</a>
                    
                    
                    
                    <a class="navbar-item" href="#觀察系統所有程序">1.56.3&nbsp;&nbsp;觀察系統所有程序</a>
                    
                    
                    
                    <a class="navbar-item" href="#top">1.57&nbsp;&nbsp;top</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-22">1.57.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#pstree">1.58&nbsp;&nbsp;pstree</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-23">1.58.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#nice">1.59&nbsp;&nbsp;nice</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-24">1.59.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#renice">1.60&nbsp;&nbsp;renice</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-25">1.60.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#free">1.61&nbsp;&nbsp;free</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-26">1.61.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#備註">1.61.2&nbsp;&nbsp;備註</a>
                    
                    
                    
                    <a class="navbar-item" href="#uname">1.62&nbsp;&nbsp;uname</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-27">1.62.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#uptime">1.63&nbsp;&nbsp;uptime</a>
                    
                    
                    
                    <a class="navbar-item" href="#netstat-1">1.64&nbsp;&nbsp;netstat</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-28">1.64.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#備註-1">1.64.2&nbsp;&nbsp;備註</a>
                    
                    
                    
                    <a class="navbar-item" href="#dmesg">1.65&nbsp;&nbsp;dmesg</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-13">1.65.1&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#vmstat">1.66&nbsp;&nbsp;vmstat</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-29">1.66.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-14">1.66.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#proc">1.67&nbsp;&nbsp;/proc</a>
                    
                    
                    
                    <a class="navbar-item" href="#文件內容">1.67.1&nbsp;&nbsp;文件內容</a>
                    
                    
                    
                    <a class="navbar-item" href="#fuser">1.68&nbsp;&nbsp;fuser</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-30">1.68.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-15">1.68.2&nbsp;&nbsp;範例</a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#數據量還不會很多，雖然這個目錄很繁忙～沒關係！我們可以繼續這樣作，看看其他的程序！">2&nbsp;&nbsp;<b>數據量還不會很多，雖然這個目錄很繁忙～沒關係！我們可以繼續這樣作，看看其他的程序！</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#有這幾支程序在進行-proc-文件系統的存取喔！這樣清楚了嗎？">3&nbsp;&nbsp;<b>有這幾支程序在進行 /proc 文件系統的存取喔！這樣清楚了嗎？</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#從-fuser-的結果可以知道，總共有五隻-process-在該目錄下運行，那即使-root-離開了-home，">4&nbsp;&nbsp;<b>從 fuser 的結果可以知道，總共有五隻 process 在該目錄下運行，那即使 root 離開了 /home，</b></a>
                    
                    
                    <hr class="navbar-divider">
                    
                    
                    <a class="navbar-item" href="#當然還是無法-umount-的！那要怎辦？哈哈！可以通過如下方法一個一個刪除～">5&nbsp;&nbsp;<b>當然還是無法 umount 的！那要怎辦？哈哈！可以通過如下方法一個一個刪除～</b></a>
                    
                    
                    
                    <a class="navbar-item" href="#process-substitution-lt-command-or-gt-command">5.1&nbsp;&nbsp;process substitution &amp;amp;lt;( command ) or &amp;amp;gt;( command )</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-31">5.1.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#logrotate">5.2&nbsp;&nbsp;logrotate</a>
                    
                    
                    
                    <a class="navbar-item" href="#logrotate-這個程序的參數配置文件位置">5.2.1&nbsp;&nbsp;logrotate 這個程序的參數配置文件位置</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-32">5.2.2&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-18">5.2.3&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#command-true-patten">5.3&nbsp;&nbsp;command || true patten</a>
                    
                    
                    
                    <a class="navbar-item" href="#timedatectl">5.4&nbsp;&nbsp;timedatectl</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-33">5.4.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-19">5.4.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#ntpdate">5.5&nbsp;&nbsp;ntpdate</a>
                    
                    
                    
                    <a class="navbar-item" href="#localectl">5.6&nbsp;&nbsp;localectl</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-34">5.6.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-20">5.6.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#dpkg">5.7&nbsp;&nbsp;dpkg</a>
                    
                    
                    
                    <a class="navbar-item" href="#列出所有-dpkg-安裝的套件">5.7.1&nbsp;&nbsp;列出所有 dpkg 安裝的套件</a>
                    
                    
                    
                    <a class="navbar-item" href="#tee">5.8&nbsp;&nbsp;tee</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-35">5.8.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#sed">5.9&nbsp;&nbsp;sed</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-36">5.9.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-21">5.9.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#替換變量的值">5.10&nbsp;&nbsp;替換變量的值</a>
                    
                    
                    
                    <a class="navbar-item" href="#route">5.11&nbsp;&nbsp;route</a>
                    
                    
                    
                    <a class="navbar-item" href="#jq">5.12&nbsp;&nbsp;jq</a>
                    
                    
                    
                    <a class="navbar-item" href="#arp">5.13&nbsp;&nbsp;arp</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-37">5.13.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-22">5.13.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#SBIT">5.14&nbsp;&nbsp;SBIT</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-38">5.14.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#ifconfig">5.15&nbsp;&nbsp;ifconfig</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-39">5.15.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-23">5.15.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#apt">5.16&nbsp;&nbsp;apt</a>
                    
                    
                    
                    <a class="navbar-item" href="#route-1">5.17&nbsp;&nbsp;route</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-40">5.17.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#範例-24">5.17.2&nbsp;&nbsp;範例</a>
                    
                    
                    
                    <a class="navbar-item" href="#輸出資訊意義">5.17.3&nbsp;&nbsp;輸出資訊意義</a>
                    
                    
                    
                    <a class="navbar-item" href="#ip">5.18&nbsp;&nbsp;ip</a>
                    
                    
                    
                    <a class="navbar-item" href="#語法-41">5.18.1&nbsp;&nbsp;語法</a>
                    
                    
                    
                    <a class="navbar-item" href="#Q-amp-A">5.19&nbsp;&nbsp;Q&amp;amp;amp;A</a>
                    
                </div>
            </div>
            

            
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true" aria-controls="dropdown-menu7">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>繁體中文</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu" style="top:100%">
            <div class="dropdown-content">
            
                <a href="/Linux/" class="dropdown-item">
                    English
                </a>
            
                <a href="/zh-tw/Linux/" class="dropdown-item">
                    繁體中文
                </a>
            
            </div>
        </div>
    </div>
</div>

        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            Linux 基礎篇 - 學習筆記
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            <time datetime="2019-09-30T07:30:27.000Z" itemprop="datePublished">9月 30 2019</time>
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/zh-tw/categories/部署/">部署</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            4 小时 讀完 (大概 38523 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>這是一份未整理過的 Linux 學習筆記<br>OS 系統為 GCP 上的 Linux 18.04 LTS<br>內容參考出處： </p>
<ol>
<li>鳥哥的 Linux 的私房菜</li>
<li>Internet</li>
</ol>
<a id="more"></a>
<p><br><br><br><br><br></p>
<h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><h3 id="搜尋屬於特定-user-或-group-的檔案"><a href="#搜尋屬於特定-user-或-group-的檔案" class="headerlink" title="搜尋屬於特定 user 或 group 的檔案"></a>搜尋屬於特定 user 或 group 的檔案</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">find localtion -type f -user userName -group groupName -name fileName</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="搜尋屬於特定-user-或-group-的資料夾"><a href="#搜尋屬於特定-user-或-group-的資料夾" class="headerlink" title="搜尋屬於特定 user 或 group 的資料夾"></a>搜尋屬於特定 user 或 group 的資料夾</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">find localtion -type d -user userName -group groupName -name fileName</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="搜尋-分鐘內的檔案或資料夾-只搜尋當層"><a href="#搜尋-分鐘內的檔案或資料夾-只搜尋當層" class="headerlink" title="搜尋 $分鐘內的檔案或資料夾, 只搜尋當層"></a>搜尋 $分鐘內的檔案或資料夾, 只搜尋當層</h3><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">find ./* -maxdepth 0 -<span class="hljs-built_in">type</span> f -cmin -20</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h2><ul>
<li>列出系統正在執行的 process, 並且從中搜尋關鍵字<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">ps -ef | node</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h2><h3 id="語法"><a href="#語法" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# kill -signal %jobnumber</span><br><span class="line">[root@study ~]# kill -l</span><br><span class="line">選項與參數：</span><br><span class="line">-l  ：這個是 L 的小寫，列出目前 kill 能夠使用的訊號 (signal) 有哪些？</span><br><span class="line">signal ：代表給予後面接的那個工作什麼樣的指示囉！用 man 7 signal 可知：</span><br><span class="line">  -1 ：重新讀取一次參數的配置文件 (類似 reload)；</span><br><span class="line">  -2 ：代表與由鍵盤輸入 [ctrl]-c 同樣的動作；</span><br><span class="line">  -9 ：立刻強制刪除一個工作；</span><br><span class="line">  -15：以正常的程序方式終止一項工作。與 -9 是不一樣的。</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>代號</th>
<th>名稱</th>
<th>內容</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>SIGHUP</td>
<td>啟動被終止的程序，可讓該 PID 重新讀取自己的配置文件，類似重新啟動</td>
</tr>
<tr>
<td>2</td>
<td>SIGINT</td>
<td>相當於用鍵盤輸入 [ctrl]-c 來中斷一個程序的進行</td>
</tr>
<tr>
<td>9</td>
<td>SIGKILL</td>
<td>代表強制中斷一個程序的進行，如果該程序進行到一半， 那麼尚未完成的部分可能會有“半產品”產生，類似 vim會有 .filename.swp 保留下來。</td>
</tr>
<tr>
<td>15</td>
<td>SIGTERM</td>
<td>以正常的結束程序來終止該程序。由於是正常的終止， 所以後續的動作會將他完成。不過，如果該程序已經發生問題，就是無法使用正常的方法終止時， 輸入這個 signal 也是沒有用的。</td>
</tr>
<tr>
<td>19</td>
<td>SIGSTOP</td>
<td>相當於用鍵盤輸入 [ctrl]-z 來暫停一個程序的進行</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h3><ul>
<li>立刻強制刪除一個工作<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">kill -9 processID</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="killall"><a href="#killall" class="headerlink" title="killall"></a>killall</h2><h3 id="語法-1"><a href="#語法-1" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# killall [-iIe] [command name]</span><br><span class="line">選項與參數：</span><br><span class="line">-i  ：interactive 的意思，互動式的，若需要刪除時，會出現提示字符給使用者；</span><br><span class="line">-e  ：exact 的意思，表示“後面接的 command name 要一致”，但整個完整的指令</span><br><span class="line">      不能超過 15 個字符。</span><br><span class="line">-I  ：指令名稱(可能含參數)忽略大小寫。</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="ln"><a href="#ln" class="headerlink" title="ln"></a>ln</h2><ul>
<li>建立一個捷徑<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">ln -s sourceAbsoluteLink targetAbsoluteLink</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="du"><a href="#du" class="headerlink" title="du"></a>du</h2><ul>
<li>查檔案大小<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">du -sh fileOrFolder</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="df"><a href="#df" class="headerlink" title="df"></a>df</h2><ul>
<li>查硬碟空間使用率<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">df -h</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id><a href="#" class="headerlink" title="[[]]"></a>[[]]</h2><ul>
<li>回傳 true or false<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[[ -f /.dockerenv ]]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><code>[[]]</code> 會將裡頭的參數結果回傳 true or false<br><code>-f</code> 表示 <code>file exists</code><br>所以意思是，如果 /.dockerenv 存在，則回傳 true</p>
<p><br><br><br><br><br></p>
<h2 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h2><ul>
<li>搜尋內容並顯示附近的行數<br>從 <code>gcloud</code> command 中取得資料，並且顯示 <code>ssh-keys</code> 後面的 5 行<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">gcloud compute project-info describe | grep -A 5 ssh-keys</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="groupdel"><a href="#groupdel" class="headerlink" title="groupdel"></a>groupdel</h2><ul>
<li>刪除 group<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">groupdel groupName</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="userdel"><a href="#userdel" class="headerlink" title="userdel"></a>userdel</h2><ul>
<li>刪除 user<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">userdel userName</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="useradd"><a href="#useradd" class="headerlink" title="useradd"></a>useradd</h2><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">useradd [-u UID] [-g 初始群組] [-G 次要群組] [-mM]\</span><br><span class="line">&gt;  [-c 說明欄] [-d 主文件夾絕對路徑] [-s shell] 使用者帳號名</span><br><span class="line">選項與參數：</span><br><span class="line">-u  ：後面接的是 UID ，是一組數字。直接指定一個特定的 UID 給這個帳號；</span><br><span class="line">-g  ：後面接的那個群組名稱就是我們上面提到的 initial group 啦～</span><br><span class="line">      該群組的 GID 會被放置到 /etc/passwd 的第四個字段內。</span><br><span class="line">-G  ：後面接的群組名稱則是這個帳號還可以加入的群組。</span><br><span class="line">      這個選項與參數會修改 /etc/group 內的相關數據喔！</span><br><span class="line">-M  ：強制！不要創建使用者主文件夾！(系統帳號默認值)</span><br><span class="line">-m  ：強制！要創建使用者主文件夾！(一般帳號默認值)</span><br><span class="line">-c  ：這個就是 /etc/passwd 的第五欄的說明內容啦～可以隨便我們設置的啦～</span><br><span class="line">-d  ：指定某個目錄成為主文件夾，而不要使用默認值。務必使用絕對路徑！</span><br><span class="line">-r  ：創建一個系統的帳號，這個帳號的 UID 會有限制 (參考 /etc/login.defs)</span><br><span class="line">-s  ：後面接一個 shell ，若沒有指定則默認是 /bin/bash 的啦～</span><br><span class="line">-e  ：後面接一個日期，格式為“YYYY-MM-DD”此項目可寫入 shadow 第八字段，</span><br><span class="line">      亦即帳號失效日的設置項目囉；</span><br><span class="line">-f  ：後面接 shadow 的第七字段項目，指定密碼是否會失效。0為立刻失效，</span><br><span class="line">      -1 為永遠不失效(密碼只會過期而強制於登陸時重新設置而已。)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>完全參考默認值創建一個使用者，名稱為 Ray</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">useradd Ray</span><br></pre></td></tr></table></figure>
</li>
<li><p>建立一個 user, 並加到指定 group</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">useradd -G groupName userName</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h3 id="useradd-之後，系統會幫我們做哪些事？"><a href="#useradd-之後，系統會幫我們做哪些事？" class="headerlink" title="useradd 之後，系統會幫我們做哪些事？"></a>useradd 之後，系統會幫我們做哪些事？</h3><ol>
<li>在 /etc/passwd 裡面創建一行與帳號相關的數據，包括創建 UID/GID/主文件夾等；</li>
<li>在 /etc/shadow 裡面將此帳號的密碼相關參數填入，但是尚未有密碼；</li>
<li>在 /etc/group 裡面加入一個與帳號名稱一模一樣的群組名稱；</li>
<li>在 /home 下面創建一個與帳號同名的目錄作為使用者主文件夾，且權限為 700</li>
</ol>
<p><br></p>
<h3 id="useradd-參考檔"><a href="#useradd-參考檔" class="headerlink" title="useradd 參考檔"></a>useradd 參考檔</h3><ul>
<li>這個數據其實是由 /etc/default/useradd 調用出來的</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">useradd -D</span><br><span class="line">GROUP=100		&lt;==默認的群組</span><br><span class="line">HOME=/home		&lt;==默認的主文件夾所在目錄</span><br><span class="line">INACTIVE=-1		&lt;==密碼失效日，在 shadow 內的第 7 欄</span><br><span class="line">EXPIRE=			&lt;==帳號失效日，在 shadow 內的第 8 欄</span><br><span class="line">SHELL=/bin/bash		&lt;==默認的 shell</span><br><span class="line">SKEL=/etc/skel		&lt;==使用者主文件夾的內容數據參考目錄</span><br><span class="line">CREATE_MAIL_SPOOL=yes   &lt;==是否主動幫使用者創建郵件信箱(mailbox)</span><br></pre></td></tr></table></figure>
<ul>
<li>GROUP=100：新建帳號的初始群組使用 GID 為 100 者<br>系統上面 GID 為 100 者即是 users 這個群組，此設置項目指的就是讓新設使用者帳號的初始群組為 users 這一個的意思。 但是我們知道 CentOS 上面並不是這樣的，在 CentOS 上面默認的群組為與帳號名相同的群組。 舉例來說， vbird1 的初始群組為 vbird1 。怎麼會這樣啊？這是因為針對群組的角度有兩種不同的機制所致， 這兩種機制分別是：<ul>
<li>私有群組機制：<br>系統會創建一個與帳號一樣的群組給使用者作為初始群組。 這種群組的設置機制會比較有保密性，這是因為使用者都有自己的群組，而且主文件夾權限將會設置為 700 (僅有自己可進入自己的主文件夾) 之故。使用這種機制將不會參考 GROUP=100 這個設置值。代表性的 distributions 有 RHEL, Fedora, CentOS 等；</li>
<li>公共群組機制：<br>就是以 GROUP=100 這個設置值作為新建帳號的初始群組，因此每個帳號都屬於 users 這個群組， 且默認主文件夾通常的權限會是“ drwxr-xr-x … username users … ”，由於每個帳號都屬於 users 群組，因此大家都可以互相分享主文件夾內的數據之故。代表 distributions 如 SuSE等。<br>由於我們的 CentOS 使用私有群組機制，因此這個設置項目是不會生效的！不要太緊張啊！</li>
</ul>
</li>
<li>HOME=/home：使用者主文件夾的基準目錄(basedir)<br>使用者的主文件夾通常是與帳號同名的目錄，這個目錄將會擺放在此設置值的目錄後。所以 vbird1 的主文件夾就會在 /home/vbird1/ 了！很容易理解吧！</li>
<li>INACTIVE=-1：密碼過期後是否會失效的設置值<br>我們在 shadow 文件結構當中談過，第七個字段的設置值將會影響到密碼過期後， 在多久時間內還可使用舊密碼登陸。這個項目就是在指定該日數啦！如果是 0 代表密碼過期立刻失效， 如果是 -1 則是代表密碼永遠不會失效，如果是數字，如 30 ，則代表過期 30 天后才失效。</li>
<li>EXPIRE=：帳號失效的日期<br>就是 shadow 內的第八字段，你可以直接設置帳號在哪個日期後就直接失效，而不理會密碼的問題。 通常不會設置此項目，但如果是付費的會員制系統，或許這個字段可以設置喔！</li>
<li>SHELL=/bin/bash：默認使用的 shell 程序文件名<br>系統默認的 shell 就寫在這裡。假如你的系統為 mail server ，你希望每個帳號都只能使用 email 的收發信件功能， 而不許使用者登陸系統取得 shell ，那麼可以將這裡設置為 /sbin/nologin ，如此一來，新建的使用者默認就無法登陸！ 也免去後續使用 usermod 進行修改的手續！</li>
<li>SKEL=/etc/skel：使用者主文件夾參考基準目錄<br>這個咚咚就是指定使用者主文件夾的參考基準目錄囉～舉我們的範例一為例， vbird1 主文件夾 /home/vbird1 內的各項數據，都是由 /etc/skel 所複製過去的～所以呢，未來如果我想要讓新增使用者時，該使用者的環境變量 ~/.bashrc 就設置妥當的話，您可以到 /etc/skel/.bashrc 去編輯一下，也可以創建 /etc/skel/www 這個目錄，那麼未來新增使用者後，在他的主文件夾下就會有 www 那個目錄了！這樣瞭呼？</li>
<li>CREATE_MAIL_SPOOL=yes：創建使用者的 mailbox<br>你可以使用“ ll /var/spool/mail/vbird1 ”看一下，會發現有這個文件的存在喔！這就是使用者的郵件信箱！</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="UID-GID-還有密碼參數"><a href="#UID-GID-還有密碼參數" class="headerlink" title="UID/GID 還有密碼參數"></a>UID/GID 還有密碼參數</h2><ul>
<li>路徑 <code>/etc/login.defs</code><br>MAIL_DIR        /var/spool/mail  &lt;==使用者默認郵件信箱放置目錄</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">PASS_MAX_DAYS   99999    &lt;==/etc/shadow 內的第 5 欄，多久需變更密碼日數</span><br><span class="line">PASS_MIN_DAYS   0        &lt;==/etc/shadow 內的第 4 欄，多久不可重新設置密碼日數</span><br><span class="line">PASS_MIN_LEN    5        &lt;==密碼最短的字符長度，已被 pam 模塊取代，失去效用！</span><br><span class="line">PASS_WARN_AGE   7        &lt;==/etc/shadow 內的第 6 欄，過期前會警告的日數</span><br><span class="line"></span><br><span class="line">UID_MIN          1000    &lt;==使用者最小的 UID，意即小於 1000 的 UID 為系統保留</span><br><span class="line">UID_MAX         60000    &lt;==使用者能夠用的最大 UID</span><br><span class="line">SYS_UID_MIN       201    &lt;==保留給使用者自行設置的系統帳號最小值 UID</span><br><span class="line">SYS_UID_MAX       999    &lt;==保留給使用者自行設置的系統帳號最大值 UID</span><br><span class="line">GID_MIN          1000    &lt;==使用者自訂群組的最小 GID，小於 1000 為系統保留</span><br><span class="line">GID_MAX         60000    &lt;==使用者自訂群組的最大 GID</span><br><span class="line">SYS_GID_MIN       201    &lt;==保留給使用者自行設置的系統帳號最小值 GID</span><br><span class="line">SYS_GID_MAX       999    &lt;==保留給使用者自行設置的系統帳號最大值 GID</span><br><span class="line"></span><br><span class="line">CREATE_HOME     yes      &lt;==在不加 -M 及 -m 時，是否主動創建使用者主文件夾？</span><br><span class="line">UMASK           077      &lt;==使用者主文件夾創建的 umask ，因此權限會是 700</span><br><span class="line">USERGROUPS_ENAB yes      &lt;==使用 userdel 刪除時，是否會刪除初始群組</span><br><span class="line">ENCRYPT_METHOD SHA512    &lt;==密碼加密的機制使用的是 sha512 這一個機制！</span><br></pre></td></tr></table></figure>
<ul>
<li><p>mailbox 所在目錄：<br>使用者的默認 mailbox 文件放置的目錄在 /var/spool/mail，所以 vbird1 的 mailbox 就是在 /var/spool/mail/vbird1 囉！</p>
</li>
<li><p>shadow 密碼第 4, 5, 6 字段內容：<br>通過 PASS_MAX_DAYS 等等設置值來指定的！所以你知道為何默認的 /etc/shadow 內每一行都會有“ 0:99999:7 ”的存在了嗎？^_^！不過要注意的是，由於目前我們登陸時改用 PAM 模塊來進行密碼檢驗，所以那個 PASS_MIN_LEN 是失效的！</p>
</li>
<li><p>UID/GID 指定數值：<br>雖然 Linux 核心支持的帳號可高達 232 這麼多個，不過一部主機要作出這麼多帳號在管理上也是很麻煩的！ 所以在這裡就針對 UID/GID 的範圍進行規範就是了。上表中的 UID_MIN 指的就是可登陸系統的一般帳號的最小 UID ，至於 UID_MAX 則是最大 UID 之意。</p>
</li>
</ul>
<p>要注意的是，系統給予一個帳號 UID 時，他是 (1)先參考 UID_MIN 設置值取得最小數值； (2)由 /etc/passwd 搜尋最大的 UID 數值， 將 (1) 與 (2) 相比，找出最大的那個再加一就是新帳號的 UID 了。我們上面已經作出 UID 為 1500 的 vbird2 ， 如果再使用“ useradd vbird4 ”時，你猜 vbird4 的 UID 會是多少？答案是： 1501 。 所以中間的 1004~1499 的號碼就空下來啦！</p>
<p>而如果我是想要創建系統用的帳號，所以使用 useradd -r sysaccount 這個 -r 的選項時，就會找“比 201 大但比 1000 小的最大的 UID ”就是了。 ^_^</p>
<ul>
<li><p>使用者主文件夾設置值：<br>為何我們系統默認會幫使用者創建主文件夾？就是這個“CREATE_HOME = yes”的設置值啦！這個設置值會讓你在使用 useradd 時， 主動加入“ -m ”這個產生主文件夾的選項啊！如果不想要創建使用者主文件夾，就只能強制加上“ -M ”的選項在 useradd 指令執行時啦！至於創建主文件夾的權限設置呢？就通過 umask 這個設置值啊！因為是 077 的默認設置，因此使用者主文件夾默認權限才會是“ drwx—— ”哩！</p>
</li>
<li><p>使用者刪除與密碼設置值：<br>使用“USERGROUPS_ENAB yes”這個設置值的功能是： 如果使用 userdel 去刪除一個帳號時，且該帳號所屬的初始群組已經沒有人隸屬於該群組了， 那麼就刪除掉該群組，舉例來說，我們剛剛有創建 vbird4 這個帳號，他會主動創建 vbird4 這個群組。 若 vbird4 這個群組並沒有其他帳號將他加入支持的情況下，若使用 userdel vbird4 時，該群組也會被刪除的意思。 至於“ENCRYPT_METHOD SHA512”則表示使用 SHA512 來加密密碼明文，而不使用舊式的 MD5。<br>現在你知道啦，使用 useradd 這支程序在創建 Linux 上的帳號時，至少會參考：</p>
</li>
</ul>
<p>/etc/default/useradd<br>/etc/login.defs<br>/etc/skel/*</p>
<p><br><br><br><br><br></p>
<h2 id="usermod"><a href="#usermod" class="headerlink" title="usermod"></a>usermod</h2><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">usermod [-cdegGlsuLU] username</span><br><span class="line">選項與參數：</span><br><span class="line">-c  ：後面接帳號的說明，即 /etc/passwd 第五欄的說明欄，可以加入一些帳號的說明。</span><br><span class="line">-d  ：後面接帳號的主文件夾，即修改 /etc/passwd 的第六欄；</span><br><span class="line">-e  ：後面接日期，格式是 YYYY-MM-DD 也就是在 /etc/shadow 內的第八個字段數據啦！</span><br><span class="line">-f  ：後面接天數，為 shadow 的第七字段。</span><br><span class="line">-g  ：後面接初始群組，修改 /etc/passwd 的第四個字段，亦即是 GID 的字段！</span><br><span class="line">-G  ：後面接次要群組，修改這個使用者能夠支持的群組，修改的是 /etc/group 囉～</span><br><span class="line">-a  ：與 -G 合用，可“增加次要群組的支持”而非“設置”喔！</span><br><span class="line">-l  ：後面接帳號名稱。亦即是修改帳號名稱， /etc/passwd 的第一欄！</span><br><span class="line">-s  ：後面接 Shell 的實際文件，例如 /bin/bash 或 /bin/csh 等等。</span><br><span class="line">-u  ：後面接 UID 數字啦！即 /etc/passwd 第三欄的數據；</span><br><span class="line">-L  ：暫時將使用者的密碼凍結，讓他無法登陸。其實僅改 /etc/shadow 的密碼欄。</span><br><span class="line">-U  ：將 /etc/shadow 密碼欄的 ! 拿掉，解凍啦！</span><br></pre></td></tr></table></figure>
<ul>
<li>增加指定 user 的次要群組<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">usermod -a -G groupName userName</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="chmod"><a href="#chmod" class="headerlink" title="chmod"></a>chmod</h2><ul>
<li>給予一個資料夾 SGID 屬性<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">chmod 2777 folderName</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h2><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">passwd [--stdin] [帳號名稱]  &lt;==所有人均可使用來改自己的密碼</span><br><span class="line">[root@study ~]# passwd [-l] [-u] [--stdin] [-S] \</span><br><span class="line">&gt;  [-n 日數] [-x 日數] [-w 日數] [-i 日期] 帳號 &lt;==root 功能</span><br><span class="line">選項與參數：</span><br><span class="line">--stdin ：可以通過來自前一個管線的數據，作為密碼輸入，對 shell script 有幫助！</span><br><span class="line">-l  ：是 Lock 的意思，會將 /etc/shadow 第二欄最前面加上 ! 使密碼失效；</span><br><span class="line">-u  ：與 -l 相對，是 Unlock 的意思！</span><br><span class="line">-S  ：列出密碼相關參數，亦即 shadow 文件內的大部分信息。</span><br><span class="line">-n  ：後面接天數，shadow 的第 4 字段，多久不可修改密碼天數</span><br><span class="line">-x  ：後面接天數，shadow 的第 5 字段，多久內必須要更動密碼</span><br><span class="line">-w  ：後面接天數，shadow 的第 6 字段，密碼過期前的警告天數</span><br><span class="line">-i  ：後面接“日期”，shadow 的第 7 字段，密碼失效日期</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="確認-OS-種類以及版本"><a href="#確認-OS-種類以及版本" class="headerlink" title="確認 OS 種類以及版本"></a>確認 OS 種類以及版本</h2><ul>
<li><p>使用 <code>lsb_release</code> ， 如果沒安裝的話，安裝它</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">sudo apt-get install lsb-release</span><br></pre></td></tr></table></figure>
</li>
<li><p>查詢用法</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">lsb_release --<span class="hljs-built_in">help</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>輸出如下：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">-h, --help         show this help message and exit</span><br><span class="line">-v, --version      show LSB modules this system supports</span><br><span class="line">-i, --id           show distributor ID</span><br><span class="line">-d, --description  show description of this distribution</span><br><span class="line">-r, --release      show release number of this distribution</span><br><span class="line">-c, --codename     show code name of this distribution</span><br><span class="line">-a, --all          show all of the above information</span><br><span class="line">-s, --short        show requested information in short format</span><br></pre></td></tr></table></figure></p>
<ul>
<li>根據上面的資訊，想查詢明細的話<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">lsb_release -a</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><h3 id="語法-2"><a href="#語法-2" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">curl [options] [URL...]</span><br><span class="line">-X 代表 request 的方式</span><br><span class="line">-H 代表 header</span><br><span class="line">-d 代表傳送資料，等同於以 `Content-Type: application/x-www-form-urlencoded` 方式傳送</span><br><span class="line">-k 若經由 `https` 發請求，加上 -k 可避開 HTTPS 方式</span><br><span class="line">-v 代表 `verbose` , 若要顯示回覆訊息，需加上 `-v`</span><br><span class="line">-L 如果 server 端回報位置已轉址, curl 會對新的位址在發請求</span><br><span class="line">-T 上傳檔案</span><br><span class="line">-s slient 模式</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例"><a href="#範例" class="headerlink" title="範例"></a>範例</h3><p>假設請求如下：<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">curl -X POST \</span><br><span class="line">  https://requestedURL \</span><br><span class="line">  -H <span class="hljs-string">'Content-Type: application/json'</span> \</span><br><span class="line">  -d <span class="hljs-string">'&#123;"dataA":"content of data A","dataB":"content of data B"&#125;'</span> -k -v</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>-X</code> 代表 request 的方式</li>
<li><code>ip</code> 請由此<a href="http://api.qcdn.io/edges_alive" target="_blank" rel="noopener">查詢</a></li>
<li><code>-H</code> 代表 header</li>
<li><code>-d</code> 代表傳送資料，等同於以 <code>Content-Type: application/x-www-form-urlencoded</code> 方式傳送</li>
<li><code>-k</code> 若經由 <code>https</code> 發請求，需加上 <code>-k</code></li>
<li><code>-v</code> 代表 <code>verbose</code> , 若要顯示回覆訊息，需加上 <code>-v</code></li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="bash-環境配置文件"><a href="#bash-環境配置文件" class="headerlink" title="bash 環境配置文件"></a>bash 環境配置文件</h2><h3 id="bash-會根據有沒有登入來讀取相對應的環境配置文件"><a href="#bash-會根據有沒有登入來讀取相對應的環境配置文件" class="headerlink" title="bash 會根據有沒有登入來讀取相對應的環境配置文件"></a>bash 會根據有沒有登入來讀取相對應的環境配置文件</h3><ul>
<li><p>login shell</p>
<ul>
<li><code>/etc/profile</code><ul>
<li><code>/etc/profile.d/*.sh</code><ul>
<li>被調用的條件如下：</li>
<li>在 /etc/profile.d/ 這個目錄內</li>
<li>擴展名為 .sh </li>
<li>使用者能夠具有 r 的權限</li>
</ul>
</li>
</ul>
</li>
<li><code>~/.bash_profile</code> or <code>~/.bash_login</code> or <code>~/.profile</code> (照順序讀，只會讀其中一個)<ul>
<li><code>~/.bashrc</code> (最終會讀取這一個文件)</li>
</ul>
</li>
</ul>
</li>
<li><p>non-login shell</p>
<ul>
<li><code>~/.bashrc</code><ul>
<li><code>etc/bashrc</code> (會調用此文件)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><br></p>
<h3 id="流程圖"><a href="#流程圖" class="headerlink" title="流程圖"></a>流程圖</h3><p><img src="https://i.imgur.com/KqrTrVt.png" alt></p>
<p><br></p>
<h3 id="不小心刪除了-bashrc-或是沒有這個文件，想創建怎麼辦？"><a href="#不小心刪除了-bashrc-或是沒有這個文件，想創建怎麼辦？" class="headerlink" title="不小心刪除了 ~/.bashrc, 或是沒有這個文件，想創建怎麼辦？"></a>不小心刪除了 <code>~/.bashrc</code>, 或是沒有這個文件，想創建怎麼辦？</h3><ul>
<li><p>複製預設文件</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">cp /etc/skel/.bashrc ~/</span><br></pre></td></tr></table></figure>
</li>
<li><p>視需求修改</p>
</li>
<li>使立即生效<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>or</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">. ~/.bashrc</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="Base-64-decode"><a href="#Base-64-decode" class="headerlink" title="Base 64 decode"></a>Base 64 decode</h2><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">base64 --decode /tmp/encoded.txt &gt; /tmp/decoded.txt</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="ncftp"><a href="#ncftp" class="headerlink" title="ncftp"></a>ncftp</h2><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">ncftpput -u account -p password -P port -m -R ipOrDomain remoteLocation locationFileOrDirectory</span><br></pre></td></tr></table></figure>
<ul>
<li>-u：指定登錄FTP服務器時使用的用戶名；</li>
<li>-p：指定登錄FTP服務器時使用的密碼；</li>
<li>-P：如果FTP服務器沒有使用默認的TCP協議的21端口，則使用此選項指定FTP服務器的端口號。</li>
<li>-m：在傳之前嘗試在目錄位置創建目錄(用於傳目錄的情況)</li>
<li>-R：遞規傳子目錄</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="ufw"><a href="#ufw" class="headerlink" title="ufw"></a>ufw</h2><ul>
<li><p>啟用防火牆服務</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">ufw <span class="hljs-built_in">enable</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>關閉防火牆服務</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">ufw <span class="hljs-built_in">disable</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>打開指定 port</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">ufw allow port/tcp</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><ul>
<li><p>使用 install 指令，我們可以在創立一個 folder 或 file 的同時，指定 owner, group 以及 mode<br>  <code>install -d -o &lt;user&gt; -g &lt;group&gt; -m &lt;mode&gt; &lt;path&gt;</code></p>
<ul>
<li><code>-d</code> : directory</li>
<li><code>-o</code> : owner</li>
<li><code>-g</code> : group</li>
<li><code>-m</code> : mode</li>
</ul>
</li>
<li><p>建立一個資料夾，並給予權限</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">install -d -o ray -g ray -m 2770 /tmp/ray</span><br></pre></td></tr></table></figure>
</li>
<li><p>建立一個檔案，並給予權限</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">install -m 777 -o ray -g ray /dev/null filename.txt</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="yum"><a href="#yum" class="headerlink" title="yum"></a>yum</h2><h3 id="whatprovides"><a href="#whatprovides" class="headerlink" title="whatprovides"></a>whatprovides</h3><ul>
<li>找出有提供特定 command 的 package<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">yum whatprovides */commandYouAreLookingFor</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h3 id="install-1"><a href="#install-1" class="headerlink" title="install"></a>install</h3><ul>
<li>安裝特定的 package<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">yum insatll packageName</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="regular-expression-regex-正則表達式"><a href="#regular-expression-regex-正則表達式" class="headerlink" title="regular expression (regex) (正則表達式)"></a>regular expression (regex) (正則表達式)</h2><h3 id="特殊符號表"><a href="#特殊符號表" class="headerlink" title="特殊符號表"></a>特殊符號表</h3><table>
<thead>
<tr>
<th>特殊符號</th>
<th>代表意義</th>
</tr>
</thead>
<tbody>
<tr>
<td>[:alnum:]</td>
<td>代表英文大小寫字符及數字，亦即 0-9, A-Z, a-z</td>
</tr>
<tr>
<td>[:alpha:]</td>
<td>代表任何英文大小寫字符，亦即 A-Z, a-z</td>
</tr>
<tr>
<td>[:blank:]</td>
<td>代表空白鍵與 [Tab] 按鍵兩者</td>
</tr>
<tr>
<td>[:cntrl:]</td>
<td>代表鍵盤上面的控制按鍵，亦即包括 CR, LF, Tab, Del.. 等等</td>
</tr>
<tr>
<td>[:digit:]</td>
<td>代表數字而已，亦即 0-9</td>
</tr>
<tr>
<td>[:graph:]</td>
<td>除了空白字符 (空白鍵與 [Tab] 按鍵) 外的其他所有按鍵</td>
</tr>
<tr>
<td>[:lower:]</td>
<td>代表小寫字符，亦即 a-z</td>
</tr>
<tr>
<td>[:print:]</td>
<td>代表任何可以被打印出來的字符</td>
</tr>
<tr>
<td>[:punct:]</td>
<td>代表標點符號 (punctuation symbol)，亦即：” ‘ ? ! ; : # $…</td>
</tr>
<tr>
<td>[:upper:]</td>
<td>代表大寫字符，亦即 A-Z</td>
</tr>
<tr>
<td>[:space:]</td>
<td>任何會產生空白的字符，包括空白鍵, [Tab], CR 等等</td>
</tr>
<tr>
<td>[:xdigit:]</td>
<td>代表 16 進位的數字類型，因此包括： 0-9, A-F, a-f 的數字與字符</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="表達式彙整"><a href="#表達式彙整" class="headerlink" title="表達式彙整"></a>表達式彙整</h3><table>
<thead>
<tr>
<th>字元</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>\</td>
<td>將下一個字元標記為一個特殊字元(File Format Escape，見本表)、或一個原義字元(Identity Escape，有 ^ $ ( ) * + ? . [ \ { &#124; 共計12個)、或一個向後參照(backreferences)、或一個八進位跳脫符。例如，「n」匹配字元「n」。「\n」匹配一個換行符。序列「\」匹配「\」而「(」則匹配「(」。</td>
</tr>
<tr>
<td>^</td>
<td>匹配輸入字串的開始位置。如果設定了RegExp物件的Multiline屬性，^也匹配「\n」或「\r」之後的位置。</td>
</tr>
<tr>
<td>$</td>
<td>匹配輸入字串的結束位置。如果設定了RegExp物件的Multiline屬性，$也匹配「\n」或「\r」之前的位置。</td>
</tr>
<tr>
<td>*</td>
<td>匹配前面的子表達式零次或多次。例如，zo<em>能匹配「z」、「zo」以及「zoo」。</em>等價於{0,}。</td>
</tr>
<tr>
<td>+</td>
<td>匹配前面的子表達式一次或多次。例如，「zo+」能匹配「zo」以及「zoo」，但不能匹配「z」。+等價於{1,}。</td>
</tr>
<tr>
<td>?</td>
<td>匹配前面的子表達式零次或一次。例如，「do(es)?」可以匹配「does」中的「do」和「does」。?等價於{0,1}。</td>
</tr>
<tr>
<td>{n}</td>
<td>n是一個非負整數。匹配確定的n次。例如，「o{2}」不能匹配「Bob」中的「o」，但是能匹配「food」中的兩個o。</td>
</tr>
<tr>
<td>{n,}</td>
<td>n是一個非負整數。至少匹配n次。例如，「o{2,}」不能匹配「Bob」中的「o」，但能匹配「foooood」中的所有o。「o{1,}」等價於「o+」。「o{0,}」則等價於「o*」。</td>
</tr>
<tr>
<td>{n,m}</td>
<td>m和n均為非負整數，其中n&lt;=m。最少匹配n次且最多匹配m次。例如，「o{1,3}」將匹配「fooooood」中的前三個o。「o{0,1}」等價於「o?」。請注意在逗號和兩個數之間不能有空格。</td>
</tr>
<tr>
<td>?</td>
<td>非貪心量化(Non-greedy quantifiers)：當該字元緊跟在任何一個其他重複修飾詞(*,+,?，{n}，{n,}，{n,m})後面時，匹配模式是非貪婪的。非貪婪模式儘可能少的匹配所搜尋的字串，而預設的貪婪模式則儘可能多的匹配所搜尋的字串。例如，對於字串「oooo」，「o+?」將匹配單個「o」，而「o+」將匹配所有「o」。</td>
</tr>
<tr>
<td>.</td>
<td>匹配除「\r」「\n」之外的任何單個字元。要匹配包括「\r」「\n」在內的任何字元，請使用像「(.&#124;\r&#124;\n)」的模式。</td>
</tr>
<tr>
<td>(pattern)</td>
<td>匹配pattern並取得這一匹配的子字串。該子字串用於向後參照。所取得的匹配可以從產生的Matches集合得到，在VBScript中使用SubMatches集合，在JScript中則使用$0…$9屬性。要匹配圓括號字元，請使用「(」或「)」。可帶數量字尾。</td>
</tr>
<tr>
<td>(?:pattern)</td>
<td>匹配pattern但不取得匹配的子字串(shy groups)，也就是說這是一個非取得匹配，不儲存匹配的子字串用於向後參照。這在使用或字元「(&#124;)」來組合一個模式的各個部分是很有用。例如「industr(?:y&#124;ies)」就是一個比「industry&#124;industries」更簡略的表達式。</td>
</tr>
<tr>
<td>(?=pattern)</td>
<td>正向肯定預查(look ahead positive assert)，在任何匹配pattern的字串開始處匹配尋找字串。這是一個非取得匹配，也就是說，該匹配不需要取得供以後使用。例如，「Windows(?=95&#124;98&#124;NT&#124;2000)」能匹配「Windows2000」中的「Windows」，但不能匹配「Windows3.1」中的「Windows」。預查不消耗字元，也就是說，在一個匹配發生後，在最後一次匹配之後立即開始下一次匹配的搜尋，而不是從包含預查的字元之後開始。</td>
</tr>
<tr>
<td>(?!pattern)</td>
<td>正向否定預查(negative assert)，在任何不匹配pattern的字串開始處匹配尋找字串。這是一個非取得匹配，也就是說，該匹配不需要取得供以後使用。例如「Windows(?!95&#124;98&#124;NT&#124;2000)」能匹配「Windows3.1」中的「Windows」，但不能匹配「Windows2000」中的「Windows」。預查不消耗字元，也就是說，在一個匹配發生後，在最後一次匹配之後立即開始下一次匹配的搜尋，而不是從包含預查的字元之後開始</td>
</tr>
<tr>
<td>(?&lt;=pattern)</td>
<td>反向(look behind)肯定預查，與正向肯定預查類似，只是方向相反。例如，「(?&lt;=95&#124;98 &#124; NT&#124;2000)Windows」能匹配「2000Windows」中的「Windows」，但不能匹配「3.1Windows」中的「Windows」。</td>
</tr>
<tr>
<td>(?&lt;!pattern)</td>
<td>反向否定預查，與正向否定預查類似，只是方向相反。例如「(?&lt;!95 &#124;98&#124;NT&#124;2000)Windows」能匹配「3.1Windows」中的「Windows」，但不能匹配「2000Windows」中的「Windows」。x&#124;y 沒有包圍在()里，其範圍是整個正規表示式。例如，「z&#124;food」能匹配「z」或「food」。「(?:z&#124;f)ood」則匹配「zood」或「food」。</td>
</tr>
<tr>
<td>[xyz]</td>
<td>字元集合(character class)。匹配所包含的任意一個字元。例如，「[abc]」可以匹配「plain」中的「a」。特殊字元僅有反斜線\保持特殊含義，用於跳脫字元。其它特殊字元如星號、加號、各種括號等均作為普通字元。脫字元^如果出現在首位則表示負值字元集合；如果出現在字串中間就僅作為普通字元。連字元 - 如果出現在字串中間表示字元範圍描述；如果如果出現在首位(或末尾)則僅作為普通字元。右方括號應跳脫出現，也可以作為首位字元出現。</td>
</tr>
<tr>
<td>[^xyz]</td>
<td>排除型字元集合(negated character classes)。匹配未列出的任意字元。例如，「[^abc]」可以匹配「plain」中的「plin」。</td>
</tr>
<tr>
<td>[a-z]</td>
<td>字元範圍。匹配指定範圍內的任意字元。例如，「[a-z]」可以匹配「a」到「z」範圍內的任意小寫字母字元。</td>
</tr>
<tr>
<td>[^a-z]</td>
<td>排除型的字元範圍。匹配任何不在指定範圍內的任意字元。例如，「[^a-z]」可以匹配任何不在「a」到「z」範圍內的任意字元。</td>
</tr>
<tr>
<td>[:name:]</td>
<td>增加命名字元類(named character class)[註 1]中的字元到表達式。只能用於方括號表達式。</td>
</tr>
<tr>
<td>[=elt=]</td>
<td>增加目前locale下排序(collate)等價於字元「elt」的元素。例如，[=a=]可能會增加ä、á、à、ă、ắ、ằ、ẵ、ẳ、â、ấ、ầ、ẫ、ẩ、ǎ、å、ǻ、ä、ǟ、ã、ȧ、ǡ、ą、ā、ả、ȁ、ȃ、ạ、ặ、ậ、ḁ、ⱥ、ᶏ、ɐ、ɑ 。只能用於方括號表達式。</td>
</tr>
<tr>
<td>[.elt.]</td>
<td>增加排序元素(collation element)elt到表達式中。這是因為某些排序元素由多個字元組成。例如，29個字母表的西班牙語， “CH”作為單個字母排在字母C之後，因此會產生如此排序「cinco, credo, chispa」。只能用於方括號表達式。</td>
</tr>
<tr>
<td>\b</td>
<td>匹配一個單詞邊界，也就是指單詞和空格間的位置。例如，「er\b」可以匹配「never」中的「er」，但不能匹配「verb」中的「er」。</td>
</tr>
<tr>
<td>\B</td>
<td>匹配非單詞邊界。「er\B」能匹配「verb」中的「er」，但不能匹配「never」中的「er」。</td>
</tr>
<tr>
<td>\cx</td>
<td>匹配由x指明的控制字元。x的值必須為A-Z或a-z之一。否則，將c視為一個原義的「c」字元。控制字元的值等於x的值最低5位元(即對3210進位的餘數)。例如，\cM匹配一個Control-M或回車字元。\ca等效於\u0001, \cb等效於\u0&#124; 002, 等等…</td>
</tr>
<tr>
<td>\d</td>
<td>匹配一個數字字元。等價於[0-9]。注意Unicode正規表示式會匹配全形數字字元。</td>
</tr>
<tr>
<td>\D</td>
<td>匹配一個非數字字元。等價於[^0-9]。</td>
</tr>
<tr>
<td>\f</td>
<td>匹配一個換頁符。等價於\x0c和\cL。</td>
</tr>
<tr>
<td>\n</td>
<td>匹配一個換行符。等價於\x0a和\cJ。</td>
</tr>
<tr>
<td>\r</td>
<td>匹配一個回車字元。等價於\x0d和\cM。</td>
</tr>
<tr>
<td>\s</td>
<td>匹配任何空白字元，包括空格、制表符、換頁符等等。等價於[ \f\n\r\t\v]。注意Unicode正規表示式會匹配全形空格符。</td>
</tr>
<tr>
<td>\S</td>
<td>匹配任何非空白字元。等價於[^ \f\n\r\t\v]。</td>
</tr>
<tr>
<td>\t</td>
<td>匹配一個制表符。等價於\x09和\cI。</td>
</tr>
<tr>
<td>\v</td>
<td>匹配一個垂直制表符。等價於\x0b和\cK。</td>
</tr>
<tr>
<td>\w</td>
<td>匹配包括底線的任何單詞字元。等價於「[A-Za-z0-9_]」。注意Unicode正規表示式會匹配中文字元。</td>
</tr>
<tr>
<td>\W</td>
<td>匹配任何非單詞字元。等價於「[^A-Za-z0-9_]」。</td>
</tr>
<tr>
<td>\xnn</td>
<td>十六進位跳脫字元序列。匹配兩個十六進位數字nn表示的字元。例如，「\x41」匹配「A」。「\x041」則等價於「\x04&amp;1」。正規表達式中可以使用ASCII編碼。.</td>
</tr>
<tr>
<td>\num</td>
<td>向後參照(back-reference)一個子字串(substring)，該子字串與正規表示式的第num個用括號圍起來的捕捉群(capture group)子表達式(subexpression)匹配。其中num是從1開始的十進位正整數，其上限可能是9[註 2]、31[註 3]、99甚至無限[註 4]。例如：「(.)\1」匹配兩個連續的相同字元。</td>
</tr>
<tr>
<td>\n</td>
<td>標識一個八進位跳脫值或一個向後參照。如果\n之前至少n個取得的子表達式，則n為向後參照。否則，如果n為八進位數字(0-7)，則n為一個八進位跳脫值。</td>
</tr>
<tr>
<td>\nm</td>
<td>3位八進位數字，標識一個八進位跳脫值或一個向後參照。如果\nm之前至少有nm個獲得子表達式，則nm為向後參照。如果\nm之前至少有n個取得，則n為一個後跟文字m的向後參照。如果前面的條件都不滿足，若n和m均為八進位數字(0-7)，則\nm將匹配八進位跳脫值nm。</td>
</tr>
<tr>
<td>\nml</td>
<td>如果n為八進位數字(0-3)，且m和l均為八進位數字(0-7)，則匹配八進位跳脫值nml。</td>
</tr>
<tr>
<td>\un</td>
<td>Unicode跳脫字元序列。其中n是一個用四個十六進位數字表示的Unicode字元。例如，\u00A9匹配著作權符號(©)。</td>
</tr>
</tbody>
</table>
<h3 id="基礎正規表達式字符彙整"><a href="#基礎正規表達式字符彙整" class="headerlink" title="基礎正規表達式字符彙整"></a>基礎正規表達式字符彙整</h3><table>
<thead>
<tr>
<th>RE 字符</th>
<th>意義與範例 </th>
</tr>
</thead>
<tbody>
<tr>
<td><code>^</code>word</td>
<td>意義：待搜尋的字串(word)在行首！ <br> 範例：搜尋行首為 # 開始的那一行，並列出行號 <br><code>grep -n &#39;^#&#39; regular_express.txt</code></td>
</tr>
<tr>
<td>word<code>$</code></td>
<td>意義：待搜尋的字串(word)在行尾！<br> 範例：將行尾為 ! 的那一行打印出來，並列出行號 <br> <code>grep -n &#39;!$&#39; regular_express.txt</code></td>
</tr>
<tr>
<td>.</td>
<td>意義：代表“一定有一個任意字符”的字符！ <br> 範例：搜尋的字串可以是 (eve) (eae) (eee) (e e)， 但不能僅有 (ee) ！亦即 e 與 e 中間“一定”僅有一個字符，而空白字符也是字符！ <br> <code>grep -n &#39;e.e&#39; regular_express.txt</code></td>
</tr>
<tr>
<td>\</td>
<td>意義：跳脫字符，將特殊符號的特殊意義去除！ <br> 範例：搜尋含有單引號 ‘ 的那一行！ <br> <code>grep -n \&#39; regular_express.txt</code></td>
</tr>
<tr>
<td>*</td>
<td>意義：重複零個到無窮多個的前一個 RE 字符 <br> 範例：找出含有 (es) (ess) (esss) 等等的字串，注意，因為 <em> 可以是 0 個，所以 es 也是符合帶搜尋字串。另外，因為 </em> 為重複“前一個 RE 字符”的符號， 因此，在 <em> 之前必須要緊接著一個 RE 字符喔！例如任意字符則為 “.</em>” ！ <br> <code>grep -n &#39;ess*&#39; regular_express.txt</code></td>
</tr>
<tr>
<td>[list]</td>
<td>意義：字符集合的 RE 字符，裡面列出想要擷取的字符！ <br> 範例：搜尋含有 (gl) 或 (gd) 的那一行，需要特別留意的是，在 [] 當中“謹代表一個待搜尋的字符”， 例如“ a[afl]y ”代表搜尋的字串可以是 aay, afy, aly 即 [afl] 代表 a 或 f 或 l 的意思！ <br> <code>grep -n &#39;g[ld]&#39; regular_express.txt</code></td>
</tr>
<tr>
<td>[n1-n2]</td>
<td>意義：字符集合的 RE 字符，裡面列出想要擷取的字符範圍！ <br> 範例：搜尋含有任意數字的那一行！需特別留意，在字符集合 [] 中的減號 - 是有特殊意義的，他代表兩個字符之間的所有連續字符！但這個連續與否與 ASCII 編碼有關，因此，你的編碼需要設置正確(在 bash 當中，需要確定 LANG 與 LANGUAGE 的變量是否正確！) 例如所有大寫字符則為 [A-Z] <br> <code>grep -n &#39;[A-Z]&#39; regular_express.txt</code></td>
</tr>
<tr>
<td>[^list]</td>
<td>意義：字符集合的 RE 字符，裡面列出不要的字串或範圍！ <br> 範例：搜尋的字串可以是 (oog) (ood) 但不能是 (oot) ，那個 ^ 在 [] 內時，代表的意義是“反向選擇”的意思。 例如，我不要大寫字符，則為 [^A-Z]。但是，需要特別注意的是，如果以 grep -n [^A-Z] regular_express.txt 來搜尋，卻發現該文件內的所有行都被列出，為什麼？因為這個 [^A-Z] 是“非大寫字符”的意思， 因為每一行均有非大寫字符，例如第一行的 “Open Source” 就有 p,e,n,o…. 等等的小寫字 <br> <code>grep -n &#39;oo[^t]&#39; regular_express.txt</code></td>
</tr>
<tr>
<td>{n,m}</td>
<td>意義：連續 n 到 m 個的“前一個 RE 字符” <br> 意義：若為 {n} 則是連續 n 個的前一個 RE 字符， <br> 意義：若是 {n,} 則是連續 n 個以上的前一個 RE 字符！ 範例：在 g 與 g 之間有 2 個到 3 個的 o 存在的字串，亦即 (goog)(gooog) <br> <code>grep -n &#39;go\{2,3\}g&#39; regular_express.txt</code></td>
</tr>
</tbody>
</table>
<h3 id="範例-1"><a href="#範例-1" class="headerlink" title="範例"></a>範例</h3><h4 id="驗證密碼"><a href="#驗證密碼" class="headerlink" title="驗證密碼"></a>驗證密碼</h4><p>條件如下：</p>
<ol>
<li>8~16字元</li>
<li>至少一個數字</li>
<li>至少一個小寫英文字母 或 大寫英文字母</li>
<li>至少要有一個特殊符號, 特殊符號限制在 @$%^&amp; 這些當中, 不然可能會出現 ∆©ƒ  這種符號, 使用者想像力無限</li>
</ol>
<p>正則如下：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">^(?=.*[a-z]|.*[A-Z])(?=.*[\d])(?=.*[\W])[\w@$%\^&amp;]&#123;8,16&#125;$</span><br></pre></td></tr></table></figure></p>
<ol>
<li>第一個規則為 lookahead, 目標搜尋至少一個大寫字母或小寫字母, 因為前面加了 <code>.*</code>, 所以就算 lookahead 的前面是空的也沒關係, 從起始處開始往後搜尋, 需符合第一個 lookahead <code>?=</code> 之後的規則, 若沒找到則停止, 找到則繼續下一個規則</li>
<li>開始第二個 lookahead 規則, 目標尋找至少一個數字, 第一個規則通過後, 才會開始第二個規則。 第二個規則從起始處開始搜尋, 若無找到則停止, 有找到則繼續</li>
<li>第三個 lookahead 規則, 目標尋找至少一個特殊字符, 行為同上</li>
<li>三個規則都通過後, 驗證最後一個規則, 字串可以是大小寫以及有列出的特殊符號, 數量為 8~16 個字元</li>
</ol>
<p><br><br><br><br><br></p>
<h2 id="crontab"><a href="#crontab" class="headerlink" title="crontab"></a>crontab</h2><h3 id="安裝"><a href="#安裝" class="headerlink" title="安裝"></a>安裝</h3><ul>
<li>CentOS<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">yum install cronie</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h3 id="代表意義"><a href="#代表意義" class="headerlink" title="代表意義"></a>代表意義</h3><table>
<thead>
<tr>
<th>代表意義</th>
<th>分鐘</th>
<th>小時</th>
<th>日期</th>
<th>月份</th>
<th>周</th>
<th>指令</th>
</tr>
</thead>
<tbody>
<tr>
<td>數字範圍</td>
<td>0-59</td>
<td>0-23</td>
<td>1-31</td>
<td>1-1</td>
<td>0-7</td>
<td>呀就指令啊</td>
</tr>
</tbody>
</table>
<p>比較有趣的是那個“周”喔！周的數字為 0 或 7 時，都代表“星期天”的意思！另外，還有一些輔助的字符，大概有下面這些：</p>
<table>
<thead>
<tr>
<th>特殊字符</th>
<th>代表意義</th>
</tr>
</thead>
<tbody>
<tr>
<td>*(星號)</td>
<td><code>代表任何時刻都接受的意思！舉例來說，範例一內那個日、月、周都是 * ， 就代表著“不論何月、何日的禮拜幾的 12:00 都執行後續指令”的意思！</code></td>
</tr>
<tr>
<td>,(逗號)</td>
<td><code>代表分隔時段的意思。舉例來說，如果要下達的工作是 3:00 與 6:00 時，就會是：</code><br> <code>0 3,6 * * * command</code> <br> <code>時間參數還是有五欄，不過第二欄是 3,6 ，代表 3 與 6 都適用！</code></td>
</tr>
<tr>
<td>-(減號)</td>
<td><code>代表一段時間範圍內，舉例來說， 8 點到 12 點之間的每小時的 20 分都進行一項工作：</code><br><code>20 8-12 * * * command</code><br><code>仔細看到第二欄變成 8-12 喔！代表 8,9,10,11,12 都適用的意思！</code></td>
</tr>
<tr>
<td>/n(斜線)</td>
<td><code>那個 n 代表數字，亦即是“每隔 n 單位間隔”的意思，例如每五分鐘進行一次，則：</code><br><code>*/5 * * * * command</code><br><code>很簡單吧！用 * 與 /5 來搭配，也可以寫成 0-59/5 ，相同意思！</code></td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="etc-crontab"><a href="#etc-crontab" class="headerlink" title="/etc/crontab"></a>/etc/crontab</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# cat /etc/crontab</span><br><span class="line">SHELL=/bin/bash                     &lt;==使用哪種 shell 接口</span><br><span class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin  &lt;==可執行文件搜尋路徑</span><br><span class="line">MAILTO=root                         &lt;==若有額外STDOUT，以 email將數據送給誰</span><br><span class="line"></span><br><span class="line"># Example of job definition:</span><br><span class="line"># .---------------- minute (0 - 59)</span><br><span class="line"># |  .------------- hour (0 - 23)</span><br><span class="line"># |  |  .---------- day of month (1 - 31)</span><br><span class="line"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="line"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="line"># |  |  |  |  |</span><br><span class="line"># *  *  *  *  * user-name  command to be executed</span><br></pre></td></tr></table></figure>
<ul>
<li><p>MAILTO=root：</p>
<ul>
<li>當 /etc/crontab 這個文件中的例行性工作的指令發生錯誤時，或者是該工作的執行結果有 STDOUT/STDERR 時，會將錯誤訊息或者是屏幕顯示的訊息送的對象</li>
<li>默認是由系統直接寄發一封 mail 給 root</li>
<li>例如：<a href="mailto:MAILTO=dmtsai@my.host.name" target="_blank" rel="noopener">MAILTO=dmtsai@my.host.name</a></li>
</ul>
</li>
<li><p>PATH=….：<br>輸入可執行文件的搜尋路徑，使用默認的路徑設置就已經很足夠了！</p>
</li>
<li><p>“分 時 日 月 周 身份 指令”七個字段的設置</p>
<ul>
<li>這個 /etc/crontab 可以設置的基本語法與 crontab -e 不太相同</li>
<li>前面同樣是分、時、日、月、週五個字段， 但是在五個字段後面接的並不是指令，就是“執行後面那串指令的身份” </li>
<li>這與使用者的 crontab -e 不相同。由於使用者自己的 crontab 並不需要指定身份</li>
</ul>
</li>
</ul>
<p><br></p>
<h3 id="crond-服務讀取配置文件"><a href="#crond-服務讀取配置文件" class="headerlink" title="crond 服務讀取配置文件"></a>crond 服務讀取配置文件</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">/etc/crontab</span><br><span class="line">/etc/cron.d/*</span><br><span class="line">/var/spool/cron/*</span><br></pre></td></tr></table></figure>
<ul>
<li>跟系統的運行比較有關係的兩個配置文件是放在 /etc/crontab 文件內以及 /etc/cron.d/* 目錄內的文件</li>
<li>跟用戶自己的工作比較有關的配置文件放在 /var/spool/cron/</li>
</ul>
<p><br></p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li><p>輸入 crontab job</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>
</li>
<li><p>確認 crontab 狀態</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">/etc/init.d/cron status</span><br></pre></td></tr></table></figure>
</li>
<li><p>停止 crontab</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">/etc/init.d/cron stop</span><br></pre></td></tr></table></figure>
</li>
<li><p>啟動 crontab</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">/etc/init.d/cron start</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h3 id="anacron"><a href="#anacron" class="headerlink" title="anacron"></a>anacron</h3><h4 id="語法-3"><a href="#語法-3" class="headerlink" title="語法"></a>語法</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# anacron [-sfn] [job]..</span><br><span class="line">[root@study ~]# anacron -u [job]..</span><br><span class="line">選項與參數：</span><br><span class="line">-s  ：開始一連續的執行各項工作 (job)，會依據時間記錄文件的數據判斷是否進行；</span><br><span class="line">-f  ：強制進行，而不去判斷時間記錄文件的時間戳記；</span><br><span class="line">-n  ：立刻進行未進行的任務，而不延遲 (delay) 等待時間；</span><br><span class="line">-u  ：僅更新時間記錄文件的時間戳記，不進行任何工作。</span><br><span class="line">job ：由 /etc/anacrontab 定義的各項工作名稱。</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="配置檔"><a href="#配置檔" class="headerlink" title="配置檔"></a>配置檔</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# cat /etc/anacrontab</span><br><span class="line">SHELL=/bin/sh</span><br><span class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line">MAILTO=root</span><br><span class="line">RANDOM_DELAY=45           # 隨機給予最大延遲時間，單位是分鐘</span><br><span class="line">START_HOURS_RANGE=3-22    # 延遲多少個小時內應該要執行的任務時間</span><br><span class="line"></span><br><span class="line">1         5        cron.daily         nice run-parts /etc/cron.daily</span><br><span class="line">7        25        cron.weekly        nice run-parts /etc/cron.weekly</span><br><span class="line">@monthly 45        cron.monthly       nice run-parts /etc/cron.monthly</span><br><span class="line">天數     延遲時間  工作名稱定義       實際要進行的指令串</span><br><span class="line"># 天數單位為天；延遲時間單位為分鐘；工作名稱定義可自訂，指令串則通常與 crontab 的設置相同！</span><br><span class="line"></span><br><span class="line">[root@study ~]# more /var/spool/anacron/*</span><br><span class="line">::::::::::::::</span><br><span class="line">/var/spool/anacron/cron.daily</span><br><span class="line">::::::::::::::</span><br><span class="line">20150731</span><br><span class="line">::::::::::::::</span><br><span class="line">/var/spool/anacron/cron.monthly</span><br><span class="line">::::::::::::::</span><br><span class="line">20150703</span><br><span class="line">::::::::::::::</span><br><span class="line">/var/spool/anacron/cron.weekly</span><br><span class="line">::::::::::::::</span><br><span class="line">20150727</span><br><span class="line"># 上面則是三個工作名稱的時間記錄文件以及記錄的時間戳記</span><br></pre></td></tr></table></figure>
<p>拿 /etc/cron.daily/ 那一行的設置來說明，那四個字段的意義分別是：</p>
<ul>
<li>天數：anacron 執行當下與時間戳記 (/var/spool/anacron/ 內的時間紀錄檔) 相差的天數，若超過此天數，就準備開始執行，若沒有超過此天數，則不予執行後續的指令。</li>
<li>延遲時間：若確定超過天數導致要執行調度工作了，那麼請延遲執行的時間，因為擔心立即啟動會有其他資源衝突的問題吧！</li>
<li>工作名稱定義：這個沒啥意義，就只是會在 /var/log/cron 裡頭記載該項任務的名稱這樣！通常與後續的目錄資源名稱相同即可。</li>
<li>實際要進行的指令串：有沒有跟 0hourly 很像啊！沒錯！相同的作法啊！通過 run-parts 來處理的！</li>
</ul>
<p><br></p>
<h4 id="anacron-的執行流程-以-cron-daily-為例"><a href="#anacron-的執行流程-以-cron-daily-為例" class="headerlink" title="anacron 的執行流程(以 cron.daily 為例)"></a>anacron 的執行流程(以 cron.daily 為例)</h4><ol>
<li>由 /etc/anacrontab 分析到 cron.daily 這項工作名稱的天數為 1 天；</li>
<li>由 /var/spool/anacron/cron.daily 取出最近一次執行 anacron 的時間戳記；</li>
<li>由上個步驟與目前的時間比較，若差異天數為 1 天以上 (含 1 天)，就準備進行指令；</li>
<li>若準備進行指令，根據 /etc/anacrontab 的設置，將延遲 5 分鐘 + 3 小時 (看 START_HOURS_RANGE 的設置)；</li>
<li>延遲時間過後，開始執行後續指令，亦即“ run-parts /etc/cron.daily ”這串指令；<br>執行完畢後， anacron 程序結束。</li>
</ol>
<p>如此一來，放置在 /etc/cron.daily/ 內的任務就會在一天後一定會被執行的！</p>
<p>因為 anacron 是每個小時被執行一次嘛！ 所以如果隔了一陣子將 CentOS 開機，開機過後約 1 小時左右系統會有一小段時間的忙碌！硬盤會跑個不停！那就是因為 anacron 正在執行過去 /etc/cron.daily/, /etc/cron.weekly/, /etc/cron.monthly/ 裡頭的未進行的各項工作調度</p>
<p><br></p>
<h3 id="cron-與-anacron-與目錄之間的關係"><a href="#cron-與-anacron-與目錄之間的關係" class="headerlink" title="cron 與 anacron 與目錄之間的關係"></a>cron 與 anacron 與目錄之間的關係</h3><ul>
<li>crond 會主動去讀取 /etc/crontab, /var/spool/cron/<em>, /etc/cron.d/</em> 等配置文件，並依據“分、時、日、月、周”的時間設置去各項工作調度；</li>
<li>根據 /etc/cron.d/0hourly 的設置，主動去 /etc/cron.hourly/ 目錄下，執行所有在該目錄下的可執行文件；</li>
<li>因為 /etc/cron.hourly/0anacron 這個指令檔的緣故，主動的每小時執行 anacron ，並調用 /etc/anacrontab 的配置文件；</li>
<li>根據 /etc/anacrontab 的設置，依據每天、每週、每月去分析 /etc/cron.daily/, /etc/cron.weekly/, /etc/cron.monthly/ 內的可執行文件，以進行固定週期需要執行的指令。</li>
<li>如果你每個週日的需要執行的動作是放置於 /etc/crontab 的話，那麼該動作只要過期了就過期了，並不會被抓回來重新執行。</li>
<li>如果是放置在 /etc/cron.weekly/ 目錄下，那麼該工作就會定期，幾乎一定會在一週內執行一次</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><table>
<thead>
<tr>
<th>測試的標誌</th>
<th>代表意義</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><b>1. 關於某個文件名的“文件類型”判斷，如 test -e filename 表示存在否</b></td>
</tr>
<tr>
<td>-e</td>
<td>該“文件名”是否存在？(常用)</td>
</tr>
<tr>
<td>-f</td>
<td>該“文件名”是否存在且為文件(file)？(常用)</td>
</tr>
<tr>
<td>-d</td>
<td>該“文件名”是否存在且為目錄(directory)？(常用)</td>
</tr>
<tr>
<td>-b</td>
<td>該“文件名”是否存在且為一個 block device 設備？</td>
</tr>
<tr>
<td>-c</td>
<td>該“文件名”是否存在且為一個 character device 設備？</td>
</tr>
<tr>
<td>-S</td>
<td>該“文件名”是否存在且為一個 Socket 文件？</td>
</tr>
<tr>
<td>-p</td>
<td>該“文件名”是否存在且為一個 FIFO (pipe) 文件？</td>
</tr>
<tr>
<td>-L</td>
<td>該“文件名”是否存在且為一個鏈接文件？</td>
</tr>
<tr>
<td></td>
<td><b>2. 關於文件的權限偵測，如 test -r filename 表示可讀否 (但 root 權限常有例外)</b></td>
</tr>
<tr>
<td>-r</td>
<td>偵測該文件名是否存在且具有“可讀”的權限？</td>
</tr>
<tr>
<td>-w</td>
<td>偵測該文件名是否存在且具有“可寫”的權限？</td>
</tr>
<tr>
<td>-x</td>
<td>偵測該文件名是否存在且具有“可執行”的權限？</td>
</tr>
<tr>
<td>-u</td>
<td>偵測該文件名是否存在且具有“SUID”的屬性？</td>
</tr>
<tr>
<td>-g</td>
<td>偵測該文件名是否存在且具有“SGID”的屬性？</td>
</tr>
<tr>
<td>-k</td>
<td>偵測該文件名是否存在且具有“Sticky bit”的屬性？</td>
</tr>
<tr>
<td>-s</td>
<td>偵測該文件名是否存在且為“非空白文件”？</td>
</tr>
<tr>
<td></td>
<td><b>3. 兩個文件之間的比較，如： test file1 -nt file2</b></td>
</tr>
<tr>
<td>-nt</td>
<td>(newer than)判斷 file1 是否比 file2 新</td>
</tr>
<tr>
<td>-ot</td>
<td>(older than)判斷 file1 是否比 file2 舊</td>
</tr>
<tr>
<td>-ef</td>
<td>判斷 file1 與 file2 是否為同一文件，可用在判斷 hard link 的判定上。 主要意義在判定，兩個文件是否均指向同一個 inode 哩！</td>
</tr>
<tr>
<td></td>
<td><b>4. 關於兩個整數之間的判定，例如 test n1 -eq n2</b></td>
</tr>
<tr>
<td>-eq</td>
<td>兩數值相等 (equal)</td>
</tr>
<tr>
<td>-ne</td>
<td>兩數值不等 (not equal)</td>
</tr>
<tr>
<td>-gt</td>
<td>n1 大於 n2 (greater than)</td>
</tr>
<tr>
<td>-lt</td>
<td>n1 小於 n2 (less than)</td>
</tr>
<tr>
<td>-ge</td>
<td>n1 大於等於 n2 (greater than or equal)</td>
</tr>
<tr>
<td>-le</td>
<td>n1 小於等於 n2 (less than or equal)</td>
</tr>
<tr>
<td></td>
<td><b>5. 判定字串的數據</b></td>
</tr>
<tr>
<td>test -z</td>
<td>string    判定字串是否為 0 ？若 string 為空字串，則為 true</td>
</tr>
<tr>
<td>test -n</td>
<td>string    判定字串是否非為 0 ？若 string 為空字串，則為 false。 -n 亦可省略</td>
</tr>
<tr>
<td>test str1 == str2</td>
<td>判定 str1 是否等於 str2 ，若相等，則回傳 true</td>
</tr>
<tr>
<td>test str1 != str2</td>
<td>判定 str1 是否不等於 str2 ，若相等，則回傳 false</td>
</tr>
<tr>
<td></td>
<td><b>6. 多重條件判定，例如： test -r filename -a -x filename</b></td>
</tr>
<tr>
<td>-a</td>
<td>(and)兩狀況同時成立！例如 test -r file -a -x file，則 file 同時具有 r 與 x 權限時，才回傳 true。</td>
</tr>
<tr>
<td>-o</td>
<td>(or)兩狀況任何一個成立！例如 test -r file -o -x file，則 file 具有 r 或 x 權限時，就可回傳 true。</td>
</tr>
<tr>
<td>!</td>
<td>反相狀態，如 test ! -x file ，當 file 不具有 x 時，回傳 true</td>
</tr>
</tbody>
</table>
<p><br><br><br><br><br></p>
<h2 id="變量"><a href="#變量" class="headerlink" title="變量"></a>變量</h2><h3 id="變量的設置"><a href="#變量的設置" class="headerlink" title="變量的設置"></a>變量的設置</h3><table>
<thead>
<tr>
<th>變量設置方式</th>
<th>str 沒有設置</th>
<th>str 為空字串</th>
<th>str 已設置非為空字串</th>
</tr>
</thead>
<tbody>
<tr>
<td>var=${str-expr}</td>
<td>var=expr</td>
<td>var=</td>
<td>var=$str</td>
</tr>
<tr>
<td>var=${str:-expr}</td>
<td>var=expr</td>
<td>var=expr</td>
<td>var=$str</td>
</tr>
<tr>
<td>var=${str+expr}</td>
<td>var=</td>
<td>var=expr</td>
<td>var=expr</td>
</tr>
<tr>
<td>var=${str:+expr}</td>
<td>var=</td>
<td>var=</td>
<td>var=expr</td>
</tr>
<tr>
<td>var=${str=expr}</td>
<td>str=expr <br> var=expr</td>
<td>var=expr <br> var=</td>
<td>str 不變 <br> var=$str</td>
</tr>
<tr>
<td>var=${str:=expr}</td>
<td>str=expr <br> var=expr</td>
<td>str=expr <br> var=expr</td>
<td>str 不變 <br> var=$str</td>
</tr>
<tr>
<td>var=${str?expr}</td>
<td>expr 輸出至 stderr</td>
<td>var=</td>
<td>var=$str</td>
</tr>
<tr>
<td>var=${str:?expr}</td>
<td>expr 輸出至 stderr</td>
<td>expr 輸出至 stderr</td>
<td>var=$str</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="Script-變量帶入規則："><a href="#Script-變量帶入規則：" class="headerlink" title="Script 變量帶入規則："></a>Script 變量帶入規則：</h3><table>
<thead>
<tr>
<th>script 名稱，如 <code>/path/to/scriptname</code></th>
<th>opt1</th>
<th>opt2</th>
<th>opt3</th>
<th>opt4 </th>
</tr>
</thead>
<tbody>
<tr>
<td>       $0</td>
<td>$1</td>
<td>$2</td>
<td>$3</td>
<td>$4</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="可以在-script-裡面使用的特殊變量"><a href="#可以在-script-裡面使用的特殊變量" class="headerlink" title="可以在 script 裡面使用的特殊變量"></a>可以在 script 裡面使用的特殊變量</h3><p><code>$#</code> ：代表後接的參數“個數”，以上表為例這裡顯示為“ 4 ”；<br><code>$@</code> ：代表“ “$1” “$2” “$3” “$4” ”之意，每個變量是獨立的(用雙引號括起來)；<br><code>$*</code> ：代表“ “$1c$2c$3c$4” ”，其中 c 為分隔字符，默認為空白鍵， 所以本例中代表“ “$1 $2 $3 $4” ”之意。</p>
<p><br><br><br><br><br></p>
<h2 id="條件判斷"><a href="#條件判斷" class="headerlink" title="條件判斷"></a>條件判斷</h2><h3 id="單一判斷式"><a href="#單一判斷式" class="headerlink" title="單一判斷式"></a>單一判斷式</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">if [ 條件判斷式 ]; then</span><br><span class="line">	當條件判斷式成立時，可以進行的指令工作內容；</span><br><span class="line">fi   &lt;==將 if 反過來寫，就成為 fi 啦！結束 if 之意！</span><br></pre></td></tr></table></figure>
<ul>
<li>以下 test 的方式可改編成<code>條件判斷式</code></li>
</ul>
<p>test 方式<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input (Y/N): "</span> yn</span><br><span class="line">[ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"Y"</span> -o <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"y"</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"OK, continue"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 0</span><br><span class="line">[ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"N"</span> -o <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"n"</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"Oh, interrupt!"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 0</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"I don't know what your choice is"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 0</span><br></pre></td></tr></table></figure></p>
<p>條件判斷式<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input (Y/N): "</span> yn</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"Y"</span> ] || [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"y"</span> ]; <span class="hljs-keyword">then</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"OK, continue"</span></span><br><span class="line">	<span class="hljs-built_in">exit</span> 0</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"N"</span> ] || [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"n"</span> ]; <span class="hljs-keyword">then</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Oh, interrupt!"</span></span><br><span class="line">	<span class="hljs-built_in">exit</span> 0</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"I don't know what your choice is"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 0</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="多重、複雜條件判斷式"><a href="#多重、複雜條件判斷式" class="headerlink" title="多重、複雜條件判斷式"></a>多重、複雜條件判斷式</h3><h4 id="一個條件判斷，分成功進行與失敗進行-else"><a href="#一個條件判斷，分成功進行與失敗進行-else" class="headerlink" title="一個條件判斷，分成功進行與失敗進行 (else)"></a>一個條件判斷，分成功進行與失敗進行 (else)</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">if [ 條件判斷式 ]; then</span><br><span class="line">	當條件判斷式成立時，可以進行的指令工作內容；</span><br><span class="line">else</span><br><span class="line">	當條件判斷式不成立時，可以進行的指令工作內容；</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="多個條件判斷-if-…-elif-…-elif-…-else-分多種不同情況執行"><a href="#多個條件判斷-if-…-elif-…-elif-…-else-分多種不同情況執行" class="headerlink" title="多個條件判斷 (if … elif … elif … else) 分多種不同情況執行"></a>多個條件判斷 (if … elif … elif … else) 分多種不同情況執行</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">if [ 條件判斷式一 ]; then</span><br><span class="line">	當條件判斷式一成立時，可以進行的指令工作內容；</span><br><span class="line">elif [ 條件判斷式二 ]; then</span><br><span class="line">	當條件判斷式二成立時，可以進行的指令工作內容；</span><br><span class="line">else</span><br><span class="line">	當條件判斷式一與二均不成立時，可以進行的指令工作內容；</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<ul>
<li>將以下的 test 方式改成條件判斷式</li>
</ul>
<p>改前:<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input (Y/N): "</span> yn</span><br><span class="line">[ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"Y"</span> -o <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"y"</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"OK, continue"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 0</span><br><span class="line">[ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"N"</span> -o <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"n"</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"Oh, interrupt!"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 0</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"I don't know what your choice is"</span> &amp;&amp; <span class="hljs-built_in">exit</span> 0</span><br></pre></td></tr></table></figure></p>
<p>改後:<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment">#       This program shows the user's choice</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/16    VBird   First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input (Y/N): "</span> yn</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"Y"</span> ] || [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"y"</span> ]; <span class="hljs-keyword">then</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"OK, continue"</span></span><br><span class="line"><span class="hljs-keyword">elif</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"N"</span> ] || [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"n"</span> ]; <span class="hljs-keyword">then</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Oh, interrupt!"</span></span><br><span class="line"><span class="hljs-keyword">else</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"I don't know what your choice is"</span></span><br><span class="line"><span class="hljs-keyword">fi</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="利用-case-…-esac-判斷"><a href="#利用-case-…-esac-判斷" class="headerlink" title="利用 case ….. esac 判斷"></a>利用 case ….. esac 判斷</h3><ul>
<li>語法：</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">case  $變量名稱 in   &lt;==關鍵字為 case ，還有變量前有錢字號</span><br><span class="line">  &quot;第一個變量內容&quot;)   &lt;==每個變量內容建議用雙引號括起來，關鍵字則為小括號 )</span><br><span class="line">	程序段</span><br><span class="line">	;;            &lt;==每個類別結尾使用兩個連續的分號來處理！</span><br><span class="line">  &quot;第二個變量內容&quot;)</span><br><span class="line">	程序段</span><br><span class="line">	;;</span><br><span class="line">  *)                  &lt;==最後一個變量內容都會用 * 來代表所有其他值</span><br><span class="line">	不包含第一個變量內容與第二個變量內容的其他程序執行段</span><br><span class="line">	exit 1</span><br><span class="line">	;;</span><br><span class="line">esac                  &lt;==最終的 case 結尾！“反過來寫”思考一下！</span><br></pre></td></tr></table></figure>
<ul>
<li>範例：</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment"># 	Show "Hello" from $1.... by using case .... esac</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/16	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">case</span> <span class="hljs-variable">$&#123;1&#125;</span> <span class="hljs-keyword">in</span></span><br><span class="line">  <span class="hljs-string">"hello"</span>)</span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello, how are you ?"</span></span><br><span class="line">	;;</span><br><span class="line">  <span class="hljs-string">""</span>)</span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"You MUST input parameters, ex&gt; &#123;<span class="hljs-variable">$&#123;0&#125;</span> someword&#125;"</span></span><br><span class="line">	;;</span><br><span class="line">  *)   <span class="hljs-comment"># 其實就相當於萬用字符，0~無窮多個任意字符之意！</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage <span class="hljs-variable">$&#123;0&#125;</span> &#123;hello&#125;"</span></span><br><span class="line">	;;</span><br><span class="line"><span class="hljs-keyword">esac</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="練習題"><a href="#練習題" class="headerlink" title="練習題"></a>練習題</h3><p>使用判斷式寫一個 script, 要可以做到以下幾件事：</p>
<ul>
<li>先讓使用者輸入他們的退伍日期；</li>
<li>驗證輸入格式；</li>
<li>由兩個日期的比較來顯示“還需要幾天”才能夠退伍的字樣。</li>
</ul>
<p>解答如下：<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment">#	You input your demobilization date, I calculate how many days before you demobilize.</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/16	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 1. 告知使用者這支程序的用途，並且告知應該如何輸入日期格式？</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"This program will try to calculate :"</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"How many days before your demobilization date..."</span></span><br><span class="line"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input your demobilization date (YYYYMMDD ex&gt;20150716): "</span> date2</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 2. 測試一下，這個輸入的內容是否正確？利用正則表達式囉～</span></span><br><span class="line">date_d=$(<span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;date2&#125;</span> |grep <span class="hljs-string">'[0-9]\&#123;8\&#125;'</span>)   <span class="hljs-comment"># 看看是否有八個數字</span></span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;date_d&#125;</span>"</span> == <span class="hljs-string">""</span> ]; <span class="hljs-keyword">then</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"You input the wrong date format...."</span></span><br><span class="line">	<span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 3. 開始計算日期囉～</span></span><br><span class="line"><span class="hljs-built_in">declare</span> -i date_dem=$(date --date=<span class="hljs-string">"<span class="hljs-variable">$&#123;date2&#125;</span>"</span> +%s)      <span class="hljs-comment"># 退伍日期秒數</span></span><br><span class="line"><span class="hljs-built_in">declare</span> -i date_now=$(date +%s)                        <span class="hljs-comment"># 現在日期秒數</span></span><br><span class="line"><span class="hljs-built_in">declare</span> -i date_total_s=$((<span class="hljs-variable">$&#123;date_dem&#125;</span>-<span class="hljs-variable">$&#123;date_now&#125;</span>))   <span class="hljs-comment"># 剩餘秒數統計</span></span><br><span class="line"><span class="hljs-built_in">declare</span> -i date_d=$((<span class="hljs-variable">$&#123;date_total_s&#125;</span>/60/60/24))        <span class="hljs-comment"># 轉為日數</span></span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;date_total_s&#125;</span>"</span> -lt <span class="hljs-string">"0"</span> ]; <span class="hljs-keyword">then</span>                 <span class="hljs-comment"># 判斷是否已退伍</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"You had been demobilization before: "</span> $((-1*<span class="hljs-variable">$&#123;date_d&#125;</span>)) <span class="hljs-string">" ago"</span></span><br><span class="line"><span class="hljs-keyword">else</span></span><br><span class="line">	<span class="hljs-built_in">declare</span> -i date_h=$(($((<span class="hljs-variable">$&#123;date_total_s&#125;</span>-<span class="hljs-variable">$&#123;date_d&#125;</span>*60*60*24))/60/60))</span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"You will demobilize after <span class="hljs-variable">$&#123;date_d&#125;</span> days and <span class="hljs-variable">$&#123;date_h&#125;</span> hours."</span></span><br><span class="line"><span class="hljs-keyword">fi</span></span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<h2 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h2><p>這個指令可以看到目前有哪些 port 是對外開放的, 有哪些是 Listen 的</p>
<h3 id="語法-4"><a href="#語法-4" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">netstat -[atunlp]</span><br><span class="line">選項與參數：</span><br><span class="line">-a  ：將目前系統上所有的連線、監聽、Socket 數據都列出來</span><br><span class="line">-t  ：列出 tcp 網絡封包的數據</span><br><span class="line">-u  ：列出 udp 網絡封包的數據</span><br><span class="line">-n  ：不以程序的服務名稱，以埠號 (port number) 來顯示；</span><br><span class="line">-l  ：列出目前正在網絡監聽 (listen) 的服務；</span><br><span class="line">-p  ：列出該網絡服務的程序 PID</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="function"><a href="#function" class="headerlink" title="function"></a>function</h2><h3 id="語法："><a href="#語法：" class="headerlink" title="語法："></a>語法：</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">function fname() &#123;</span><br><span class="line">	程序段</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h3><ul>
<li>因為 shell script 的執行方式是由上而下，由左而右， 因此在 shell script 當中的 function 的設置一定要在程序的最前面</li>
<li>function 內也可置變量，但跟 shell script 的內置變量方式不同</li>
</ul>
<p><br></p>
<h3 id="範例："><a href="#範例：" class="headerlink" title="範例："></a>範例：</h3><ul>
<li>一般</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment">#	Use function to repeat information.</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">printit</span></span>()&#123;</span><br><span class="line">	<span class="hljs-built_in">echo</span> -n <span class="hljs-string">"Your choice is "</span>     <span class="hljs-comment"># 加上 -n 可以不斷行繼續在同一行顯示</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"This program will print your selection !"</span></span><br><span class="line"><span class="hljs-keyword">case</span> <span class="hljs-variable">$&#123;1&#125;</span> <span class="hljs-keyword">in</span></span><br><span class="line">  <span class="hljs-string">"one"</span>)</span><br><span class="line">	printit; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;1&#125;</span> | tr <span class="hljs-string">'a-z'</span> <span class="hljs-string">'A-Z'</span>  <span class="hljs-comment"># 將參數做大小寫轉換！</span></span><br><span class="line">	;;</span><br><span class="line">  <span class="hljs-string">"two"</span>)</span><br><span class="line">	printit; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;1&#125;</span> | tr <span class="hljs-string">'a-z'</span> <span class="hljs-string">'A-Z'</span></span><br><span class="line">	;;</span><br><span class="line">  <span class="hljs-string">"three"</span>)</span><br><span class="line">	printit; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;1&#125;</span> | tr <span class="hljs-string">'a-z'</span> <span class="hljs-string">'A-Z'</span></span><br><span class="line">	;;</span><br><span class="line">  *)</span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage <span class="hljs-variable">$&#123;0&#125;</span> &#123;one|two|three&#125;"</span></span><br><span class="line">	;;</span><br><span class="line"><span class="hljs-keyword">esac</span></span><br></pre></td></tr></table></figure>
<ul>
<li>內置變量<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment">#	Use function to repeat information.</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">function</span> <span class="hljs-function"><span class="hljs-title">printit</span></span>()&#123;</span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Your choice is <span class="hljs-variable">$&#123;1&#125;</span>"</span>   <span class="hljs-comment"># 這個 $1 必須要參考下面指令的下達</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"This program will print your selection !"</span></span><br><span class="line"><span class="hljs-keyword">case</span> <span class="hljs-variable">$&#123;1&#125;</span> <span class="hljs-keyword">in</span></span><br><span class="line">  <span class="hljs-string">"one"</span>)</span><br><span class="line">	printit 1  <span class="hljs-comment"># 請注意， printit 指令後面還有接參數！</span></span><br><span class="line">	;;</span><br><span class="line">  <span class="hljs-string">"two"</span>)</span><br><span class="line">	printit 2</span><br><span class="line">	;;</span><br><span class="line">  <span class="hljs-string">"three"</span>)</span><br><span class="line">	printit 3</span><br><span class="line">	;;</span><br><span class="line">  *)</span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage <span class="hljs-variable">$&#123;0&#125;</span> &#123;one|two|three&#125;"</span></span><br><span class="line">	;;</span><br><span class="line"><span class="hljs-keyword">esac</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="loop"><a href="#loop" class="headerlink" title="loop"></a>loop</h2><h3 id="while-do-done-until-do-done-不定循環"><a href="#while-do-done-until-do-done-不定循環" class="headerlink" title="while do done, until do done (不定循環)"></a>while do done, until do done (不定循環)</h3><h4 id="while-do-done"><a href="#while-do-done" class="headerlink" title="while do done"></a>while do done</h4><h5 id="語法-5"><a href="#語法-5" class="headerlink" title="語法"></a>語法</h5><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">while [ condition ]  &lt;==中括號內的狀態就是判斷式</span><br><span class="line">do            &lt;==do 是循環的開始！</span><br><span class="line">	程序段落</span><br><span class="line">done          &lt;==done 是循環的結束</span><br></pre></td></tr></table></figure>
<p><br></p>
<h5 id="範例-2"><a href="#範例-2" class="headerlink" title="範例"></a>範例</h5><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment">#	Repeat question until user input correct answer.</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">while</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> != <span class="hljs-string">"yes"</span> -a <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> != <span class="hljs-string">"YES"</span> ]</span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">	<span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input yes/YES to stop this program: "</span> yn</span><br><span class="line"><span class="hljs-keyword">done</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"OK! you input the correct answer."</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment">#	Use loop to calculate "1+2+3+...+100" result.</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line">s=0  <span class="hljs-comment"># 這是加總的數值變量</span></span><br><span class="line">i=0  <span class="hljs-comment"># 這是累計的數值，亦即是 1, 2, 3....</span></span><br><span class="line"><span class="hljs-keyword">while</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;i&#125;</span>"</span> != <span class="hljs-string">"100"</span> ]</span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">	i=$((<span class="hljs-variable">$i</span>+1))   <span class="hljs-comment"># 每次 i 都會增加 1 </span></span><br><span class="line">	s=$((<span class="hljs-variable">$s</span>+<span class="hljs-variable">$i</span>))  <span class="hljs-comment"># 每次都會加總一次！</span></span><br><span class="line"><span class="hljs-keyword">done</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"The result of '1+2+3+...+100' is ==&gt; <span class="hljs-variable">$s</span>"</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="until-do-done"><a href="#until-do-done" class="headerlink" title="until do done"></a>until do done</h4><h5 id="語法-6"><a href="#語法-6" class="headerlink" title="語法"></a>語法</h5><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">until [ condition ]</span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">	程序段落</span><br><span class="line"><span class="hljs-keyword">done</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h5 id="範例-3"><a href="#範例-3" class="headerlink" title="範例"></a>範例</h5><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment">#	Repeat question until user input correct answer.</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line">until [ <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"yes"</span> -o <span class="hljs-string">"<span class="hljs-variable">$&#123;yn&#125;</span>"</span> == <span class="hljs-string">"YES"</span> ]</span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">	<span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input yes/YES to stop this program: "</span> yn</span><br><span class="line"><span class="hljs-keyword">done</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"OK! you input the correct answer."</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="for…do…done-固定循環"><a href="#for…do…done-固定循環" class="headerlink" title="for…do…done (固定循環)"></a>for…do…done (固定循環)</h3><h4 id="語法-7"><a href="#語法-7" class="headerlink" title="語法"></a>語法</h4><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> con1 con2 con3 ...</span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">	程序段</span><br><span class="line"><span class="hljs-keyword">done</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="範例-4"><a href="#範例-4" class="headerlink" title="範例"></a>範例</h4><ul>
<li>假設我有三種動物，分別是 dog, cat, elephant 三種， 我想每一行都輸出這樣：“There are dogs…”之類的字樣，則可以：</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment"># 	Using for .... loop to print 3 animals</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">for</span> animal <span class="hljs-keyword">in</span> dog cat elephant</span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"There are <span class="hljs-variable">$&#123;animal&#125;</span>s.... "</span></span><br><span class="line"><span class="hljs-keyword">done</span></span><br></pre></td></tr></table></figure>
<ul>
<li>系統上面的各種帳號都是寫在 /etc/passwd 內的第一個字段，所以請通過管線命令的 cut 捉出單純的帳號名稱後，以 id 分別檢查使用者的識別碼與特殊參數</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program</span></span><br><span class="line"><span class="hljs-comment">#       Use id, finger command to check system account's information.</span></span><br><span class="line"><span class="hljs-comment"># History</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17    VBird   first release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line">users=$(cut -d <span class="hljs-string">':'</span> -f1 /etc/passwd)    <span class="hljs-comment"># 擷取帳號名稱</span></span><br><span class="line"><span class="hljs-keyword">for</span> username <span class="hljs-keyword">in</span> <span class="hljs-variable">$&#123;users&#125;</span>               <span class="hljs-comment"># 開始循環進行！</span></span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">        id <span class="hljs-variable">$&#123;username&#125;</span></span><br><span class="line"><span class="hljs-keyword">done</span></span><br></pre></td></tr></table></figure>
<ul>
<li>讓使用者輸入某個目錄文件名， 然後我找出某目錄內的文件名的權限</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment">#	User input dir name, I find the permission of files.</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 1. 先看看這個目錄是否存在啊？</span></span><br><span class="line"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input a directory: "</span> dir</span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;dir&#125;</span>"</span> == <span class="hljs-string">""</span> -o ! -d <span class="hljs-string">"<span class="hljs-variable">$&#123;dir&#125;</span>"</span> ]; <span class="hljs-keyword">then</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"The <span class="hljs-variable">$&#123;dir&#125;</span> is NOT exist in your system."</span></span><br><span class="line">	<span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># 2. 開始測試文件囉～</span></span><br><span class="line">filelist=$(ls <span class="hljs-variable">$&#123;dir&#125;</span>)        <span class="hljs-comment"># 列出所有在該目錄下的文件名稱</span></span><br><span class="line"><span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> <span class="hljs-variable">$&#123;filelist&#125;</span></span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">	perm=<span class="hljs-string">""</span></span><br><span class="line">	<span class="hljs-built_in">test</span> -r <span class="hljs-string">"<span class="hljs-variable">$&#123;dir&#125;</span>/<span class="hljs-variable">$&#123;filename&#125;</span>"</span> &amp;&amp; perm=<span class="hljs-string">"<span class="hljs-variable">$&#123;perm&#125;</span> readable"</span></span><br><span class="line">	<span class="hljs-built_in">test</span> -w <span class="hljs-string">"<span class="hljs-variable">$&#123;dir&#125;</span>/<span class="hljs-variable">$&#123;filename&#125;</span>"</span> &amp;&amp; perm=<span class="hljs-string">"<span class="hljs-variable">$&#123;perm&#125;</span> writable"</span></span><br><span class="line">	<span class="hljs-built_in">test</span> -x <span class="hljs-string">"<span class="hljs-variable">$&#123;dir&#125;</span>/<span class="hljs-variable">$&#123;filename&#125;</span>"</span> &amp;&amp; perm=<span class="hljs-string">"<span class="hljs-variable">$&#123;perm&#125;</span> executable"</span></span><br><span class="line">	<span class="hljs-built_in">echo</span> <span class="hljs-string">"The file <span class="hljs-variable">$&#123;dir&#125;</span>/<span class="hljs-variable">$&#123;filename&#125;</span>'s permission is <span class="hljs-variable">$&#123;perm&#125;</span> "</span></span><br><span class="line"><span class="hljs-keyword">done</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="for…do…done-的數值處理"><a href="#for…do…done-的數值處理" class="headerlink" title="for…do…done 的數值處理"></a>for…do…done 的數值處理</h3><h4 id="語法-8"><a href="#語法-8" class="headerlink" title="語法"></a>語法</h4><pre><code>- 初始值：某個變量在循環當中的起始值，直接以類似 i=1 設置好；
- 限制值：當變量的值在這個限制值的範圍內，就繼續進行循環。例如 i&lt;=100；
- 執行步階：每作一次循環時，變量的變化量。例如 i=i+1。
</code></pre><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">for (( 初始值; 限制值; 執行步階 ))</span><br><span class="line">do</span><br><span class="line">	程序段</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<ul>
<li>範例</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment"># 	Try do calculate 1+2+....+$&#123;your_input&#125;</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input a number, I will count for 1+2+...+your_input: "</span> nu</span><br><span class="line"></span><br><span class="line">s=0</span><br><span class="line"><span class="hljs-keyword">for</span> (( i=1; i&lt;=<span class="hljs-variable">$&#123;nu&#125;</span>; i=i+1 ))</span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">	s=$((<span class="hljs-variable">$&#123;s&#125;</span>+<span class="hljs-variable">$&#123;i&#125;</span>))</span><br><span class="line"><span class="hljs-keyword">done</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"The result of '1+2+3+...+<span class="hljs-variable">$&#123;nu&#125;</span>' is ==&gt; <span class="hljs-variable">$&#123;s&#125;</span>"</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="搭配亂數與陣列的實驗"><a href="#搭配亂數與陣列的實驗" class="headerlink" title="搭配亂數與陣列的實驗"></a>搭配亂數與陣列的實驗</h3><h4 id="範例-5"><a href="#範例-5" class="headerlink" title="範例"></a>範例</h4><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment"># 	Try do tell you what you may eat.</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line">eat[1]=<span class="hljs-string">"賣噹噹漢堡包"</span></span><br><span class="line">eat[2]=<span class="hljs-string">"肯爺爺炸雞"</span></span><br><span class="line">eat[3]=<span class="hljs-string">"彩虹日式便當"</span></span><br><span class="line">eat[4]=<span class="hljs-string">"越油越好吃大雅"</span></span><br><span class="line">eat[5]=<span class="hljs-string">"想不出吃啥學餐"</span></span><br><span class="line">eat[6]=<span class="hljs-string">"太師父便當"</span></span><br><span class="line">eat[7]=<span class="hljs-string">"池上便當"</span></span><br><span class="line">eat[8]=<span class="hljs-string">"懷念火車便當"</span></span><br><span class="line">eat[9]=<span class="hljs-string">"一起吃方便麵"</span></span><br><span class="line">eatnum=9</span><br><span class="line"></span><br><span class="line">eated=0</span><br><span class="line"><span class="hljs-keyword">while</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;eated&#125;</span>"</span> -lt 3 ]; <span class="hljs-keyword">do</span></span><br><span class="line">        check=$(( <span class="hljs-variable">$&#123;RANDOM&#125;</span> * <span class="hljs-variable">$&#123;eatnum&#125;</span> / 32767 + 1 ))</span><br><span class="line">        mycheck=0</span><br><span class="line">        <span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$&#123;eated&#125;</span>"</span> -ge 1 ]; <span class="hljs-keyword">then</span></span><br><span class="line">                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(seq 1 <span class="hljs-variable">$&#123;eated&#125;</span> )</span><br><span class="line">                <span class="hljs-keyword">do</span></span><br><span class="line">                        <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$&#123;eatedcon[$i]&#125;</span> == <span class="hljs-variable">$check</span> ]; <span class="hljs-keyword">then</span></span><br><span class="line">                                mycheck=1</span><br><span class="line">                        <span class="hljs-keyword">fi</span></span><br><span class="line">                <span class="hljs-keyword">done</span></span><br><span class="line">        <span class="hljs-keyword">fi</span></span><br><span class="line">        <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$&#123;mycheck&#125;</span> == 0 ]; <span class="hljs-keyword">then</span></span><br><span class="line">                <span class="hljs-built_in">echo</span> <span class="hljs-string">"your may eat <span class="hljs-variable">$&#123;eat[$&#123;check&#125;</span>]&#125;"</span></span><br><span class="line">                eated=$(( <span class="hljs-variable">$&#123;eated&#125;</span> + 1 ))</span><br><span class="line">                eatedcon[<span class="hljs-variable">$&#123;eated&#125;</span>]=<span class="hljs-variable">$&#123;check&#125;</span></span><br><span class="line">        <span class="hljs-keyword">fi</span></span><br><span class="line"><span class="hljs-keyword">done</span></span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-comment"># Program:</span></span><br><span class="line"><span class="hljs-comment"># 	Try do tell you what you may eat.</span></span><br><span class="line"><span class="hljs-comment"># History:</span></span><br><span class="line"><span class="hljs-comment"># 2015/07/17	VBird	First release</span></span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/<span class="hljs-built_in">local</span>/bin:/usr/<span class="hljs-built_in">local</span>/sbin:~/bin</span><br><span class="line"><span class="hljs-built_in">export</span> PATH</span><br><span class="line"></span><br><span class="line">eat[1]=<span class="hljs-string">"賣噹噹漢堡包"</span>       <span class="hljs-comment"># 寫下你所收集到的店家！</span></span><br><span class="line">eat[2]=<span class="hljs-string">"肯爺爺炸雞"</span></span><br><span class="line">eat[3]=<span class="hljs-string">"彩虹日式便當"</span></span><br><span class="line">eat[4]=<span class="hljs-string">"越油越好吃大雅"</span></span><br><span class="line">eat[5]=<span class="hljs-string">"想不出吃啥學餐"</span></span><br><span class="line">eat[6]=<span class="hljs-string">"太師父便當"</span></span><br><span class="line">eat[7]=<span class="hljs-string">"池上便當"</span></span><br><span class="line">eat[8]=<span class="hljs-string">"懷念火車便當"</span></span><br><span class="line">eat[9]=<span class="hljs-string">"一起吃方便麵"</span></span><br><span class="line">eatnum=9                  <span class="hljs-comment"># 需要輸入有幾個可用的餐廳數！</span></span><br><span class="line"></span><br><span class="line">check=$(( <span class="hljs-variable">$&#123;RANDOM&#125;</span> * <span class="hljs-variable">$&#123;eatnum&#125;</span> / 32767 + 1 ))</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"your may eat <span class="hljs-variable">$&#123;eat[$&#123;check&#125;</span>]&#125;"</span></span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="loop-array"><a href="#loop-array" class="headerlink" title="loop array"></a>loop array</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">for i in &quot;$&#123;array[@]&#125;&quot;</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="shell-script-的追蹤與-debug"><a href="#shell-script-的追蹤與-debug" class="headerlink" title="shell script 的追蹤與 debug"></a>shell script 的追蹤與 debug</h2><h3 id="語法-9"><a href="#語法-9" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">sh [-nvx] scripts.sh</span><br><span class="line">選項與參數：</span><br><span class="line">-n  ：不要執行 script，僅查詢語法的問題；</span><br><span class="line">-v  ：再執行 sccript 前，先將 scripts 的內容輸出到屏幕上；</span><br><span class="line">-x  ：將使用到的 script 內容顯示到屏幕上，這是很有用的參數！</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-6"><a href="#範例-6" class="headerlink" title="範例"></a>範例</h3><ul>
<li>測試 dir_perm.sh 有無語法的問題？</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">sh -n dir_perm.sh</span><br></pre></td></tr></table></figure>
<ul>
<li>將 show_animal.sh 的執行過程全部列出來～</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">sh -x show_animal.sh</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="練習題-1"><a href="#練習題-1" class="headerlink" title="練習題"></a>練習題</h2><ol>
<li>請創建一支 script ，當你執行該 script 的時候，該 script 可以顯示： 1. 你目前的身份 (用 whoami ) 2. 你目前所在的目錄 (用 pwd)</li>
</ol>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">"Your name is ==&gt; <span class="hljs-variable">$(whoami)</span>"</span></span><br><span class="line"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">"The current directory is ==&gt; <span class="hljs-variable">$(pwd)</span>"</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>請自行創建一支程序，該程序可以用來計算“你還有幾天可以過生日”啊？</li>
</ol>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Pleas input your birthday (MMDD, ex&gt; 0709): "</span> bir</span><br><span class="line">now=`date +%m%d`</span><br><span class="line"><span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$bir</span>"</span> == <span class="hljs-string">"<span class="hljs-variable">$now</span>"</span> ]; <span class="hljs-keyword">then</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"Happy Birthday to you!!!"</span></span><br><span class="line"><span class="hljs-keyword">elif</span> [ <span class="hljs-string">"<span class="hljs-variable">$bir</span>"</span> -gt <span class="hljs-string">"<span class="hljs-variable">$now</span>"</span> ]; <span class="hljs-keyword">then</span></span><br><span class="line">year=`date +%Y`</span><br><span class="line">total_d=$(($((`date --date=<span class="hljs-string">"<span class="hljs-variable">$year</span><span class="hljs-variable">$bir</span>"</span> +%s`-`date +%s`))/60/60/24))</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"Your birthday will be <span class="hljs-variable">$total_d</span> later"</span></span><br><span class="line"><span class="hljs-keyword">else</span></span><br><span class="line">year=$((`date +%Y`+1))</span><br><span class="line">total_d=$(($((`date --date=<span class="hljs-string">"<span class="hljs-variable">$year</span><span class="hljs-variable">$bir</span>"</span> +%s`-`date +%s`))/60/60/24))</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"Your birthday will be <span class="hljs-variable">$total_d</span> later"</span></span><br><span class="line"><span class="hljs-keyword">fi</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>讓使用者輸入一個數字，程序可以由 1+2+3… 一直累加到使用者輸入的數字為止。</li>
</ol>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-built_in">read</span> -p <span class="hljs-string">"Please input an integer number: "</span> number</span><br><span class="line">i=0</span><br><span class="line">s=0</span><br><span class="line"><span class="hljs-keyword">while</span> [ <span class="hljs-string">"<span class="hljs-variable">$i</span>"</span> != <span class="hljs-string">"<span class="hljs-variable">$number</span>"</span> ]</span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line">i=$((<span class="hljs-variable">$i</span>+1))</span><br><span class="line">s=$((<span class="hljs-variable">$s</span>+<span class="hljs-variable">$i</span>))</span><br><span class="line"><span class="hljs-keyword">done</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"the result of '1+2+3+...<span class="hljs-variable">$number</span>' is ==&gt; <span class="hljs-variable">$s</span>"</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>撰寫一支程序，他的作用是: 1.) 先查看一下 /root/test/logical 這個名稱是否存在； 2.) 若不存在，則創建一個文件，使用 touch 來創建，創建完成後離開； 3.) 如果存在的話，判斷該名稱是否為文件，若為文件則將之刪除後創建一個目錄，文件名為 logical ，之後離開； 4.) 如果存在的話，而且該名稱為目錄，則移除此目錄！</li>
</ol>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line"><span class="hljs-keyword">if</span> [ ! -e logical ]; <span class="hljs-keyword">then</span></span><br><span class="line">touch logical</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"Just make a file logical"</span></span><br><span class="line"><span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">elif</span> [ -e logical ] &amp;&amp; [ -f logical ]; <span class="hljs-keyword">then</span></span><br><span class="line">rm logical</span><br><span class="line">mkdir logical</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"remove file ==&gt; logical"</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"and make directory logical"</span></span><br><span class="line"><span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">elif</span> [ -e logical ] &amp;&amp; [ -d logical ]; <span class="hljs-keyword">then</span></span><br><span class="line">rm -rf logical</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"remove directory ==&gt; logical"</span></span><br><span class="line"><span class="hljs-built_in">exit</span> 1</span><br><span class="line"><span class="hljs-keyword">else</span></span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"Does here have anything?"</span></span><br><span class="line"><span class="hljs-keyword">fi</span></span><br></pre></td></tr></table></figure>
<ol start="5">
<li>我們知道 /etc/passwd 裡面以 : 來分隔，第一欄為帳號名稱。請寫一隻程序，可以將 /etc/passwd 的第一欄取出，而且每一欄都以一行字串“The 1 account is “root” ”來顯示，那個 1 表示行數。</li>
</ol>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-meta">#!/bin/bash</span></span><br><span class="line">accounts=`cat /etc/passwd | cut -d<span class="hljs-string">':'</span> -f1`</span><br><span class="line"><span class="hljs-keyword">for</span> account <span class="hljs-keyword">in</span> <span class="hljs-variable">$accounts</span></span><br><span class="line"><span class="hljs-keyword">do</span></span><br><span class="line"><span class="hljs-built_in">declare</span> -i i=<span class="hljs-variable">$i</span>+1</span><br><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-string">"The <span class="hljs-variable">$i</span> account is \"<span class="hljs-variable">$account</span>\" "</span></span><br><span class="line"><span class="hljs-keyword">done</span></span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="etc-passwd-文件架構"><a href="#etc-passwd-文件架構" class="headerlink" title="/etc/passwd 文件架構"></a>/etc/passwd 文件架構</h2><ol>
<li><p>帳號名稱： 需要用來對應 UID, 例如 root 的 UID 對應就是 0 (第三字段)</p>
</li>
<li><p>密碼： 早期 Unix 系統的密碼就是放在這字段上！但是因為這個文件的特性是所有的程序都能夠讀取，這樣一來很容易造成密碼數據被竊取， 因此後來就將這個字段的密碼數據給他改放到 /etc/shadow 中了。所以這裡你會看到一個“ x ”</p>
</li>
<li><p>UID: 使用者識別碼！ Linux 對於 UID 有幾個限制:</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>id 範圍</th>
<th>該 ID 使用者特性</th>
</tr>
</thead>
<tbody>
<tr>
<td>0(系統管理員)</td>
<td>當 UID 是 0 時，代表這個帳號是“系統管理員”！ 所以當你要讓其他的帳號名稱也具有 root 的權限時，將該帳號的 UID 改為 0 即可。 這也就是說，一部系統上面的系統管理員不見得只有 root 喔！ 不過，很不建議有多個帳號的 UID 是 0 啦～容易讓系統管理員混亂！</td>
</tr>
<tr>
<td>1~999(系統帳號)</td>
<td>保留給系統使用的 ID，其實除了 0 之外，其他的 UID 權限與特性並沒有不一樣。默認 1000 以下的數字讓給系統作為保留帳號只是一個習慣。 <br> 由於系統上面啟動的網絡服務或背景服務希望使用較小的權限去運行，因此不希望使用 root 的身份去執行這些服務， 所以我們就得要提供這些運行中程序的擁有者帳號才行。這些系統帳號通常是不可登陸的， 所以才會有我們在第十章提到的 /sbin/nologin 這個特殊的 shell 存在。 <br> 根據系統帳號的由來，通常這類帳號又約略被區分為兩種： <br> 1~200：由 distributions 自行創建的系統帳號； <br> 201~999：若使用者有系統帳號需求時，可以使用的帳號 UID。 </td>
</tr>
<tr>
<td>1000~60000(可登陸帳號)</td>
<td>給一般使用者用的。事實上，目前的 linux 核心 (3.10.x 版)已經可以支持到 4294967295 (2^32-1) 這麼大的 UID 號碼喔！</td>
</tr>
</tbody>
</table>
<ol start="4">
<li><p>GID： 這個與 /etc/group 有關！其實 /etc/group 的觀念與 /etc/passwd 差不多，只是他是用來規範群組名稱與 GID 的對應而已！</p>
</li>
<li><p>使用者信息說明欄： 這個字段基本上並沒有什麼重要用途，只是用來解釋這個帳號的意義而已！不過，如果您提供使用 finger 的功能時， 這個字段可以提供很多的訊息呢！本章後面的 chfn 指令會來解釋這裡的說明。</p>
</li>
<li><p>主文件夾： 這是使用者的主文件夾，以上面為例， root 的主文件夾在 /root ，所以當 root 登陸之後，就會立刻跑到 /root 目錄裡頭啦！呵呵！ 如果你有個帳號的使用空間特別的大，你想要將該帳號的主文件夾移動到其他的硬盤去該怎麼作？ 沒有錯！可以在這個字段進行修改呦！默認的使用者主文件夾在 /home/yourIDname</p>
</li>
<li><p>Shell： 我們在第十章 BASH 提到很多次，當使用者登陸系統後就會取得一個 Shell 來與系統的核心溝通以進行使用者的操作任務。那為何默認 shell 會使用 bash 呢？就是在這個字段指定的囉！ 這裡比較需要注意的是，有一個 shell 可以用來替代成讓帳號無法取得 shell 環境的登陸動作！那就是 /sbin/nologin 這個東西！這也可以用來製作純 pop 郵件帳號者的數據呢！</p>
</li>
</ol>
<p><br><br><br><br><br></p>
<h2 id="etc-shadow-文件結構"><a href="#etc-shadow-文件結構" class="headerlink" title="/etc/shadow 文件結構"></a>/etc/shadow 文件結構</h2><ol>
<li><p>帳號名稱：<br>由於密碼也需要與帳號對應啊～因此，這個文件的第一欄就是帳號，必須要與 /etc/passwd 相同才行！</p>
</li>
<li><p>密碼：<br>這個字段內的數據才是真正的密碼，而且是經過編碼的密碼 (加密) 啦！ 你只會看到有一些特殊符號的字母就是了！需要特別留意的是，雖然這些加密過的密碼很難被解出來， 但是“很難”不等於“不會”，所以，這個文件的默認權限是“-rw——-”或者是“———-”，亦即只有 root 才可以讀寫就是了！你得隨時注意，不要不小心更動了這個文件的權限呢！<br>另外，由於各種密碼編碼的技術不一樣，因此不同的編碼系統會造成這個字段的長度不相同。 舉例來說，舊式的 DES, MD5 編碼系統產生的密碼長度就與目前慣用的 SHA 不同[2]！SHA 的密碼長度明顯的比較長些。由於固定的編碼系統產生的密碼長度必須一致，因此“當你讓這個字段的長度改變後，該密碼就會失效(算不出來)”。 很多軟件通過這個功能，在此字段前加上 ! 或 * 改變密碼字段長度，就會讓密碼“暫時失效”了。</p>
</li>
<li><p>最近更動密碼的日期：<br>這個字段記錄了“更動密碼那一天”的日期，不過，很奇怪呀！在我的例子中怎麼會是 16559 呢？呵呵，這個是因為計算 Linux 日期的時間是以 1970 年 1 月 1 日作為 1 而累加的日期，1971 年 1 月 1 日則為 366 啦！ 得注意一下這個數據呦！上述的 16559 指的就是 2015-05-04 那一天啦！瞭解乎？ 而想要了解該日期可以使用本章後面 chage 指令的幫忙！至於想要知道某個日期的累積日數， 可使用如下的程序計算：</p>
</li>
</ol>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-built_in">echo</span> $(($(date --date=<span class="hljs-string">"2015/05/04"</span> +%s)/86400+1))</span><br></pre></td></tr></table></figure>
<p>上述指令中，2015/05/04 為你想要計算的日期，86400 為每一天的秒數， %s 為 1970/01/01 以來的累積總秒數。 由於 bash 僅支持整數，因此最終需要加上 1 補齊 1970/01/01 當天。</p>
<ol start="4">
<li><p>密碼不可被更動的天數：(與第 3 字段相比)<br>第四個字段記錄了：這個帳號的密碼在最近一次被更改後需要經過幾天才可以再被變更！如果是 0 的話， 表示密碼隨時可以更動的意思。這的限制是為了怕密碼被某些人一改再改而設計的！如果設置為 20 天的話，那麼當你設置了密碼之後， 20 天之內都無法改變這個密碼呦！</p>
</li>
<li><p>密碼需要重新變更的天數：(與第 3 字段相比)<br>經常變更密碼是個好習慣！為了強制要求使用者變更密碼，這個字段可以指定在最近一次更改密碼後， 在多少天數內需要再次的變更密碼才行。你必須要在這個天數內重新設置你的密碼，否則這個帳號的密碼將會“變為過期特性”。 而如果像上面的 99999 (計算為 273 年) 的話，那就表示，呵呵，密碼的變更沒有強制性之意。</p>
</li>
<li><p>密碼需要變更期限前的警告天數：(與第 5 字段相比)<br>當帳號的密碼有效期限快要到的時候 (第 5 字段)，系統會依據這個字段的設置，發出“警告”言論給這個帳號，提醒他“再過 n 天你的密碼就要過期了，請儘快重新設置你的密碼呦！”，如上面的例子，則是密碼到期之前的 7 天之內，系統會警告該用戶。</p>
</li>
<li><p>密碼過期後的帳號寬限時間(密碼失效日)：(與第 5 字段相比)<br>密碼有效日期為“更新日期(第3字段)”+“重新變更日期(第5字段)”，過了該期限後使用者依舊沒有更新密碼，那該密碼就算過期了。 雖然密碼過期但是該帳號還是可以用來進行其他工作的，包括登陸系統取得 bash 。不過如果密碼過期了， 那當你登陸系統時，系統會強制要求你必須要重新設置密碼才能登陸繼續使用喔，這就是密碼過期特性。</p>
</li>
<li><p>帳號失效日期：<br>這個日期跟第三個字段一樣，都是使用 1970 年以來的總日數設置。這個字段表示： 這個帳號在此字段規定的日期之後，將無法再使用。 就是所謂的“帳號失效”，此時不論你的密碼是否有過期，這個“帳號”都不能再被使用！ 這個字段會被使用通常應該是在“收費服務”的系統中，你可以規定一個日期讓該帳號不能再使用啦！</p>
</li>
<li><p>保留：<br>最後一個字段是保留的，看以後有沒有新功能加入。</p>
</li>
</ol>
<p><br></p>
<h3 id="範例-7"><a href="#範例-7" class="headerlink" title="範例"></a>範例</h3><p>假如我的使用者的密碼欄如下所示：</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">dmtsai:<span class="hljs-variable">$6</span><span class="hljs-variable">$M4IphgNP2TmlXaSS</span><span class="hljs-variable">$B418YFroYxxmm</span>....:16559:5:60:7:5:16679:</span><br></pre></td></tr></table></figure>
<ul>
<li><p>由於密碼幾乎僅能單向運算(由明碼計算成為密碼，無法由密碼反推回明碼)，因此由上表的數據我們無法得知 dmstai 的實際密碼明文 (第二個字段)；</p>
</li>
<li><p>此帳號最近一次更動密碼的日期是 2015/05/04 (16559)；</p>
</li>
<li><p>能夠再次修改密碼的時間是 5 天以後，也就是 2015/05/09 以前 dmtsai 不能修改自己的密碼；如果使用者還是嘗試要更動自己的密碼，系統就會出現這樣的訊息：</p>
</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">You must wait longer to change your password</span><br><span class="line">passwd: Authentication token manipulation error</span><br><span class="line">畫面中告訴我們：你必須要等待更久的時間才能夠變更密碼之意啦！</span><br></pre></td></tr></table></figure>
<ul>
<li><p>由於密碼過期日期定義為 60 天后，亦即累積日數為： 16559+60=16619，經過計算得到此日數代表日期為 2015/07/03。 這表示：“使用者必須要在 2015/05/09 (前 5 天不能改) 到 2015/07/03 之間的 60 天限制內去修改自己的密碼，若 2015/07/03 之後還是沒有變更密碼時，該密碼就宣告為過期”了！</p>
</li>
<li><p>警告日期設為 7 天，亦即是密碼過期日前的 7 天，在本例中則代表 2015/06/26 ~ 2015/07/03 這七天。 如果使用者一直沒有更改密碼，那麼在這 7 天中，只要 dmtsai 登陸系統就會發現如下的訊息：<br>Warning: your password will expire in 5 days</p>
</li>
<li><p>如果該帳號一直到 2015/07/03 都沒有更改密碼，那麼密碼就過期了。但是由於有 5 天的寬限天數， 因此 dmtsai 在 2015/07/08 前都還可以使用舊密碼登陸主機。 不過登陸時會出現強制更改密碼的情況，畫面有點像下面這樣：</p>
</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">You are required to change your password immediately (password aged)</span><br><span class="line">WARNING: Your password has expired.</span><br><span class="line">You must change your password now and login again!</span><br><span class="line">Changing password for user dmtsai.</span><br><span class="line">Changing password for dmtsai</span><br><span class="line">(current) UNIX password:</span><br></pre></td></tr></table></figure>
<ul>
<li><p>你必須要輸入一次舊密碼以及兩次新密碼後，才能夠開始使用系統的各項資源。如果你是在 2015/07/08 以後嘗試以 dmtsai 登陸的話，那麼就會出現如下的錯誤訊息且無法登陸，因為此時你的密碼就失效去啦！</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">Your account has expired; please contact your system administrator</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果使用者在 2015/07/03 以前變更過密碼，那麼第 3 個字段的那個 16559 的天數就會跟著改變，因此， 所有的限制日期也會跟著相對變動喔！^_^</p>
</li>
<li><p>無論使用者如何動作，到了 16679 (大約是 2015/09/01 左右) 該帳號就失效了～</p>
</li>
</ul>
<p><br></p>
<h3 id="獲取-shadow-的加密機制"><a href="#獲取-shadow-的加密機制" class="headerlink" title="獲取 shadow 的加密機制"></a>獲取 shadow 的加密機制</h3><ul>
<li>安裝 authconfig, 如果沒有裝的話</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">yum install authconfig-gtk*</span><br></pre></td></tr></table></figure>
<ul>
<li>查詢</li>
</ul>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">authconfig --<span class="hljs-built_in">test</span> | grep hashing</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="關於群組：-有效與初始群組、groups-newgrp"><a href="#關於群組：-有效與初始群組、groups-newgrp" class="headerlink" title="關於群組： 有效與初始群組、groups, newgrp"></a>關於群組： 有效與初始群組、groups, newgrp</h2><h3 id="etc-group-文件結構"><a href="#etc-group-文件結構" class="headerlink" title="/etc/group 文件結構"></a>/etc/group 文件結構</h3><p>如下：<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">root:x:0:</span><br><span class="line">bin:x:1:</span><br><span class="line">daemon:x:2:</span><br><span class="line">sys:x:3:</span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>群組名稱：<br>就是群組名稱啦！同樣用來給人類使用的，基本上需要與第三字段的 GID 對應。</p>
</li>
<li><p>群組密碼：<br>通常不需要設置，這個設置通常是給“群組管理員”使用的，目前很少有這個機會設置群組管理員啦！ 同樣的，密碼已經移動到 /etc/gshadow 去，因此這個字段只會存在一個“x”而已；</p>
</li>
<li><p>GID：<br>就是群組的 ID 啊。我們 /etc/passwd 第四個字段使用的 GID 對應的群組名，就是由這裡對應出來的！</p>
</li>
<li><p>此群組支持的帳號名稱：<br>我們知道一個帳號可以加入多個群組，那某個帳號想要加入此群組時，將該帳號填入這個字段即可。 舉例來說，如果我想要讓 dmtsai 與 alex 也加入 root 這個群組，那麼在第一行的最後面加上“dmtsai,alex”，注意不要有空格， 使成為“ root:x:0:dmtsai,alex ”就可以囉～</p>
</li>
</ol>
<p><br></p>
<h3 id="etc-gshadow-文件結構"><a href="#etc-gshadow-文件結構" class="headerlink" title="/etc/gshadow 文件結構"></a>/etc/gshadow 文件結構</h3><ol>
<li>群組名稱</li>
<li>密碼欄，同樣的，開頭為 ! 表示無合法密碼，所以無群組管理員</li>
<li>群組管理員的帳號 (相關信息在 gpasswd 中介紹)</li>
<li>有加入該群組支持的所屬帳號 (與 /etc/group 內容相同！)</li>
</ol>
<p><br><br><br><br><br></p>
<h2 id="etc-passwd-與-etc-group-與-etc-shadow-示意圖"><a href="#etc-passwd-與-etc-group-與-etc-shadow-示意圖" class="headerlink" title="/etc/passwd 與 /etc/group 與 /etc/shadow 示意圖"></a>/etc/passwd 與 /etc/group 與 /etc/shadow 示意圖</h2><p>談完了 /etc/passwd, /etc/shadow, /etc/group 之後，我們可以使用一個簡單的圖示來了解一下 UID / GID 與密碼之間的關係， 圖示如下。其實重點是 /etc/passwd 啦，其他相關的數據都是根據這個文件的字段去找尋出來的。 下圖中， root 的 UID 是 0 ，而 GID 也是 0 ，去找 /etc/group 可以知道 GID 為 0 時的群組名稱就是 root 哩。 至於密碼的尋找中，會找到 /etc/shadow 與 /etc/passwd 內同帳號名稱的那一行，就是密碼相關數據囉。</p>
<p><img src="https://lh3.googleusercontent.com/ujo1cwLgxb9GgqIIdqpGbiVwAHTCD9z48ZKfMkBQq7UXS7kCVJaLDDrLGXnWPu6DhZmVrED0m0tq8Hw_ICWU31KNHbKBmhDMa0Yj-CyKY0J2zp6uVfNuty7NfHKWDe8y902-8-8Xc7tMw-PX_2EF3DMafEh-dFJXKXk4eSmBTArex8YnpqPdyKPIm1zkCK9KJ_EsVWxsC_vWU4w4UF2_zre0luizW27nPvUPCZ9Z9_Zm_hwP7xAM7TwbSSzA3_FB9oAgDSq70GRtk17wRM6davPmRCSmyV_G0PKHFu0W8EuSXMOfh6Ia8GQMDDBGx7peuoDNKhmReyBq4bYrgjpq2AQZMPF8pySqiZS1UDMJEzx2vESxznp2HCyrbyJL21peGC2ZPkwNKWatU9Q9JZQ8LWtFi1cFkQZQn7rJFNQ_95vDDZlmUZ2SOuigVGVh_GDWgCi9RIgsTqWQUMt6SklYnQE_kuQ9OjZrM8nAjF2QAgSufOhH_aKBFN6Dthsv60RJbfbpkS79Cs0L1HhkYM6LlCcXd35oHcVvbuKXQi4_XXbTvG6iXOD5LHYe9OzWzIl7pjP3hWxvItzXfAR24ASFg1nncoiDQ2WORrH9j7OFNGkdjEnEeW6KXj36GnwjoEb7WN7Lft3kbp-zAo1hPch7tCYuMfH5G1g=w493-h202-no" alt></p>
<p><br><br><br><br><br></p>
<h2 id="finger"><a href="#finger" class="headerlink" title="finger"></a>finger</h2><ul>
<li>Login：為使用者帳號，亦即 /etc/passwd 內的第一字段；</li>
<li>Name：為全名，亦即 /etc/passwd 內的第五字段(或稱為註解)；</li>
<li>Directory：就是主文件夾了；</li>
<li>Shell：就是使用的 Shell 文件所在；</li>
<li>Never logged in.：figner 還會調查使用者登陸主機的情況喔！</li>
<li>No mail.：調查 /var/spool/mail 當中的信箱數據；</li>
<li>No Plan.：調查 ~vbird1/.plan 文件，並將該文件取出來說明！</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="chfn"><a href="#chfn" class="headerlink" title="chfn"></a>chfn</h2><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">chfn [-foph] [帳號名]</span><br><span class="line">選項與參數：</span><br><span class="line">-f  ：後面接完整的大名；</span><br><span class="line">-o  ：您辦公室的房間號碼；</span><br><span class="line">-p  ：辦公室的電話號碼；</span><br><span class="line">-h  ：家裡的電話號碼！</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="chage"><a href="#chage" class="headerlink" title="chage"></a>chage</h2><ul>
<li>更詳細的密碼參數顯示功能</li>
<li>可讓使用者在第一次登陸時， 強制她們一定要更改密碼後才能夠使用系統資源</li>
</ul>
<h3 id="語法-10"><a href="#語法-10" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">chage [-ldEImMW] 帳號名</span><br><span class="line">選項與參數：</span><br><span class="line">-l ：列出該帳號的詳細密碼參數；</span><br><span class="line">-d ：後面接日期，修改 shadow 第三字段(最近一次更改密碼的日期)，格式 YYYY-MM-DD</span><br><span class="line">-E ：後面接日期，修改 shadow 第八字段(帳號失效日)，格式 YYYY-MM-DD</span><br><span class="line">-I ：後面接天數，修改 shadow 第七字段(密碼失效日期)</span><br><span class="line">-m ：後面接天數，修改 shadow 第四字段(密碼最短保留天數)</span><br><span class="line">-M ：後面接天數，修改 shadow 第五字段(密碼多久需要進行變更)</span><br><span class="line">-W ：後面接天數，修改 shadow 第六字段(密碼過期前警告日期)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-8"><a href="#範例-8" class="headerlink" title="範例"></a>範例</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">範例一：列出 vbird2 的詳細密碼參數</span><br><span class="line">[root@study ~]# chage -l vbird2</span><br><span class="line">Last password change                                    : Jul 20, 2015</span><br><span class="line">Password expires                                        : Sep 18, 2015</span><br><span class="line">Password inactive                                       : Sep 28, 2015</span><br><span class="line">Account expires                                         : never</span><br><span class="line">Minimum number of days between password change          : 0</span><br><span class="line">Maximum number of days between password change          : 60</span><br><span class="line">Number of days of warning before password expires       : 7</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="chsh"><a href="#chsh" class="headerlink" title="chsh"></a>chsh</h2><h3 id="語法：-1"><a href="#語法：-1" class="headerlink" title="語法："></a>語法：</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">chsh [-ls]</span><br><span class="line">選項與參數：</span><br><span class="line">-l  ：列出目前系統上面可用的 shell ，其實就是 /etc/shells 的內容！</span><br><span class="line">-s  ：設置修改自己的 Shell 囉</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-9"><a href="#範例-9" class="headerlink" title="範例"></a>範例</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">範例一：用 vbird1 的身份列出系統上所有合法的 shell，並且指定 csh 為自己的 shell</span><br><span class="line">[vbird1@study ~]$ chsh -l</span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/sbin/nologin   &lt;==所謂：合法不可登陸的 Shell 就是這玩意！</span><br><span class="line">/usr/bin/sh</span><br><span class="line">/usr/bin/bash</span><br><span class="line">/usr/sbin/nologin</span><br><span class="line">/bin/tcsh</span><br><span class="line">/bin/csh        &lt;==這就是 C shell 啦！</span><br><span class="line"># 其實上面的信息就是我們在 bash 中談到的 /etc/shells 啦！</span><br><span class="line"></span><br><span class="line">[vbird1@study ~]$ chsh -s /bin/csh; grep vbird1 /etc/passwd</span><br><span class="line">Changing shell for vbird1.</span><br><span class="line">Password:  &lt;==確認身份，請輸入 vbird1 的密碼</span><br><span class="line">Shell changed.</span><br><span class="line">vbird1:x:1003:1004:VBird Tsai test,DIC in KSU,06-2727175#356,06-1234567:/home/vbird1:/bin/csh</span><br><span class="line"></span><br><span class="line">[vbird1@study ~]$ chsh -s /bin/bash</span><br><span class="line"># 測試完畢後，立刻改回來！</span><br><span class="line"></span><br><span class="line">[vbird1@study ~]$ ll $(which chsh)</span><br><span class="line">-rws--x--x. 1 root root 23856 Mar  6 13:59 /bin/chsh</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="groupadd"><a href="#groupadd" class="headerlink" title="groupadd"></a>groupadd</h2><h3 id="語法-11"><a href="#語法-11" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">groupadd [-g gid] [-r] 群組名稱</span><br><span class="line">選項與參數：</span><br><span class="line">-g  ：後面接某個特定的 GID ，用來直接給予某個 GID ～</span><br><span class="line">-r  ：創建系統群組啦！與 /etc/login.defs 內的 GID_MIN 有關。</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-10"><a href="#範例-10" class="headerlink" title="範例"></a>範例</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">範例一：新建一個群組，名稱為 group1</span><br><span class="line">[root@study ~]# groupadd group1</span><br><span class="line">[root@study ~]# grep group1 /etc/group /etc/gshadow</span><br><span class="line">/etc/group:group1:x:1503:</span><br><span class="line">/etc/gshadow:group1:!::</span><br><span class="line"># 群組的 GID 也是會由 1000 以上最大 GID+1 來決定！</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="groupmod"><a href="#groupmod" class="headerlink" title="groupmod"></a>groupmod</h2><h3 id="語法-12"><a href="#語法-12" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">groupmod [-g gid] [-n group_name] 群組名</span><br><span class="line">選項與參數：</span><br><span class="line">-g  ：修改既有的 GID 數字；</span><br><span class="line">-n  ：修改既有的群組名稱</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-11"><a href="#範例-11" class="headerlink" title="範例"></a>範例</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">範例一：將剛剛上個指令創建的 group1 名稱改為 mygroup ， GID 為 201</span><br><span class="line">[root@study ~]# groupmod -g 201 -n mygroup group1</span><br><span class="line">[root@study ~]# grep mygroup /etc/group /etc/gshadow</span><br><span class="line">/etc/group:mygroup:x:201:</span><br><span class="line">/etc/gshadow:mygroup:!::</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="groupdel-1"><a href="#groupdel-1" class="headerlink" title="groupdel"></a>groupdel</h2><h3 id="語法-13"><a href="#語法-13" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">groupdel [groupname]</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="gpasswd"><a href="#gpasswd" class="headerlink" title="gpasswd"></a>gpasswd</h2><h3 id="語法-14"><a href="#語法-14" class="headerlink" title="語法"></a>語法</h3><h4 id="系統管理員-root"><a href="#系統管理員-root" class="headerlink" title="系統管理員 (root)"></a>系統管理員 (root)</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">gpasswd groupname</span><br><span class="line">[root@study ~]# gpasswd [-A user1,...] [-M user3,...] groupname</span><br><span class="line">[root@study ~]# gpasswd [-rR] groupname</span><br><span class="line">選項與參數：</span><br><span class="line">    ：若沒有任何參數時，表示給予 groupname 一個密碼(/etc/gshadow)</span><br><span class="line">-A  ：將 groupname 的主控權交由後面的使用者管理(該群組的管理員)</span><br><span class="line">-M  ：將某些帳號加入這個群組當中！</span><br><span class="line">-r  ：將 groupname 的密碼移除</span><br><span class="line">-R  ：讓 groupname 的密碼欄失效</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="群組管理員-Group-administrator"><a href="#群組管理員-Group-administrator" class="headerlink" title="群組管理員 (Group administrator)"></a>群組管理員 (Group administrator)</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">gpasswd [-ad] user groupname</span><br><span class="line">選項與參數：</span><br><span class="line">-a  ：將某位使用者加入到 groupname 這個群組當中！</span><br><span class="line">-d  ：將某位使用者移除出 groupname 這個群組當中。</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-12"><a href="#範例-12" class="headerlink" title="範例"></a>範例</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">範例一：創建一個新群組，名稱為 testgroup 且群組交由 vbird1 管理：</span><br><span class="line">[root@study ~]# groupadd testgroup  &lt;==先創建群組</span><br><span class="line">[root@study ~]# gpasswd testgroup   &lt;==給這個群組一個密碼吧！</span><br><span class="line">Changing the password for group testgroup</span><br><span class="line">New Password:</span><br><span class="line">Re-enter new password:</span><br><span class="line"># 輸入兩次密碼就對了！</span><br><span class="line">[root@study ~]# gpasswd -A vbird1 testgroup  &lt;==加入群組管理員為 vbird1</span><br><span class="line">[root@study ~]# grep testgroup /etc/group /etc/gshadow</span><br><span class="line">/etc/group:testgroup:x:1503:</span><br><span class="line">/etc/gshadow:testgroup:$6$MnmChP3D$mrUn.Vo.buDjObMm8F2emTkvGSeuWikhRzaKHxpJ...:vbird1:</span><br><span class="line"># 很有趣吧！此時 vbird1 則擁有 testgroup 的主控權喔！身份有點像板主啦！</span><br></pre></td></tr></table></figure>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">範例二：以 vbird1 登陸系統，並且讓他加入 vbird1, vbird3 成為 testgroup 成員</span><br><span class="line">[vbird1@study ~]$ id</span><br><span class="line">uid=1003(vbird1) gid=1004(vbird1) groups=1004(vbird1) ...</span><br><span class="line"># 看得出來，vbird1 尚未加入 testgroup 群組喔！</span><br><span class="line"></span><br><span class="line">[vbird1@study ~]$ gpasswd -a vbird1 testgroup</span><br><span class="line">[vbird1@study ~]$ gpasswd -a vbird3 testgroup</span><br><span class="line">[vbird1@study ~]$ grep testgroup /etc/group</span><br><span class="line">testgroup:x:1503:vbird1,vbird3</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="ACL"><a href="#ACL" class="headerlink" title="ACL"></a>ACL</h2><h3 id="setfacl"><a href="#setfacl" class="headerlink" title="setfacl"></a>setfacl</h3><p><b> setfacl </b>：設置某個目錄/文件的 ACL 規範。</p>
<h4 id="語法-15"><a href="#語法-15" class="headerlink" title="語法"></a>語法</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">setfacl [-bkRd] [&#123;-m|-x&#125; acl參數] 目標文件名</span><br><span class="line">選項與參數：</span><br><span class="line">-m ：設置後續的 acl 參數給文件使用，不可與 -x 合用；</span><br><span class="line">-x ：刪除後續的 acl 參數，不可與 -m 合用；</span><br><span class="line">-b ：移除“所有的” ACL 設置參數；</span><br><span class="line">-k ：移除“默認的” ACL 參數，關於所謂的“默認”參數於後續範例中介紹；</span><br><span class="line">-R ：遞迴設置 acl ，亦即包括次目錄都會被設置起來；</span><br><span class="line">-d ：設置“默認 acl 參數”的意思！只對目錄有效，在該目錄新建的數據會引用此默認值</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="getfacl"><a href="#getfacl" class="headerlink" title="getfacl"></a>getfacl</h3><h4 id="語法-16"><a href="#語法-16" class="headerlink" title="語法"></a>語法</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">getfacl filename</span><br><span class="line">選項與參數：</span><br><span class="line"># 請列出剛剛我們設置的 acl_test1 的權限內容：</span><br><span class="line">[root@study ~]# getfacl acl_test1</span><br><span class="line"># file: acl_test1   &lt;==說明文檔名而已！</span><br><span class="line"># owner: root       &lt;==說明此文件的擁有者，亦即 ls -l 看到的第三使用者字段</span><br><span class="line"># group: root       &lt;==此文件的所屬群組，亦即 ls -l 看到的第四群組字段</span><br><span class="line">user::rwx           &lt;==使用者列表欄是空的，代表文件擁有者的權限</span><br><span class="line">user:vbird1:r-x     &lt;==針對 vbird1 的權限設置為 rx ，與擁有者並不同！</span><br><span class="line">group::r--          &lt;==針對文件群組的權限設置僅有 r </span><br><span class="line">mask::r-x           &lt;==此文件默認的有效權限 (mask)</span><br><span class="line">other::r--          &lt;==其他人擁有的權限囉！</span><br><span class="line"></span><br><span class="line">-m ：設置後續的 acl 參數給文件使用，不可與 -x 合用；</span><br><span class="line">-x ：刪除後續的 acl 參數，不可與 -m 合用；</span><br><span class="line">-b ：移除“所有的” ACL 設置參數；</span><br><span class="line">-k ：移除“默認的” ACL 參數，關於所謂的“默認”參數於後續範例中介紹；</span><br><span class="line">-R ：遞迴設置 acl ，亦即包括次目錄都會被設置起來；</span><br><span class="line">-d ：設置“默認 acl 參數”的意思！只對目錄有效，在該目錄新建的數據會引用此默認值</span><br></pre></td></tr></table></figure>
<p>顯示的數據前面加上 # 的，代表這個文件的默認屬性，包括文件名、文件擁有者與文件所屬群組。user, group, mask, other 則是屬於不同使用者、群組與有效權限(mask)的設置值。</p>
<p><br><br><br><br><br></p>
<h2 id="su"><a href="#su" class="headerlink" title="su"></a>su</h2><h3 id="語法-17"><a href="#語法-17" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">su [-lm] [-c 指令] [username]</span><br><span class="line">選項與參數：</span><br><span class="line">-   ：單純使用 - 如“ su - ”代表使用 login-shell 的變量文件讀取方式來登陸系統；</span><br><span class="line">      若使用者名稱沒有加上去，則代表切換為 root 的身份。</span><br><span class="line">-l  ：與 - 類似，但後面需要加欲切換的使用者帳號！也是 login-shell 的方式。</span><br><span class="line">-m  ：-m 與 -p 是一樣的，表示“使用目前的環境設置，而不讀取新使用者的配置文件”</span><br><span class="line">-c  ：僅進行一次指令，所以 -c 後面可以加上指令喔！</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h2><h3 id="語法-18"><a href="#語法-18" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">sudo [-b] [-u 新使用者帳號]</span><br><span class="line">選項與參數：</span><br><span class="line">-b  ：將後續的指令放到背景中讓系統自行執行，而不與目前的 shell 產生影響</span><br><span class="line">-u  ：後面可以接欲切換的使用者，若無此項則代表切換身份為 root 。</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="sudoers"><a href="#sudoers" class="headerlink" title="sudoers"></a>sudoers</h2><h3 id="更改設置"><a href="#更改設置" class="headerlink" title="更改設置"></a>更改設置</h3><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">visodu</span><br></pre></td></tr></table></figure>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">root    ALL=(ALL)       ALL  &lt;==找到這一行，大約在 98 行左右</span><br><span class="line">vbird1  ALL=(ALL)       ALL  &lt;==這一行是你要新增的！</span><br></pre></td></tr></table></figure>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">使用者帳號  登陸者的來源主機名稱=(可切換的身份)  可下達的指令</span><br><span class="line">root                         ALL=(ALL)           ALL   &lt;==這是默認值</span><br></pre></td></tr></table></figure>
<ol>
<li>“使用者帳號”：系統的哪個帳號可以使用 sudo 這個指令的意思；</li>
<li>“登陸者的來源主機名稱”：當這個帳號由哪部主機連線到本 Linux 主機，意思是這個帳號可能是由哪一部網絡主機連線過來的， 這個設置值可以指定用戶端計算機(信任的來源的意思)。默認值 root 可來自任何一部網絡主機</li>
<li>“(可切換的身份)”：這個帳號可以切換成什麼身份來下達後續的指令，默認 root 可以切換成任何人；</li>
<li>“可下達的指令”：可用該身份下達什麼指令？這個指令請務必使用絕對路徑撰寫。 默認 root 可以切換任何身份且進行任何指令之意。<br>那個 ALL 是特殊的關鍵字，代表任何身份、主機或指令的意思。所以，我想讓 vbird1 可以進行任何身份的任何指令， 就如同上表特殊字體寫的那樣，其實就是複製上述默認值那一行，再將 root 改成 vbird1 即可啊！ 此時“vbird1 不論來自哪部主機登陸，他可以變換身份成為任何人，且可以進行系統上面的任何指令”之意。 修改完請儲存後離開 vi，並以 vbird1 登陸系統後，進行如下的測試看看：</li>
</ol>
<p><br><br><br><br><br></p>
<h2 id="visudo"><a href="#visudo" class="headerlink" title="visudo"></a>visudo</h2><p>更改默認編輯器<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">update-alternatives --config editor</span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<h2 id="PAM-模塊設置語法"><a href="#PAM-模塊設置語法" class="headerlink" title="PAM 模塊設置語法"></a>PAM 模塊設置語法</h2><h3 id="程序與-PAM-的關係圖"><a href="#程序與-PAM-的關係圖" class="headerlink" title="程序與 PAM 的關係圖"></a>程序與 PAM 的關係圖</h3><p><img src="https://lh3.googleusercontent.com/kiQmhpIYtgM4l2t1KCPxJkhAwZsd4J31bfbeKi2ORAiZJiLWiTyyvqY-qLUawL2l2Fm-PuQzYR2cl9eA-I9s30KbnOlscqATGTlcYbifeM1GjUauPH9aCxOOhegj2GOfoBGFOPVp8g=w285-h212-no" alt></p>
<p><br></p>
<h3 id="程序調用-PAM-的流程"><a href="#程序調用-PAM-的流程" class="headerlink" title="程序調用 PAM 的流程"></a>程序調用 PAM 的流程</h3><ol>
<li>使用者開始執行 /usr/bin/passwd 這支程序，並輸入密碼；</li>
<li>passwd 調用 PAM 模塊進行驗證；</li>
<li>PAM 模塊會到 /etc/pam.d/ 找尋與程序 (passwd) 同名的配置文件；</li>
<li>依據 /etc/pam.d/passwd 內的設置，引用相關的 PAM 模塊逐步進行驗證分析；</li>
<li>將驗證結果 (成功、失敗以及其他訊息) 回傳給 passwd 這支程序；</li>
<li>passwd 這支程序會根據 PAM 回傳的結果決定下一個動作 (重新輸入新密碼或者通過驗證！)</li>
</ol>
<p><br></p>
<h3 id="配置文件內容"><a href="#配置文件內容" class="headerlink" title="配置文件內容"></a>配置文件內容</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">cat /etc/pam.d/passwd</span><br><span class="line">#%PAM-1.0  &lt;==PAM版本的說明而已！</span><br><span class="line">auth       include      system-auth   &lt;==每一行都是一個驗證的過程</span><br><span class="line">account    include      system-auth</span><br><span class="line">password   substack     system-auth</span><br><span class="line">-password   optional    pam_gnome_keyring.so use_authtok</span><br><span class="line">password   substack     postlogin</span><br><span class="line">驗證類別   控制標準     PAM 模塊與該模塊的參數</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="驗證類別-type"><a href="#驗證類別-type" class="headerlink" title="驗證類別 (type)"></a>驗證類別 (type)</h4><p>驗證類別主要分為四種，分別說明如下：</p>
<p>auth<br>是 authentication (認證) 的縮寫，所以這種類別主要用來檢驗使用者的身份驗證，這種類別通常是需要密碼來檢驗的， 所以後續接的模塊是用來檢驗使用者的身份。</p>
<p>account<br>account (帳號) 則大部分是在進行 authorization (授權)，這種類別則主要在檢驗使用者是否具有正確的使用權限， 舉例來說，當你使用一個過期的密碼來登陸時，當然就無法正確的登陸了。</p>
<p>session<br>session 是會議期間的意思，所以 session 管理的就是使用者在這次登陸 (或使用這個指令) 期間，PAM 所給予的環境設置。 這個類別通常用在記錄使用者登陸與登出時的信息！例如，如果你常常使用 su 或者是 sudo 指令的話， 那麼應該可以在 /var/log/secure 裡面發現很多關於 pam 的說明，而且記載的數據是“session open, session close”的信息！ </p>
<p>password<br>password 就是密碼嘛！所以這種類別主要在提供驗證的修訂工作，舉例來說，就是修改/變更密碼啦！<br>這四個驗證的類型通常是有順序的，不過也有例外就是了。 會有順序的原因是，(1)我們總是得要先驗證身份 (auth) 後， (2)系統才能夠藉由使用者的身份給予適當的授權與權限設置 (account)，而且(3)登陸與登出期間的環境才需要設置， 也才需要記錄登陸與登出的信息 (session)。如果在運行期間需要密碼修訂時，(4)才給予 password 的類別。這樣說起來， 自然是需要有點順序吧！</p>
<p><br></p>
<h4 id="驗證的控制旗標-control-flag"><a href="#驗證的控制旗標-control-flag" class="headerlink" title="驗證的控制旗標 (control flag)"></a>驗證的控制旗標 (control flag)</h4><p>那麼“驗證的控制旗標(control flag)”又是什麼？簡單的說，他就是“驗證通過的標準”啦！ 這個字段在管控該驗證的放行方式，主要也分為四種控制方式：</p>
<p>required<br>此驗證若成功則帶有 success (成功) 的標誌，若失敗則帶有 failure 的標誌，但不論成功或失敗都會繼續後續的驗證流程。 由於後續的驗證流程可以繼續進行，因此相當有利於數據的登錄 (log) ，這也是 PAM 最常使用 required 的原因。</p>
<p>requisite<br>若驗證失敗則立刻回報原程序 failure 的標誌，並終止後續的驗證流程。若驗證成功則帶有 success 的標誌並繼續後續的驗證流程。 這個項目與 required 最大的差異，就在於失敗的時候還要不要繼續驗證下去？由於 requisite 是失敗就終止， 因此失敗時所產生的 PAM 信息就無法通過後續的模塊來記錄了。</p>
<p>sufficient<br>若驗證成功則立刻回傳 success 給原程序，並終止後續的驗證流程；若驗證失敗則帶有 failure 標誌並繼續後續的驗證流程。 這玩意兒與 requisits 剛好相反！</p>
<p>optional<br>這個模塊控制項目大多是在顯示訊息而已，並不是用在驗證方面的。<br>如果將這些控制旗標以圖示的方式配合成功與否的條件繪圖，會有點像下面這樣：</p>
<p><img src="https://lh3.googleusercontent.com/ClZmDGa1AqGInMNdmvEpVcdcwXs2xTfeyoyQPDdpyETIleyfMiE9-kG7oa862PU_IfGE1r7_DgAFJcc4DcbK6woPujZKaL4w4mnt_QCgpWuKxfHF6vMWfELK0MBmWO_5dN5Ge23EErmHe_DXWgby7hIrCrdIDXbvsHDEMzhI41nLqYVU63U3ITzFwIhQci4yt4VFRt1DrDTXrhOoznXxZvLMaPRQ-vLwGR6e7AtFe1gbHVskfPUOwyeVbZM1FtAsVPLreLCSpHAJE8uvWE4gwyPf9C8KVtJd0JyO32OsCBVAyBkL74SRgMELsfHvWYlZVmQ2mVWPpT5M-PXrFruk_-saaWUVDBRTQc4EJi6R9fxqOux_8dRLRncp8GVEI1ehzr5b5bAdkO-G0XceyWKUlihkhHE9obt-55oRS_qJALzJBXY5WPdwg9giTAnSBMSREbYwmSdjc9saUcVDuFzqKTv8LHE-2Thu-O7rvNAdg230r8Wpgr2q0ZfAfHc_5FJ9gSxk0ou0PNeKz2Qhs5tH384TEJoY_ysAPGRNFb9iBIKONYsYQXV9qdMXL1dx6-IApbstuSuoBQ-6J-GxtrC1P7nBVOOnrYRhbzlDOihNKEND4rq32Qc5lHVSGFXECMn6ZoifyvbEIFUYcaaC3xsbHrmFUBHSstU=w288-h411-no" alt></p>
<p>程序運行過程中遇到驗證時才會去調用 PAM ，而 PAM 驗證又分很多類型與控制，不同的控制旗標所回報的訊息並不相同。 如上圖所示， requisite 失敗就回報了並不會繼續，而 sufficient 則是成功就回報了也不會繼續。 至於驗證結束後所回報的信息通常是“succes 或 failure ”而已，後續的流程還需要該程序的判斷來繼續執行才行。</p>
<p><br><br><br><br><br></p>
<h2 id="jobs"><a href="#jobs" class="headerlink" title="jobs"></a>jobs</h2><h3 id="語法-19"><a href="#語法-19" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# jobs [-lrs]</span><br><span class="line">選項與參數：</span><br><span class="line">-l  ：除了列出 job number 與指令串之外，同時列出 PID 的號碼；</span><br><span class="line">-r  ：僅列出正在背景 run 的工作；</span><br><span class="line">-s  ：僅列出正在背景當中暫停 (stop) 的工作。</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="fg"><a href="#fg" class="headerlink" title="fg"></a>fg</h2><h3 id="語法-20"><a href="#語法-20" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# fg %jobnumber</span><br><span class="line">選項與參數：</span><br><span class="line">%jobnumber ：jobnumber 為工作號碼(數字)。注意，那個 % 是可有可無的！</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="ps-1"><a href="#ps-1" class="headerlink" title="ps"></a>ps</h2><h3 id="語法-21"><a href="#語法-21" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# ps aux  &lt;==觀察系統所有的程序數據</span><br><span class="line">[root@study ~]# ps -lA  &lt;==也是能夠觀察所有系統的數據</span><br><span class="line">[root@study ~]# ps axjf &lt;==連同部分程序樹狀態</span><br><span class="line">選項與參數：</span><br><span class="line">-A  ：所有的 process 均顯示出來，與 -e 具有同樣的效用；</span><br><span class="line">-a  ：不與 terminal 有關的所有 process ；</span><br><span class="line">-u  ：有效使用者 (effective user) 相關的 process ；</span><br><span class="line">x   ：通常與 a 這個參數一起使用，可列出較完整信息。</span><br><span class="line">輸出格式規劃：</span><br><span class="line">l   ：較長、較詳細的將該 PID 的的信息列出；</span><br><span class="line">j   ：工作的格式 (jobs format)</span><br><span class="line">-f  ：做一個更為完整的輸出。</span><br></pre></td></tr></table></figure>
<h3 id="觀察自己的-bash-相關程序"><a href="#觀察自己的-bash-相關程序" class="headerlink" title="觀察自己的 bash 相關程序"></a>觀察自己的 bash 相關程序</h3><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">ps -l</span><br></pre></td></tr></table></figure>
<p><b>輸出如下：</b></p>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">F S   UID   PID  PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD</span><br><span class="line">4 S     0 14830 13970  0  80   0 - 52686 poll_s pts/0    00:00:00 sudo</span><br><span class="line">4 S     0 14835 14830  0  80   0 - 50511 wait   pts/0    00:00:00 su</span><br><span class="line">4 S     0 14836 14835  0  80   0 - 29035 wait   pts/0    00:00:00 bash</span><br><span class="line">0 R     0 15011 14836  0  80   0 - 30319 -      pts/0    00:00:00 ps</span><br><span class="line"># 還記得鳥哥說過，非必要不要使用 root 直接登陸吧？從這個 ps -l 的分析，你也可以發現，</span><br><span class="line"># 鳥哥其實是使用 sudo 才轉成 root 的身份～否則連測試機，鳥哥都是使用一般帳號登陸的！</span><br></pre></td></tr></table></figure>
<p><b>詳解：</b></p>
<p>系統整體的程序運行是非常多的，但如果使用 ps -l 則僅列出與你的操作環境 (bash) 有關的程序而已， 亦即最上層的父程序會是你自己的 bash 而沒有延伸到 systemd (後續會交待！) 這支程序去！那麼 ps -l 秀出來的數據有哪些呢？ 我們就來觀察看看：</p>
<ul>
<li><p>F：代表這個程序旗標 (process flags)，說明這個程序的總結權限，常見號碼有：</p>
<ul>
<li>若為 4 表示此程序的權限為 root ；</li>
<li>若為 1 則表示此子程序僅進行複製(fork)而沒有實際執行(exec)。</li>
</ul>
</li>
<li><p>S：代表這個程序的狀態 (STAT)，主要的狀態有：</p>
<ul>
<li>R (Running)：該程序正在運行中；</li>
<li>S (Sleep)：該程序目前正在睡眠狀態(idle)，但可以被喚醒(signal)。</li>
<li>D ：不可被喚醒的睡眠狀態，通常這支程序可能在等待 I/O 的情況(ex&gt;打印)</li>
<li>T ：停止狀態(stop)，可能是在工作控制(背景暫停)或除錯 (traced) 狀態；</li>
<li>Z (Zombie)：殭屍狀態，程序已經終止但卻無法被移除至內存外。</li>
</ul>
</li>
<li><p>UID/PID/PPID：代表“此程序被該 UID 所擁有/程序的 PID 號碼/此程序的父程序 PID 號碼”</p>
</li>
<li><p>C：代表 CPU 使用率，單位為百分比；</p>
</li>
<li><p>PRI/NI：Priority/Nice 的縮寫，代表此程序被 CPU 所執行的優先順序，數值越小代表該程序越快被 CPU 執行。詳細的 PRI 與 NI 將在下一小節說明。</p>
</li>
<li><p>ADDR/SZ/WCHAN：都與內存有關，ADDR 是 kernel function，指出該程序在內存的哪個部分，如果是個 running 的程序，一般就會顯示“ - ” / SZ 代表此程序用掉多少內存 / WCHAN 表示目前程序是否運行中，同樣的， 若為 - 表示正在運行中。</p>
</li>
<li><p>TTY：登陸者的終端機位置，若為遠端登陸則使用動態終端接口 (pts/n)；</p>
</li>
<li><p>TIME：使用掉的 CPU 時間，注意，是此程序實際花費 CPU 運行的時間，而不是系統時間；</p>
</li>
<li><p>CMD：就是 command 的縮寫，造成此程序的觸發程序之指令為何。</p>
</li>
</ul>
<p>所以你看到的 ps -l 輸出訊息中，他說明的是：“bash 的程序屬於 UID 為 0 的使用者，狀態為睡眠 (sleep)， 之所以為睡眠因為他觸發了 ps (狀態為 run) 之故。此程序的 PID 為 14836，優先執行順序為 80 ， 下達 bash 所取得的終端接口為 pts/0 ，運行狀態為等待 (wait) 。”這樣已經夠清楚了吧？ 您自己嘗試解析一下那麼 ps 那一行代表的意義為何呢？ ^_^<br>接下來讓我們使用 ps 來觀察一下系統內所有的程序狀態吧！</p>
<p><br></p>
<h3 id="觀察系統所有程序"><a href="#觀察系統所有程序" class="headerlink" title="觀察系統所有程序"></a>觀察系統所有程序</h3><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">ps aux</span><br></pre></td></tr></table></figure>
<p><b>輸出： </b><br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">root         1  0.0  0.2  60636  7948 ?        Ss   Aug04   0:01 /usr/lib/systemd/systemd ...</span><br><span class="line">root         2  0.0  0.0      0     0 ?        S    Aug04   0:00 [kthreadd]</span><br><span class="line">.....(中間省略).....</span><br><span class="line">root     14830  0.0  0.1 210744  3988 pts/0    S    Aug04   0:00 sudo su -</span><br><span class="line">root     14835  0.0  0.1 202044  2996 pts/0    S    Aug04   0:00 su -</span><br><span class="line">root     14836  0.0  0.1 116140  2960 pts/0    S    Aug04   0:00 -bash</span><br><span class="line">.....(中間省略).....</span><br><span class="line">root     18459  0.0  0.0 123372  1380 pts/0    R+   00:25   0:00 ps aux</span><br></pre></td></tr></table></figure></p>
<p><b>詳解： </b><br>你會發現 ps -l 與 ps aux 顯示的項目並不相同！在 ps aux 顯示的項目中，各字段的意義為：</p>
<ul>
<li>USER：該 process 屬於那個使用者帳號的？</li>
<li>PID ：該 process 的程序識別碼。</li>
<li>%CPU：該 process 使用掉的 CPU 資源百分比；</li>
<li>%MEM：該 process 所佔用的實體內存百分比；</li>
<li>VSZ ：該 process 使用掉的虛擬內存量 (KBytes)</li>
<li>RSS ：該 process 佔用的固定的內存量 (KBytes)</li>
<li>TTY ：該 process 是在那個終端機上面運行，若與終端機無關則顯示 ?，另外， tty1-tty6 是本機上面的登陸者程序，若為 pts/0 等等的，則表示為由網絡連接進主機的程序。</li>
<li>STAT：該程序目前的狀態，狀態顯示與 ps -l 的 S 旗標相同 (R/S/T/Z)</li>
<li>START：該 process 被觸發啟動的時間；</li>
<li>TIME ：該 process 實際使用 CPU 運行的時間。</li>
<li>COMMAND：該程序的實際指令為何？<br>一般來說，ps aux 會依照 PID 的順序來排序顯示，我們還是以 14836 那個 PID 那行來說明！該行的意義為“ root 執行的 bash PID 為 14836，佔用了 0.1% 的內存容量百分比，狀態為休眠 (S)，該程序啟動的時間為 8 月 4 號，因此啟動太久了， 所以沒有列出實際的時間點。且取得的終端機環境為 pts/0 。”與 ps aux 看到的其實是同一個程序啦！這樣可以理解嗎？ 讓我們繼續使用 ps 來觀察一下其他的信息吧！</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="top"><a href="#top" class="headerlink" title="top"></a>top</h2><p>相對於 ps 是擷取一個時間點的程序狀態， top 則可以持續偵測程序運行的狀態！使用方式如下：</p>
<p><br></p>
<h3 id="語法-22"><a href="#語法-22" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# top [-d 數字] | top [-bnp]</span><br><span class="line">選項與參數：</span><br><span class="line">-d  ：後面可以接秒數，就是整個程序畫面更新的秒數。默認是 5 秒；</span><br><span class="line">-b  ：以批次的方式執行 top ，還有更多的參數可以使用喔！</span><br><span class="line">      通常會搭配數據流重導向來將批次的結果輸出成為文件。</span><br><span class="line">-n  ：與 -b 搭配，意義是，需要進行幾次 top 的輸出結果。</span><br><span class="line">-p  ：指定某些個 PID 來進行觀察監測而已。</span><br><span class="line">在 top 執行過程當中可以使用的按鍵指令：</span><br><span class="line">	? ：顯示在 top 當中可以輸入的按鍵指令；</span><br><span class="line">	P ：以 CPU 的使用資源排序顯示；</span><br><span class="line">	M ：以 Memory 的使用資源排序顯示；</span><br><span class="line">	N ：以 PID 來排序喔！</span><br><span class="line">	T ：由該 Process 使用的 CPU 時間累積 (TIME+) 排序。</span><br><span class="line">	k ：給予某個 PID 一個訊號  (signal)</span><br><span class="line">	r ：給予某個 PID 重新制訂一個 nice 值。</span><br><span class="line">	q ：離開 top 軟件的按鍵。</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="pstree"><a href="#pstree" class="headerlink" title="pstree"></a>pstree</h2><h3 id="語法-23"><a href="#語法-23" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# pstree [-A|U] [-up]</span><br><span class="line">選項與參數：</span><br><span class="line">-A  ：各程序樹之間的連接以 ASCII 字符來連接；</span><br><span class="line">-U  ：各程序樹之間的連接以萬國碼的字符來連接。在某些終端接口下可能會有錯誤；</span><br><span class="line">-p  ：並同時列出每個 process 的 PID；</span><br><span class="line">-u  ：並同時列出每個 process 的所屬帳號名稱。</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="nice"><a href="#nice" class="headerlink" title="nice"></a>nice</h2><h3 id="語法-24"><a href="#語法-24" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# nice [-n 數字] command</span><br><span class="line">選項與參數：</span><br><span class="line">-n  ：後面接一個數值，數值的範圍 -20 ~ 19。</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="renice"><a href="#renice" class="headerlink" title="renice"></a>renice</h2><h3 id="語法-25"><a href="#語法-25" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# renice [number] PID</span><br><span class="line">選項與參數：</span><br><span class="line">PID ：某個程序的 ID 啊！</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="free"><a href="#free" class="headerlink" title="free"></a>free</h2><p>觀察內存使用情況</p>
<p><br></p>
<h3 id="語法-26"><a href="#語法-26" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# free [-b|-k|-m|-g|-h] [-t] [-s N -c N]</span><br><span class="line">選項與參數：</span><br><span class="line">-b  ：直接輸入 free 時，顯示的單位是 KBytes，我們可以使用 b(Bytes), m(MBytes)</span><br><span class="line">      k(KBytes), 及 g(GBytes) 來顯示單位喔！也可以直接讓系統自己指定單位 (-h)</span><br><span class="line">-t  ：在輸出的最終結果，顯示實體內存與 swap 的總量。</span><br><span class="line">-s  ：可以讓系統每幾秒鐘輸出一次，不間斷的一直輸出的意思！對於系統觀察挺有效！</span><br><span class="line">-c  ：與 -s 同時處理～讓 free 列出幾次的意思～</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="備註"><a href="#備註" class="headerlink" title="備註"></a>備註</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# free -m</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           2848         346        1794           8         706        2263</span><br><span class="line">Swap:          1023           0        1023</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>名稱</th>
<th>意義</th>
</tr>
</thead>
<tbody>
<tr>
<td>swap</td>
<td>內存交換空間的量</td>
</tr>
<tr>
<td>total</td>
<td>總量</td>
</tr>
<tr>
<td>used</td>
<td>已被使用的量</td>
</tr>
<tr>
<td>free</td>
<td>剩餘可用的量</td>
</tr>
<tr>
<td>shared/buffers/cached</td>
<td>已被使用的量中，用來作為緩衝及高速緩存的量。 <br> 這些用量中，在系統比較忙碌時，可以被釋出而繼續利用</td>
</tr>
</tbody>
</table>
<p><br><br><br><br><br></p>
<h2 id="uname"><a href="#uname" class="headerlink" title="uname"></a>uname</h2><p>查閱系統與核心相關信息</p>
<p><br></p>
<h3 id="語法-27"><a href="#語法-27" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# uname [-asrmpi]</span><br><span class="line">選項與參數：</span><br><span class="line">-a  ：所有系統相關的信息，包括下面的數據都會被列出來；</span><br><span class="line">-s  ：系統核心名稱</span><br><span class="line">-r  ：核心的版本</span><br><span class="line">-m  ：本系統的硬件名稱，例如 i686 或 x86_64 等；</span><br><span class="line">-p  ：CPU 的類型，與 -m 類似，只是顯示的是 CPU 的類型！</span><br><span class="line">-i  ：硬件的平臺 (ix86)</span><br><span class="line"></span><br><span class="line">範例一：輸出系統的基本信息</span><br><span class="line">[root@study ~]# uname -a</span><br><span class="line">Linux study.centos.vbird 3.10.0-229.el7.x86_64 #1 SMP Fri Mar 6 11:36:42 UTC 2015 </span><br><span class="line">x86_64 x86_64 x86_64 GNU/Linux</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="uptime"><a href="#uptime" class="headerlink" title="uptime"></a>uptime</h2><p>觀察系統啟動時間與工作負載<br>這個指令很單純:</p>
<ul>
<li>顯示出目前系統已經開機多久的時間</li>
<li>1, 5, 15 分鐘的平均負載<br>這個 uptime 可以顯示出 top 畫面的最上面一行</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="netstat-1"><a href="#netstat-1" class="headerlink" title="netstat"></a>netstat</h2><p>追蹤網絡或插槽檔</p>
<p><br></p>
<h3 id="語法-28"><a href="#語法-28" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# uname [-asrmpi]</span><br><span class="line">選項與參數：</span><br><span class="line">-a  ：所有系統相關的信息，包括下面的數據都會被列出來；</span><br><span class="line">-s  ：系統核心名稱</span><br><span class="line">-r  ：核心的版本</span><br><span class="line">-m  ：本系統的硬件名稱，例如 i686 或 x86_64 等；</span><br><span class="line">-p  ：CPU 的類型，與 -m 類似，只是顯示的是 CPU 的類型！</span><br><span class="line">-i  ：硬件的平臺 (ix86)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="備註-1"><a href="#備註-1" class="headerlink" title="備註"></a>備註</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# netstat</span><br><span class="line">Active Internet connections (w/o servers) &lt;==與網絡較相關的部分</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span><br><span class="line">tcp        0      0 172.16.15.100:ssh       172.16.220.234:48300    ESTABLISHED</span><br><span class="line">Active UNIX domain sockets (w/o servers)  &lt;==與本機的程序自己的相關性(非網絡)</span><br><span class="line">Proto RefCnt Flags       Type       State         I-Node   Path</span><br><span class="line">unix  2      [ ]         DGRAM                    1902     @/org/freedesktop/systemd1/notify</span><br><span class="line">unix  2      [ ]         DGRAM                    1944     /run/systemd/shutdownd</span><br><span class="line">....(中間省略)....</span><br><span class="line">unix  3      [ ]         STREAM     CONNECTED     25425    @/tmp/.X11-unix/X0</span><br><span class="line">unix  3      [ ]         STREAM     CONNECTED     28893</span><br><span class="line">unix  3      [ ]         STREAM     CONNECTED     21262</span><br></pre></td></tr></table></figure>
<p>在上面的結果當中，顯示了兩個部分:</p>
<ul>
<li>網絡的連線</li>
<li>linux 上面的 socket 程序相關性部分</li>
</ul>
<p>我們先來看看網際網絡連線情況的部分：</p>
<ul>
<li>Proto ：網絡的封包協定，主要分為 TCP 與 UDP 封包，相關數據請參考<a href="http://linux.vbird.org/linux_server" target="_blank" rel="noopener">服務器篇</a>；</li>
<li>Recv-Q：非由使用者程序鏈接到此 socket 的複製的總 Bytes 數；</li>
<li>Send-Q：非由遠端主機傳送過來的 acknowledged 總 Bytes 數；</li>
<li>Local Address ：本地端的 IP:port 情況</li>
<li>Foreign Address：遠端主機的 IP:port 情況</li>
<li>State ：連線狀態，主要有創建(ESTABLISED)及監聽(LISTEN)；</li>
</ul>
<p>我們看上面僅有一條連線的數據，他的意義是：“通過 TCP 封包的連線，遠端的 172.16.220.234:48300 連線到本地端的 172.16.15.100:ssh ，這條連線狀態是創建 (ESTABLISHED) 的狀態！”至於更多的網絡環境說明， 就得到<a href="http://linux.vbird.org/linux_server" target="_blank" rel="noopener">鳥哥的另一本服務器篇</a>查閱囉！</p>
<p>socket file:</p>
<ul>
<li>插槽檔</li>
<li>溝通兩個程序之間的信息</li>
</ul>
<p>上表中 socket file 的輸出字段:</p>
<ul>
<li>Proto ：一般就是 unix 啦；</li>
<li>RefCnt：連接到此 socket 的程序數量；</li>
<li>Flags ：連線的旗標；</li>
<li>Type ：socket 存取的類型。主要有確認連線的 STREAM 與不需確認的 DGRAM 兩種；</li>
<li>State ：若為 CONNECTED 表示多個程序之間已經連線創建。</li>
<li>Path ：連接到此 socket 的相關程序的路徑！或者是相關數據輸出的路徑。</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="dmesg"><a href="#dmesg" class="headerlink" title="dmesg"></a>dmesg</h2><p>分析核心產生的訊息</p>
<p>系統在開機的時候，核心會去偵測系統的硬件，你的某些硬件到底有沒有被捉到，那就與這個時候的偵測有關。 <strong>dmesg 可以顯示這些偵測的過程</strong></p>
<p><br></p>
<h3 id="範例-13"><a href="#範例-13" class="headerlink" title="範例"></a>範例</h3><p>範例一：輸出所有的核心開機時的信息<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">dmesg | less</span><br></pre></td></tr></table></figure></p>
<p>範例二：搜尋開機的時候，硬盤的相關信息為何？<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">dmesg | grep -i vda</span><br></pre></td></tr></table></figure></p>
<p>輸出：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[    0.758551]  vda: vda1 vda2 vda3 vda4 vda5 vda6 vda7 vda8 vda9</span><br><span class="line">[    3.964134] XFS (vda2): Mounting V4 Filesystem</span><br><span class="line">....(下面省略)....</span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<h2 id="vmstat"><a href="#vmstat" class="headerlink" title="vmstat"></a>vmstat</h2><p>偵測系統資源變化<br>vmstat 可以偵測“ CPU / 內存 / 磁盤輸入輸出狀態 ”等等</p>
<p><br></p>
<h3 id="語法-29"><a href="#語法-29" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# vmstat [-a] [延遲 [總計偵測次數]] &lt;==CPU/內存等信息</span><br><span class="line">[root@study ~]# vmstat [-fs]                      &lt;==內存相關</span><br><span class="line">[root@study ~]# vmstat [-S 單位]                  &lt;==設置顯示數據的單位</span><br><span class="line">[root@study ~]# vmstat [-d]                       &lt;==與磁盤有關</span><br><span class="line">[root@study ~]# vmstat [-p 分區]                &lt;==與磁盤有關</span><br><span class="line">選項與參數：</span><br><span class="line">-a  ：使用 inactive/active(活躍與否) 取代 buffer/cache 的內存輸出信息；</span><br><span class="line">-f  ：開機到目前為止，系統複製 (fork) 的程序數；</span><br><span class="line">-s  ：將一些事件 (開機至目前為止) 導致的內存變化情況列表說明；</span><br><span class="line">-S  ：後面可以接單位，讓顯示的數據有單位。例如 K/M 取代 Bytes 的容量；</span><br><span class="line">-d  ：列出磁盤的讀寫總量統計表</span><br><span class="line">-p  ：後面列出分區，可顯示該分區的讀寫總量統計表</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-14"><a href="#範例-14" class="headerlink" title="範例"></a>範例</h3><h4 id="範例一：統計目前主機-CPU-狀態，每秒一次，共計三次！"><a href="#範例一：統計目前主機-CPU-狀態，每秒一次，共計三次！" class="headerlink" title="範例一：統計目前主機 CPU 狀態，每秒一次，共計三次！"></a>範例一：統計目前主機 CPU 狀態，每秒一次，共計三次！</h4><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">vmstat 1 3</span><br></pre></td></tr></table></figure>
<p>範例輸出：<br><img src="https://lh3.googleusercontent.com/jrRJScb-pQMJCDVUtEsOT5wvTB-VDkwyo5O0Rxz7NGrty0dO2n-51ewRk0G36FreHEeNZ5yn9ZsPQaDbiOR5cEeIal3heroIdozwlzaSw6dKYTAiykMa7Vik7P2niLeo_2devH-z7HSqt7b62hdjMJVGMy-l6DFwag_J04pdByCBMRgvQFjFV0BJkk9-5CivP99nkq97HRJ71Q5OeQ2Gz7iJYt7iJRPUOre4ZBXsDqqgCLtz__7sLX-H1cAmmxiUR5CoD_ZGCplK1I_dmog9pkCjjJMiLHq6a--WZtntCE3BgPthkKMUjoAbNiUIXMZs4fMkBsreYprosZS-YZ3tlNU2ktJ0o0IErBEVrLlHSnnSej431wuUwgok3Mm7SIo5a0OeBU7IusUJW4nAdJ1miQxT0ChmV2G1yGYsuIUP1xt2phgwmM0AbbC7ufv4Ie6wYgjtF8tCx0foKbR_CDV9ieP1fdmtJTJrS1GsryeIJBd77m1gRAnttA2q5DbgMbMsBDVPr8oEKpWSBc246eOJ6-2IgRNf94YhGPU1TUE8CahfrE8rMpxU_mHXio9s7EyrPoWhByfNZYJtl-WmSSTj5_f1KwGhfiBBOztcmBQy0jy-I70qxdqGn4hFhHoh_wie-QZQrLxO4PGRO_PoP72aAQL_f_27M8_KDI8Zq9SEP99QbAaed32EIzo=w976-h138-no" alt></p>
<p><br></p>
<h4 id="範例二：系統上面所有的磁盤的讀寫狀態"><a href="#範例二：系統上面所有的磁盤的讀寫狀態" class="headerlink" title="範例二：系統上面所有的磁盤的讀寫狀態"></a>範例二：系統上面所有的磁盤的讀寫狀態</h4><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">vmstat -d</span><br></pre></td></tr></table></figure>
<p>範例輸出：<br><img src="https://lh3.googleusercontent.com/d6tEtO4_J_LcDP0YYQA1lwdmswV8N9YGLnXNVe5tx0oqVdyP_1OAW_R0DSmxNbVnpUvzVV4OWp3oYsL0CYCMgqf0DgSw1qZ-_mbvzlNdCMukoAiiSeppxH43gUBI9Am_ghjIVrljdOthya0XRQmDx1kqBL5m6EzWjiansImEfV6G37OfJxlyyi7q4bfKDjA0jFbFMHXAYJcc7X3t1_P2lKat8KwhO903Bv0WFyKMFRVMbtIg2zUmOHeSIG1NGdqjFbAhCPDViiGO5DJpaj8KgHAMLHlD4d3EUTC8NqdqhhfTRwUKi3jTcrvj4ymhbMchvXU3x-X56EN1qwcGvY_Z9AFXnK_1dnUOmD9sCy5o9xnc5Kez6MuvkspjKKttxw-a_xW0vkXP49biRDKUtpWXaM9kV8256925pqdc_bliYa3XDHVfTJz7O_fOjtzqlDUu_igu0Pxw3oV7V6aKtuOzN0inl4e5M5dhkCIVNcFKfw-1TyevCQNy7Zjm7gFdbZIj6f7Tu1FIoGvYfTL7b8sx7jSCHtjQ9CxZ3dAIn47rVjzqwg8ZzcNnzMzhS4GhKiFnH7z2zcaq-8w2A1SxALM2M9cvBmLCmoH-4sGbr-0VLEhu8wAObMFF9pSuwHHIEBCL6fPkaSDvV2-X4heMzET9mhEZxMYaSN0H_f6szQs_sSIbrU_ZKGLgKyY=w954-h304-no" alt></p>
<p>利用 vmstat 甚至可以進行追蹤喔！你可以使用類似“ vmstat 5 ”代表每五秒鐘更新一次，且無窮的更新！直到你按下 [ctrl]-c 為止。如果你想要實時的知道系統資源的運行狀態，這個指令就不能不知道！那麼上面的表格各項字段的意義為何？ 基本說明如下：</p>
<ul>
<li><p>程序字段 (procs) 的項目分別為：</p>
<ul>
<li>r ：等待運行中的程序數量；</li>
<li>b：不可被喚醒的程序數量。這兩個項目越多，代表系統越忙碌 (因為系統太忙，所以很多程序就無法被執行或一直在等待而無法被喚醒之故)。</li>
</ul>
</li>
<li><p>內存字段 (memory) 項目分別為：</p>
<ul>
<li>swpd：虛擬內存被使用的容量； </li>
<li>free：未被使用的內存容量； </li>
<li>buff：用於緩衝內存； </li>
<li>cache：用於高速緩存內存。 這部份則與 free 是相同的。</li>
</ul>
</li>
<li><p>內存交換空間 (swap) 的項目分別為：</p>
<ul>
<li>si：由磁盤中將程序取出的量； </li>
<li>so：由於內存不足而將沒用到的程序寫入到磁盤的 swap 的容量。 如果 si/so 的數值太大，表示內存內的數據常常得在磁盤與內存之間傳來傳去，系統性能會很差！</li>
</ul>
</li>
<li><p>磁盤讀寫 (io) 的項目分別為：</p>
<ul>
<li>bi：由磁盤讀入的區塊數量； </li>
<li>bo：寫入到磁盤去的區塊數量。如果這部份的值越高，代表系統的 I/O 非常忙碌！</li>
</ul>
</li>
<li><p>系統 (system) 的項目分別為：</p>
<ul>
<li>in：每秒被中斷的程序次數； </li>
<li>cs：每秒鐘進行的事件切換次數；這兩個數值越大，代表系統與周邊設備的溝通非常頻繁！ 這些周邊設備當然包括磁盤、網卡、時間鍾等。</li>
</ul>
</li>
<li><p>CPU 的項目分別為：</p>
<ul>
<li>us：非核心層的 CPU 使用狀態； </li>
<li>sy：核心層所使用的 CPU 狀態； </li>
<li>id：閒置的狀態； </li>
<li>wa：等待 I/O 所耗費的 CPU 狀態； </li>
<li>st：被虛擬機 (virtual machine) 所盜用的 CPU 使用狀態 (2.6.11 以後才支持)。</li>
</ul>
</li>
</ul>
<h2 id="proc"><a href="#proc" class="headerlink" title="/proc"></a>/proc</h2><p>基本上，目前主機上面的各個程序的 PID 都是以目錄的型態存在於 /proc 當中。 舉例來說，我們開機所執行的第一支程序 systemd 他的 PID 是 1 ， 這個 PID 的所有相關信息都寫入在 /proc/1/* 當中！若我們直接觀察 PID 為 1 的數據好了，他有點像這樣：</p>
<p><br></p>
<h3 id="文件內容"><a href="#文件內容" class="headerlink" title="文件內容"></a>文件內容</h3><table>
<thead>
<tr>
<th>文件名</th>
<th>文件內容</th>
</tr>
</thead>
<tbody>
<tr>
<td>/proc/cmdline</td>
<td>載入 kernel 時所下達的相關指令與參數！查閱此文件，可瞭解指令是如何啟動的！</td>
</tr>
<tr>
<td>/proc/cpuinfo</td>
<td>本機的 CPU 的相關信息，包含頻率、類型與運算功能等</td>
</tr>
<tr>
<td>/proc/devices</td>
<td>這個文件記錄了系統各個主要設備的主要設備代號，與 mknod 有關呢！</td>
</tr>
<tr>
<td>/proc/filesystems</td>
<td>目前系統已經載入的文件系統囉！</td>
</tr>
<tr>
<td>/proc/interrupts</td>
<td>目前系統上面的 IRQ 分配狀態。</td>
</tr>
<tr>
<td>/proc/ioports</td>
<td>目前系統上面各個設備所配置的 I/O 位址。</td>
</tr>
<tr>
<td>/proc/kcore</td>
<td>這個就是內存的大小啦！好大對吧！但是不要讀他啦！</td>
</tr>
<tr>
<td>/proc/loadavg</td>
<td>還記得 top 以及 uptime 吧？沒錯！上頭的三個平均數值就是記錄在此！</td>
</tr>
<tr>
<td>/proc/meminfo</td>
<td>使用 free 列出的內存信息，嘿嘿！在這裡也能夠查閱到！</td>
</tr>
<tr>
<td>/proc/modules</td>
<td>目前我們的 Linux 已經載入的模塊列表，也可以想成是驅動程序啦！</td>
</tr>
<tr>
<td>/proc/mounts</td>
<td>系統已經掛載的數據，就是用 mount 這個指令調用出來的數據啦！</td>
</tr>
<tr>
<td>/proc/swaps</td>
<td>到底系統掛載入的內存在哪裡？呵呵！使用掉的 partition 就記錄在此啦！</td>
</tr>
<tr>
<td>/proc/partitions</td>
<td>使用 fdisk -l 會出現目前所有的 partition 吧？在這個文件當中也有紀錄喔！</td>
</tr>
<tr>
<td>/proc/uptime</td>
<td>就是用 uptime 的時候，會出現的信息啦！</td>
</tr>
<tr>
<td>/proc/version</td>
<td>核心的版本，就是用 uname -a 顯示的內容啦！</td>
</tr>
<tr>
<td>/proc/bus/*</td>
<td>一些總線的設備，還有 USB 的設備也記錄在此喔！</td>
</tr>
</tbody>
</table>
<h2 id="fuser"><a href="#fuser" class="headerlink" title="fuser"></a>fuser</h2><p>藉由文件(或文件系統)找出正在使用該文件的程序</p>
<p><br></p>
<h3 id="語法-30"><a href="#語法-30" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# fuser [-umv] [-k [i] [-signal]] file/dir</span><br><span class="line">選項與參數：</span><br><span class="line">-u  ：除了程序的 PID 之外，同時列出該程序的擁有者；</span><br><span class="line">-m  ：後面接的那個文件名會主動的上提到該文件系統的最頂層，對 umount 不成功很有效！</span><br><span class="line">-v  ：可以列出每個文件與程序還有指令的完整相關性！</span><br><span class="line">-k  ：找出使用該文件/目錄的 PID ，並試圖以 SIGKILL 這個訊號給予該 PID；</span><br><span class="line">-i  ：必須與 -k 配合，在刪除 PID 之前會先詢問使用者意願！</span><br><span class="line">-signal：例如 -1 -15 等等，若不加的話，默認是 SIGKILL (-9) 囉！</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-15"><a href="#範例-15" class="headerlink" title="範例"></a>範例</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">範例一：找出目前所在目錄的使用 PID/所屬帳號/權限 為何？</span><br><span class="line">[root@study ~]# fuser -uv .</span><br><span class="line">                     USER        PID ACCESS COMMAND</span><br><span class="line">/root:               root      13888 ..c.. (root)bash</span><br><span class="line">                     root      31743 ..c.. (root)bash</span><br><span class="line">```</span><br></pre></td></tr></table></figure>
<p>範例二：找到所有使用到 /proc 這個文件系統的程序吧！<br>[root@study ~]# fuser -uv /proc<br>/proc:               root     kernel mount (root)/proc<br>                     rtkit       768 .rc.. (rtkit)rtkit-daemon</p>
<h1 id="數據量還不會很多，雖然這個目錄很繁忙～沒關係！我們可以繼續這樣作，看看其他的程序！"><a href="#數據量還不會很多，雖然這個目錄很繁忙～沒關係！我們可以繼續這樣作，看看其他的程序！" class="headerlink" title="數據量還不會很多，雖然這個目錄很繁忙～沒關係！我們可以繼續這樣作，看看其他的程序！"></a>數據量還不會很多，雖然這個目錄很繁忙～沒關係！我們可以繼續這樣作，看看其他的程序！</h1><p>[root@study ~]# fuser -mvu /proc<br>                     USER        PID ACCESS COMMAND<br>/proc:               root     kernel mount (root)/proc<br>                     root          1 f…. (root)systemd<br>                     root          2 …e. (root)kthreadd<br>…..(下面省略)…..</p>
<h1 id="有這幾支程序在進行-proc-文件系統的存取喔！這樣清楚了嗎？"><a href="#有這幾支程序在進行-proc-文件系統的存取喔！這樣清楚了嗎？" class="headerlink" title="有這幾支程序在進行 /proc 文件系統的存取喔！這樣清楚了嗎？"></a>有這幾支程序在進行 /proc 文件系統的存取喔！這樣清楚了嗎？</h1><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>範例三：找到所有使用到 /home 這個文件系統的程序吧！<br>[root@study ~]# echo $$<br>31743  # 先確認一下，自己的 bash PID 號碼吧！<br>[root@study ~]# cd /home<br>[root@study home]# fuser -muv .<br>                     USER        PID ACCESS COMMAND<br>/home:               root     kernel mount (root)/home<br>                     dmtsai    31535 ..c.. (dmtsai)bash<br>                     root      31571 ..c.. (root)passwd<br>                     root      31737 ..c.. (root)sudo<br>                     root      31743 ..c.. (root)bash    # 果然，自己的 PID 在啊！<br>[root@study home]# cd ~<br>[root@study ~]# umount /home<br>umount: /home: target is busy.<br>        (In some cases useful info about processes that use<br>         the device is found by lsof(8) or fuser(1))</p>
<h1 id="從-fuser-的結果可以知道，總共有五隻-process-在該目錄下運行，那即使-root-離開了-home，"><a href="#從-fuser-的結果可以知道，總共有五隻-process-在該目錄下運行，那即使-root-離開了-home，" class="headerlink" title="從 fuser 的結果可以知道，總共有五隻 process 在該目錄下運行，那即使 root 離開了 /home，"></a>從 fuser 的結果可以知道，總共有五隻 process 在該目錄下運行，那即使 root 離開了 /home，</h1><h1 id="當然還是無法-umount-的！那要怎辦？哈哈！可以通過如下方法一個一個刪除～"><a href="#當然還是無法-umount-的！那要怎辦？哈哈！可以通過如下方法一個一個刪除～" class="headerlink" title="當然還是無法 umount 的！那要怎辦？哈哈！可以通過如下方法一個一個刪除～"></a>當然還是無法 umount 的！那要怎辦？哈哈！可以通過如下方法一個一個刪除～</h1><p>[root@study ~]# fuser -mki /home<br>/home:               31535c 31571c 31737c  # 你會發現， PID 跟上面查到的相同！<br>Kill process 31535 ? (y/N) # 這裡會問你要不要刪除！當然不要亂刪除啦！通通取消！<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">### 那個 ACCESS 的項目，那個項目代表的意義為：</span><br><span class="line">- c ：此程序在當前的目錄下(非次目錄)；</span><br><span class="line">- e ：可被觸發為執行狀態；</span><br><span class="line">- f ：是一個被打開的文件；</span><br><span class="line">- r ：代表頂層目錄 (root directory)；</span><br><span class="line">- F ：該文件被打開了，不過在等待迴應中；</span><br><span class="line">- m ：可能為分享的動態函數庫；</span><br><span class="line"></span><br><span class="line">## lsof</span><br><span class="line">列出被程序所打開的文件文件名</span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">### 語法</span><br></pre></td></tr></table></figure></p>
<p>lsof [-aUu] [+d]<br>選項與參數：<br>-a  ：多項數據需要“同時成立”才顯示出結果時！<br>-U  ：僅列出 Unix like 系統的 socket 文件類型；<br>-u  ：後面接 username，列出該使用者相關程序所打開的文件；<br>+d  ：後面接目錄，亦即找出某個目錄下面已經被打開的文件！<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## pidof</span><br><span class="line">找出某支正在執行的程序的 PID</span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">### 語法</span><br></pre></td></tr></table></figure></p>
<p>pidof [-sx] program_name<br>選項與參數：<br>-s  ：僅列出一個 PID 而不列出所有的 PID<br>-x  ：同時列出該 program name 可能的 PPID 那個程序的 PID<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## systemd</span><br><span class="line">### systemd 的配置文件放置目錄</span><br><span class="line">`/usr/lib/systemd/system/`：每個服務最主要的啟動腳本設置，有點類似以前的 /etc/init.d 下面的文件；</span><br><span class="line">`/run/systemd/system/`：系統執行過程中所產生的服務腳本，這些腳本的優先序要比 /usr/lib/systemd/system/ 高！</span><br><span class="line">`/etc/systemd/system/`：管理員依據主機系統的需求所創建的執行腳本，其實這個目錄有點像以前 /etc/rc.d/rc5.d/Sxx 之類的功能！執行優先序又比 /run/systemd/system/ 高喔！</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">### systemd 服務類型</span><br><span class="line">擴展名 | 主要服務功能</span><br><span class="line">------|</span><br><span class="line">.service | 一般服務類型 (service unit)：主要是系統服務，包括服務器本身所需要的本機服務以及網絡服務都是！比較經常被使用到的服務大多是這種類型！ 所以，這也是最常見的類型了！</span><br><span class="line">.socket	| 內部程序數據交換的插槽服務 (socket unit)：主要是 IPC (Inter-process communication) 的傳輸訊息插槽檔 (socket file) 功能。 這種類型的服務通常在監控訊息傳遞的插槽檔，當有通過此插槽檔傳遞訊息來說要鏈接服務時，就依據當時的狀態將該用戶的要求傳送到對應的 daemon， 若 daemon 尚未啟動，則啟動該 daemon 後再傳送用戶的要求。&lt;/br&gt;使用 socket 類型的服務一般是比較不會被用到的服務，因此在開機時通常會稍微延遲啟動的時間 (因為比較沒有這麼常用嘛！)。一般用於本機服務比較多，例如我們的圖形界面很多的軟件都是通過 socket 來進行本機程序數據交換的行為。 (這與早期的 xinetd 這個 super daemon 有部份的相似喔！)</span><br><span class="line">.target | 執行環境類型 (target unit)：其實是一群 unit 的集合，例如上面表格中談到的 multi-user.target 其實就是一堆服務的集合～也就是說， 選擇執行 multi-user.target, 就是執行一堆其他 .service 或/及 .socket 之類的服務就是了！</span><br><span class="line">.mount &lt;/br&gt; .automount | 文件系統掛載相關的服務 (automount unit / mount unit)：例如來自網絡的自動掛載、NFS 文件系統掛載等與文件系統相關性較高的程序管理。</span><br><span class="line">.path | 偵測特定文件或目錄類型 (path unit)：某些服務需要偵測某些特定的目錄來提供佇列服務，例如最常見的打印服務，就是通過偵測打印佇列目錄來啟動打印功能！ 這時就得要 .path 的服務類型支持了！</span><br><span class="line">.timer | 循環執行的服務 (timer unit)：這個東西有點類似 anacrontab 喔！不過是由 systemd 主動提供的，比 anacrontab 更加有彈性！</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">### systemctl</span><br><span class="line">管理單一服務 (service unit) 的啟動/開機啟動與觀察狀態</span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">#### 語法</span><br></pre></td></tr></table></figure></p>
<p>systemctl [command] [unit]<br>command 主要有：<br>start     ：立刻啟動後面接的 unit<br>stop      ：立刻關閉後面接的 unit<br>restart   ：立刻關閉後啟動後面接的 unit，亦即執行 stop 再 start 的意思<br>reload    ：不關閉後面接的 unit 的情況下，重新載入配置文件，讓設置生效<br>enable    ：設置下次開機時，後面接的 unit 會被啟動<br>disable   ：設置下次開機時，後面接的 unit 不會被啟動<br>status    ：目前後面接的這個 unit 的狀態，會列出有沒有正在執行、開機默認執行否、登錄等信息等！<br>is-active ：目前有沒有正在運行中<br>is-enable ：開機時有沒有默認要啟用這個 unit<br>is-enable ：開機時有沒有默認要啟用這個 unit<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>systemctl [command] [–type=TYPE] [–all]<br>command:<br>    list-units      ：依據 unit 列出目前有啟動的 unit。若加上 –all 才會列出沒啟動的。<br>    list-unit-files ：依據 /usr/lib/systemd/system/ 內的文件，將所有文件列表說明。<br>–type=TYPE：就是之前提到的 unit type，主要有 service, socket, target 等<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">#### unit 狀態</span><br></pre></td></tr></table></figure></p>
<p>systemctl list-units<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">UNIT                      | LOAD   | ACTIVE | SUB      | DESCRIPTION</span><br><span class="line">---|---|---|---|</span><br><span class="line">proc-sys-fs-binfmt_mis... | loaded | active | waiting  | Arbitrary Executable File Formats File System|||   |</span><br><span class="line">sys-devices-pc...:0:1:... | loaded | active | plugged  | QEMU_HARDDISK</span><br><span class="line">sys-devices-pc...0:1-0... | loaded | active | plugged  | QEMU_HARDDISK</span><br><span class="line">sys-devices-pc...0:0-1... | loaded | active | plugged  | QEMU_DVD-ROM</span><br><span class="line">.....(中間省略).....vsftpd.service            | loaded | active | running  | Vsftpd ftp daemon</span><br><span class="line">.....(中間省略).....cups.socket               | loaded | failed | failed   | CUPS Printing Service Sockets.....(中間省略).....</span><br><span class="line"></span><br><span class="line">LOAD   = Reflects whether the unit definition was properly loaded.</span><br><span class="line"></span><br><span class="line">ACTIVE = The high-level unit activation state, i.e. generalization of SUB.</span><br><span class="line"></span><br><span class="line">SUB    = The low-level unit activation state, values depend on unit type.</span><br><span class="line"></span><br><span class="line">141 loaded units listed. Pass --all to see loaded but inactive units, too.</span><br><span class="line"></span><br><span class="line">To show all installed unit files use &apos;systemctl list-unit-files&apos;.</span><br><span class="line"></span><br><span class="line">列出的項目中，主要的意義是：</span><br><span class="line">- UNIT   ：項目的名稱，包括各個 unit 的類別 (看擴展名)</span><br><span class="line">- LOAD   ：開機時是否會被載入，默認 systemctl 顯示的是有載入的項目而已喔！</span><br><span class="line">- ACTIVE ：目前的狀態，須與後續的 SUB 搭配！就是我們用 systemctl status 觀察時，active 的項目！</span><br><span class="line">- DESCRIPTION ：詳細描述囉</span><br><span class="line">- cups 比較有趣，因為剛剛被我們玩過，所以 ACTIVE 竟然是 failed 的喔！被玩死了！ ^_^</span><br><span class="line">- 另外，systemctl 都不加參數，其實默認就是 list-units 的意思！</span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">#### active 狀態</span><br><span class="line">狀態 | 解釋</span><br><span class="line">-----------------|</span><br><span class="line">active (running)| 正有一隻或多隻程序正在系統中執行的意思，舉例來說，正在執行中的 vsftpd 就是這種模式。</span><br><span class="line">active (exited)| 僅執行一次就正常結束的服務，目前並沒有任何程序在系統中執行。 舉例來說，開機或者是掛載時才會進行一次的 quotaon 功能，就是這種模式！ quotaon 不須一直執行～只須執行一次之後，就交給文件系統去自行處理囉！通常用 bash shell 寫的小型服務，大多是屬於這種類型 (無須常駐內存)。</span><br><span class="line">active (waiting)| 正在執行當中，不過還再等待其他的事件才能繼續處理。舉例來說，打印的佇列相關服務就是這種狀態！ 雖然正在啟動中，不過，也需要真的有佇列進來 (打印工作) 這樣他才會繼續喚醒打印機服務來進行下一步打印的功能。</span><br><span class="line">inactive| 這個服務目前沒有運行的意思。</span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">#### daemon 默認狀態</span><br><span class="line">狀態 | 解釋</span><br><span class="line">----|</span><br><span class="line">enabled | 這個 daemon 將在開機時被執行</span><br><span class="line">disabled | 這個 daemon 在開機時不會被執行</span><br><span class="line">static | 這個 daemon 不可以自己啟動 (enable 不可)，不過可能會被其他的 enabled 的服務來喚醒 (相依屬性的服務)</span><br><span class="line">mask | 這個 daemon 無論如何都無法被啟動！因為已經被強制註銷 (非刪除)。可通過 systemctl unmask 方式改回原本狀態</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line"></span><br><span class="line">#### 管理不同的操作環境</span><br><span class="line">```bash</span><br><span class="line">systemctl list-units --type=target --all</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">UNIT                   LOAD   ACTIVE   SUB    DESCRIPTION</span><br><span class="line">basic.target           loaded active   active Basic System</span><br><span class="line">cryptsetup.target      loaded active   active Encrypted Volumes</span><br><span class="line">emergency.target       loaded inactive dead   Emergency Mode</span><br><span class="line">final.target           loaded inactive dead   Final Step</span><br><span class="line">getty.target           loaded active   active Login Prompts</span><br><span class="line">graphical.target       loaded active   active Graphical Interface</span><br><span class="line">local-fs-pre.target    loaded active   active Local File Systems (Pre)</span><br><span class="line">local-fs.target        loaded active   active Local File Systems</span><br><span class="line">multi-user.target      loaded active   active Multi-User System</span><br><span class="line">network-online.target  loaded inactive dead   Network is Online</span><br><span class="line">network.target         loaded active   active Network</span><br><span class="line">nss-user-lookup.target loaded inactive dead   User and Group Name Lookups</span><br><span class="line">paths.target           loaded active   active Paths</span><br><span class="line">remote-fs-pre.target   loaded active   active Remote File Systems (Pre)</span><br><span class="line">remote-fs.target       loaded active   active Remote File Systems</span><br><span class="line">rescue.target          loaded inactive dead   Rescue Mode</span><br><span class="line">shutdown.target        loaded inactive dead   Shutdown</span><br><span class="line">slices.target          loaded active   active Slices</span><br><span class="line">sockets.target         loaded active   active Sockets</span><br><span class="line">sound.target           loaded active   active Sound Card</span><br><span class="line">swap.target            loaded active   active Swap</span><br><span class="line">sysinit.target         loaded active   active System Initialization</span><br><span class="line">syslog.target          not-found inactive dead   syslog.target</span><br><span class="line">time-sync.target       loaded inactive dead   System Time Synchronized</span><br><span class="line">timers.target          loaded active   active Timers</span><br><span class="line">umount.target          loaded inactive dead   Unmount All Filesystems</span><br><span class="line"></span><br><span class="line">LOAD   = Reflects whether the unit definition was properly loaded.</span><br><span class="line">ACTIVE = The high-level unit activation state, i.e. generalization of SUB.</span><br><span class="line">SUB    = The low-level unit activation state, values depend on unit type.</span><br><span class="line"></span><br><span class="line">26 loaded units listed.</span><br><span class="line">To show all installed unit files use &apos;systemctl list-unit-files&apos;.</span><br></pre></td></tr></table></figure>
<ul>
<li>graphical.target：就是文字加上圖形界面，這個項目已經包含了下面的 multi-user.target 項目！</li>
<li>multi-user.target：純文本模式！</li>
<li>rescue.target：在無法使用 root 登陸的情況下，systemd 在開機時會多加一個額外的暫時系統，與你原本的 系統無關。這時你可以取得 root 的權限來維護你的系統。 但是這是額外系統，因此可能需要動到 chroot 的方式來取得你原有的系統喔！</li>
<li>emergency.target：緊急處理系統的錯誤，還是需要使用 root 登陸的情況，在無法使用 rescue.target 時，可以嘗試使用這種模式！</li>
<li>shutdown.target：就是關機的流程。</li>
<li>getty.target：可以設置你需要幾個 tty 之類的，如果想要降低 tty 的項目，可以修改這個東西的配置文件！</li>
</ul>
<p><br></p>
<h4 id="取得目前的操作環境以及修改"><a href="#取得目前的操作環境以及修改" class="headerlink" title="取得目前的操作環境以及修改"></a>取得目前的操作環境以及修改</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">systemctl [command] [unit.target]</span><br><span class="line">選項與參數：</span><br><span class="line">command:</span><br><span class="line">    get-default ：取得目前的 target </span><br><span class="line">    set-default ：設置後面接的 target 成為默認的操作模式</span><br><span class="line">    isolate     ：切換到後面接的模式</span><br></pre></td></tr></table></figure>
<p><br></p>
<h5 id="範例-16"><a href="#範例-16" class="headerlink" title="範例"></a>範例</h5><p>範例一：我們的測試機器默認是圖形界面，先觀察是否真為圖形模式，再將默認模式轉為文字界面<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# systemctl get-default </span><br><span class="line">graphical.target  # 果然是圖形界面喔！</span><br><span class="line"></span><br><span class="line">[root@study ~]# systemctl set-default multi-user.target</span><br><span class="line">[root@study ~]# systemctl get-default </span><br><span class="line">multi-user.target</span><br></pre></td></tr></table></figure></p>
<p>範例二：在不重新開機的情況下，將目前的操作環境改為純文本模式，關掉圖形界面<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# systemctl isolate multi-user.target</span><br></pre></td></tr></table></figure></p>
<p>範例三：若需要重新取得圖形界面呢？<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# systemctl isolate graphical.target</span><br></pre></td></tr></table></figure></p>
<p>要注意，改變 graphical.target 以及 multi-user.target 是通過 isolate 來處理的。</p>
<p>在正常的切換情況下，使用上述 isolate 的方式即可。不過為了方便起見， systemd 也提供了數個簡單的指令給我們切換操作模式之用喔！ 大致上如下所示：</p>
<p><br></p>
<h4 id="systemctl-針對機器操作的幾個簡單指令"><a href="#systemctl-針對機器操作的幾個簡單指令" class="headerlink" title="systemctl 針對機器操作的幾個簡單指令"></a>systemctl 針對機器操作的幾個簡單指令</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# systemctl poweroff  系統關機</span><br><span class="line">[root@study ~]# systemctl reboot    重新開機</span><br><span class="line">[root@study ~]# systemctl suspend   進入暫停模式</span><br><span class="line">[root@study ~]# systemctl hibernate 進入休眠模式</span><br><span class="line">[root@study ~]# systemctl rescue    強制進入救援模式</span><br><span class="line">[root@study ~]# systemctl emergency 強制進入緊急救援模式</span><br></pre></td></tr></table></figure>
<ul>
<li>suspend：暫停模式會將系統的狀態數據保存到內存中，然後關閉掉大部分的系統硬件，當然，並沒有實際關機喔！ 當使用者按下喚醒機器的按鈕，系統數據會重內存中回覆，然後重新驅動被大部分關閉的硬件，就開始正常運行！喚醒的速度較快。</li>
<li>hibernate：休眠模式則是將系統狀態保存到硬盤當中，保存完畢後，將計算機關機。當使用者嘗試喚醒系統時，系統會開始正常運行， 然後將保存在硬盤中的系統狀態恢復回來。因為數據是由硬盤讀出，因此喚醒的性能與你的硬盤速度有關。</li>
</ul>
<p><br></p>
<h4 id="通過-systemctl-分析各服務之間的相依性"><a href="#通過-systemctl-分析各服務之間的相依性" class="headerlink" title="通過 systemctl 分析各服務之間的相依性"></a>通過 systemctl 分析各服務之間的相依性</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# systemctl list-dependencies [unit] [--reverse]</span><br><span class="line">選項與參數：</span><br><span class="line">--reverse ：反向追蹤誰使用這個 unit 的意思！</span><br></pre></td></tr></table></figure>
<p><br></p>
<h5 id="範例-17"><a href="#範例-17" class="headerlink" title="範例"></a>範例</h5><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">範例一：列出目前的 target 環境下，用到什麼特別的 unit </span><br><span class="line">[root@study ~]# systemctl get-default</span><br><span class="line">multi-user.target</span><br><span class="line"></span><br><span class="line">[root@study ~]# systemctl list-dependencies</span><br><span class="line">default.target</span><br><span class="line">├─abrt-ccpp.service</span><br><span class="line">├─abrt-oops.service</span><br><span class="line">├─vsftpd.service</span><br><span class="line">├─basic.target</span><br><span class="line">│ ├─alsa-restore.service</span><br><span class="line">│ ├─alsa-state.service</span><br><span class="line">.....(中間省略).....</span><br><span class="line">│ ├─sockets.target</span><br><span class="line">│ │ ├─avahi-daemon.socket</span><br><span class="line">│ │ ├─dbus.socket</span><br><span class="line">.....(中間省略).....</span><br><span class="line">│ ├─sysinit.target</span><br><span class="line">│ │ ├─dev-hugepages.mount</span><br><span class="line">│ │ ├─dev-mqueue.mount</span><br><span class="line">.....(中間省略).....</span><br><span class="line">│ └─timers.target</span><br><span class="line">│   └─systemd-tmpfiles-clean.timer</span><br><span class="line">├─getty.target</span><br><span class="line">│ └─getty@tty1.service</span><br><span class="line">└─remote-fs.target</span><br></pre></td></tr></table></figure>
<p>如果要查出誰會用到 multi-user.target 呢？<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">systemctl list-dependencies --reverse</span><br><span class="line">default.target</span><br><span class="line">└─graphical.target</span><br></pre></td></tr></table></figure></p>
<p>graphical.target 又使用了多少的服務呢？<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">systemctl list-dependencies graphical.target</span><br><span class="line">graphical.target</span><br><span class="line">├─accounts-daemon.service</span><br><span class="line">├─gdm.service</span><br><span class="line">├─network.service</span><br><span class="line">├─rtkit-daemon.service</span><br><span class="line">├─systemd-update-utmp-runlevel.service</span><br><span class="line">└─multi-user.target</span><br><span class="line">  ├─abrt-ccpp.service</span><br><span class="line">  ├─abrt-oops.service</span><br><span class="line">.....(下面省略).....</span><br></pre></td></tr></table></figure></p>
<p><br><br><br><br><br></p>
<h2 id="process-substitution-lt-command-or-gt-command"><a href="#process-substitution-lt-command-or-gt-command" class="headerlink" title="process substitution &lt;( command ) or &gt;( command )"></a>process substitution <code>&lt;( command )</code> or <code>&gt;( command )</code></h2><p>如果使用 <code>&gt;(list)</code>, 那帶入的值將會作為 list 的輸入。 若使用 <code>&lt;(list)</code>, 那將會是 list 的輸出</p>
<p><br></p>
<h3 id="語法-31"><a href="#語法-31" class="headerlink" title="語法"></a>語法</h3><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">&lt;(list)</span><br></pre></td></tr></table></figure>
<p>或是</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">&gt;(list)</span><br></pre></td></tr></table></figure>
<h2 id="logrotate"><a href="#logrotate" class="headerlink" title="logrotate"></a>logrotate</h2><p>那個 logrotate.conf 才是主要的參數文件，至於 logrotate.d 是一個目錄， 該目錄裡面的所有文件都會被主動的讀入 /etc/logrotate.conf 當中來進行！另外，在 /etc/logrotate.d/ 裡面的文件中，如果沒有規定到的一些細部設置，則以 /etc/logrotate.conf 這個文件的規定來指定為默認值！</p>
<p><br></p>
<h3 id="logrotate-這個程序的參數配置文件位置"><a href="#logrotate-這個程序的參數配置文件位置" class="headerlink" title="logrotate 這個程序的參數配置文件位置"></a>logrotate 這個程序的參數配置文件位置</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">/etc/logrotate.conf</span><br><span class="line">/etc/logrotate.d/</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="語法-32"><a href="#語法-32" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">logrotate [-vf] logfile</span><br><span class="line">選項與參數：</span><br><span class="line">-v  ：啟動顯示模式，會顯示 logrotate 運行的過程喔！</span><br><span class="line">-f  ：不論是否符合配置文件的數據，強制每個登錄文件都進行 rotate 的動作！</span><br><span class="line"></span><br><span class="line">範例一：執行一次 logrotate 看看整個流程為何？</span><br><span class="line">[root@study ~]# logrotate -v /etc/logrotate.conf</span><br><span class="line">reading config file /etc/logrotate.conf &lt;==讀取主要配置文件</span><br><span class="line">including /etc/logrotate.d              &lt;==調用外部的設置</span><br><span class="line">reading config file chrony              &lt;==就是外部設置啊！</span><br><span class="line">....(中間省略)....</span><br><span class="line">Handling 18 logs                        &lt;==共有 18 個登錄文件被記錄</span><br><span class="line">....(中間省略)....</span><br><span class="line">rotating pattern: /var/log/cron</span><br><span class="line">/var/log/maillog</span><br><span class="line">/var/log/messages</span><br><span class="line">/var/log/secure</span><br><span class="line">/var/log/spooler</span><br><span class="line"> weekly (52 rotations)</span><br><span class="line">empty log files are not rotated, old logs are removed</span><br><span class="line">considering log /var/log/cron</span><br><span class="line">  log does not need rotating</span><br><span class="line">considering log /var/log/maillog</span><br><span class="line">  log does not need rotating</span><br><span class="line">considering log /var/log/messages       &lt;==開始處理 messages</span><br><span class="line">  log does not need rotating            &lt;==因為時間未到，不需要更動！</span><br><span class="line">....(下面省略)....</span><br><span class="line"></span><br><span class="line">範例二：強制進行 logrotate 的動作</span><br><span class="line">[root@study ~]# logrotate -vf /etc/logrotate.conf</span><br><span class="line">....(前面省略)....</span><br><span class="line">rotating log /var/log/messages, log-&gt;rotateCount is 52</span><br><span class="line">dateext suffix &apos;-20150820&apos;</span><br><span class="line">glob pattern &apos;-[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]&apos;</span><br><span class="line">compressing log with: /bin/gzip</span><br><span class="line">....(下面省略)....</span><br><span class="line"># 看到否？整個 rotate 的動作就是這樣一步一步進行的～</span><br><span class="line"></span><br><span class="line">[root@study ~]# ll /var/log/messages*; lsattr /var/log/messages</span><br><span class="line">-rw-------. 1 root root    143 Aug 20 01:45 /var/log/messages</span><br><span class="line">-rw-------. 1 root root 167125 Aug 20 01:40 /var/log/messages-20150820</span><br><span class="line">-----a---------- /var/log/messages  &lt;==主動加入 a 的隱藏屬性囉！</span><br></pre></td></tr></table></figure>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# vim /etc/logrotate.conf</span><br><span class="line"># 下面的設置是 &quot;logrotate 的默認設置值&quot; ，如果個別的文件設置了其他的參數，</span><br><span class="line"># 則將以個別的文件設置為主，若該文件沒有設置到的參數則以這個文件的內容為默認值！</span><br><span class="line"></span><br><span class="line">weekly    &lt;==默認每個禮拜對登錄文件進行一次 rotate 的工作</span><br><span class="line">rotate 4  &lt;==保留幾個登錄文件呢？默認是保留四個！</span><br><span class="line">create    &lt;==由於登錄文件被更名，因此創建一個新的來繼續儲存之意！</span><br><span class="line">dateext   &lt;==就是這個設置值！可以讓被輪替的文件名稱加上日期作為文件名喔！</span><br><span class="line">#compress &lt;==被更動的登錄文件是否需要壓縮？如果登錄文件太大則可考慮此參數啟動</span><br><span class="line"></span><br><span class="line">include /etc/logrotate.d</span><br><span class="line"># 將 /etc/logrotate.d/ 這個目錄中的所有文件都讀進來執行 rotate 的工作！</span><br><span class="line"></span><br><span class="line">/var/log/wtmp &#123;       &lt;==僅針對 /var/log/wtmp 所設置的參數</span><br><span class="line">    monthly           &lt;==每個月一次，取代每週！</span><br><span class="line">    create 0664 root utmp &lt;==指定新建文件的權限與所屬帳號/群組</span><br><span class="line">    minsize 1M        &lt;==文件大小一定要超過 1M 後才進行 rotate (略過時間參數)</span><br><span class="line">    rotate 1          &lt;==僅保留一個，亦即僅有 wtmp.1 保留而已。</span><br><span class="line">&#125;</span><br><span class="line"># 這個 wtmp 可記錄登陸者與系統重新開機時的時間與來源主機及登陸期間的時間。</span><br><span class="line"># 由於具有 minsize 的參數，因此不見得每個月一定會進行一次喔！要看文件大小。</span><br><span class="line"># 由於僅保留一個登錄文件而已，不滿意的話可以將他改成 rotate 5 吧！</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-18"><a href="#範例-18" class="headerlink" title="範例"></a>範例</h3><h4 id="範例-1"><a href="#範例-1" class="headerlink" title="範例 1"></a>範例 1</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">/root/.pm2/logs/run-checkEdgeAlive.log &#123;</span><br><span class="line">    daily</span><br><span class="line">    dateext</span><br><span class="line">    missingok</span><br><span class="line">    rotate 14</span><br><span class="line">    compress</span><br><span class="line">    notifempty</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="範例-2"><a href="#範例-2" class="headerlink" title="範例 2"></a>範例 2</h4><p>以 /etc/logrotate.d/syslog 這個輪替 rsyslog.service 服務的文件<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">vim /etc/logrotate.d/syslog</span><br><span class="line">/var/log/cron</span><br><span class="line">/var/log/maillog</span><br><span class="line">/var/log/messages</span><br><span class="line">/var/log/secure</span><br><span class="line">/var/log/spooler</span><br><span class="line">&#123;</span><br><span class="line">    sharedscripts</span><br><span class="line">    postrotate</span><br><span class="line">        /bin/kill -HUP `cat /var/run/syslogd.pid 2&gt; /dev/null` 2&gt; /dev/null || true</span><br><span class="line">    endscript</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>文件名：被處理的登錄文件絕對路徑文件名寫在前面，可以使用空白字符分隔多個登錄文件；</li>
<li>參數：上述文件名進行輪替的參數使用 { } 包括起來；</li>
<li>執行腳本：可調用外部指令來進行額外的命令下達，這個設置需與 sharedscripts …. endscript 設置合用才行。至於可用的環境為：<ul>
<li>prerotate：在啟動 logrotate 之前進行的指令，例如修改登錄文件的屬性等動作；</li>
<li>postrotate：在做完 logrotate 之後啟動的指令，例如重新啟動 (kill -HUP) 某個服務！</li>
<li>Prerotate 與 postrotate 對於已加上特殊屬性的文件處理上面，是相當重要的執行程序！</li>
</ul>
</li>
</ul>
<p>那麼 /etc/logrotate.d/syslog 內設置的 5 個文件的輪替功能就變成了：</p>
<ul>
<li>該設置只對 /var/log/ 內的 cron, maillog, messages, secure, spooler 有效；</li>
<li>登錄文件輪替每週一次、保留四個、且輪替下來的登錄文件不進行壓縮(未更改默認值)；</li>
<li>輪替完畢後 (postrotate) 取得 syslog 的 PID 後，以 kill -HUP 重新啟動 syslogd</li>
</ul>
<p>假設我們有針對 /var/log/messages 這個文件增加 chattr +a 的屬性時， 依據 logrotate 的工作原理，我們知道，這個 /var/log/messages 將會被更名成為 /var/log/messages.1 才是。但是由於加上這個 +a 的參數啊，所以更名是不可能成功的！ 那怎麼辦呢？呵呵！就利用 prerotate 與 postrotate 來進行登錄文件輪替前、後所需要作的動作啊！ 果真如此時，那麼你可以這樣修改一下這個文件喔！</p>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">vim /etc/logrotate.d/syslog</span><br><span class="line">/var/log/cron</span><br><span class="line">/var/log/maillog</span><br><span class="line">/var/log/messages</span><br><span class="line">/var/log/secure</span><br><span class="line">/var/log/spooler</span><br><span class="line">&#123;</span><br><span class="line">    sharedscripts</span><br><span class="line">    prerotate</span><br><span class="line">       /usr/bin/chattr -a /var/log/messages</span><br><span class="line">    endscript</span><br><span class="line">    sharedscripts</span><br><span class="line">    postrotate</span><br><span class="line">        /bin/kill -HUP `cat /var/run/syslogd.pid 2&gt; /dev/null` 2&gt; /dev/null || true</span><br><span class="line">        /usr/bin/chattr +a /var/log/messages</span><br><span class="line">    endscript</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>先給他去掉 a 這個屬性，讓登錄文件 /var/log/messages 可以進行輪替的動作</li>
<li>然後執行了輪替之後，再給他加入這個屬性</li>
<li>/bin/kill -HUP … 的意義，這一行的目的在於將系統的 rsyslogd 重新以其參數文件 (rsyslog.conf) 的數據讀入一次！也可以想成是 reload 的意思！ 由於我們創建了一個新的空的記錄文件，如果不執行此一行來重新啟動服務的話， 那麼記錄的時候將會發生錯誤呦！<ul>
<li>kill -HUP: 等同 kill -1, 重啟的意思</li>
</ul>
</li>
</ul>
<p><br></p>
<h4 id="範例-3"><a href="#範例-3" class="headerlink" title="範例 3"></a>範例 3</h4><p>假設你已經創建了 /var/log/admin.log 這個文件， 現在，你想要將該文件加上 +a 這個隱藏標籤，而且設置下面的相關信息：</p>
<ul>
<li>登錄文件輪替一個月進行一次；</li>
<li>該登錄文件若大於 10MB 時，則主動進行輪替，不需要考慮一個月的期限；</li>
<li>保存五個備份文件；</li>
<li>備份文件需要壓縮</li>
</ul>
<p><br></p>
<h5 id="先創建-a-這個屬性"><a href="#先創建-a-這個屬性" class="headerlink" title="先創建 +a 這個屬性"></a>先創建 +a 這個屬性</h5><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# chattr +a /var/log/admin.log</span><br><span class="line">[root@study ~]# lsattr /var/log/admin.log</span><br><span class="line">-----a---------- /var/log/admin.log</span><br><span class="line">[root@study ~]# mv /var/log/admin.log /var/log/admin.log.1</span><br><span class="line">mv: cannot move `/var/log/admin.log&apos; to `/var/log/admin.log.1&apos;: Operation not permitted</span><br><span class="line"># 這裡確定了加入 a 的隱藏屬性！所以 root 無法移動此登錄文件！</span><br></pre></td></tr></table></figure>
<p><br></p>
<h5 id="開始創建-logrotate-的配置文件，增加一個文件在-etc-logrotate-d-內"><a href="#開始創建-logrotate-的配置文件，增加一個文件在-etc-logrotate-d-內" class="headerlink" title="開始創建 logrotate 的配置文件，增加一個文件在 /etc/logrotate.d 內"></a>開始創建 logrotate 的配置文件，增加一個文件在 /etc/logrotate.d 內</h5><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# vim /etc/logrotate.d/admin</span><br><span class="line"># This configuration is from VBird 2015/08/19</span><br><span class="line">/var/log/admin.log &#123;</span><br><span class="line">        monthly   &lt;==每個月進行一次</span><br><span class="line">        size=10M  &lt;==文件大小大於 10M 則開始處置</span><br><span class="line">        rotate 5  &lt;==保留五個！</span><br><span class="line">        compress  &lt;==進行壓縮工作！</span><br><span class="line">        sharedscripts</span><br><span class="line">        prerotate</span><br><span class="line">                /usr/bin/chattr -a /var/log/admin.log</span><br><span class="line">        endscript</span><br><span class="line">        sharedscripts</span><br><span class="line">        postrotate</span><br><span class="line">                /bin/kill -HUP `cat /var/run/syslogd.pid 2&gt; /dev/null` 2&gt; /dev/null || true</span><br><span class="line">                /usr/bin/chattr +a /var/log/admin.log</span><br><span class="line">        endscript</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h5 id="測試一下-logrotate-相關功能的信息顯示："><a href="#測試一下-logrotate-相關功能的信息顯示：" class="headerlink" title="測試一下 logrotate 相關功能的信息顯示："></a>測試一下 logrotate 相關功能的信息顯示：</h5><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# logrotate -v /etc/logrotate.conf</span><br><span class="line">....(前面省略)....</span><br><span class="line">rotating pattern: /var/log/admin.log  10485760 Bytes (5 rotations)</span><br><span class="line">empty log files are rotated, old logs are removed</span><br><span class="line">considering log /var/log/admin.log</span><br><span class="line">  log does not need rotating</span><br><span class="line">not running prerotate script, since no logs will be rotated</span><br><span class="line">not running postrotate script, since no logs were rotated</span><br><span class="line">....(下面省略)....</span><br><span class="line"># 因為還不足一個月，文件也沒有大於 10M，所以不需進行輪替！</span><br></pre></td></tr></table></figure>
<p><br></p>
<h5 id="測試一下強制-logrotate-與相關功能的信息顯示："><a href="#測試一下強制-logrotate-與相關功能的信息顯示：" class="headerlink" title="測試一下強制 logrotate 與相關功能的信息顯示："></a>測試一下強制 logrotate 與相關功能的信息顯示：</h5><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@study ~]# logrotate -vf /etc/logrotate.d/admin</span><br><span class="line">reading config file /etc/logrotate.d/admin</span><br><span class="line">reading config file /etc/logrotate.d/admin</span><br><span class="line"></span><br><span class="line">Handling 1 logs</span><br><span class="line"></span><br><span class="line">rotating pattern: /var/log/admin.log  forced from command line (5 rotations)</span><br><span class="line">empty log files are rotated, old logs are removed</span><br><span class="line">considering log /var/log/admin.log</span><br><span class="line">  log needs rotating</span><br><span class="line">rotating log /var/log/admin.log, log-&gt;rotateCount is 5</span><br><span class="line">dateext suffix &apos;-20150820&apos;</span><br><span class="line">glob pattern &apos;-[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]&apos;</span><br><span class="line">renaming /var/log/admin.log.5.gz to /var/log/admin.log.6.gz (rotatecount 5, logstart 1, i 5),</span><br><span class="line">old log /var/log/admin.log.5.gz does not exist</span><br><span class="line">renaming /var/log/admin.log.4.gz to /var/log/admin.log.5.gz (rotatecount 5, logstart 1, i 4),</span><br><span class="line">old log /var/log/admin.log.4.gz does not exist</span><br><span class="line">renaming /var/log/admin.log.3.gz to /var/log/admin.log.4.gz (rotatecount 5, logstart 1, i 3),</span><br><span class="line">old log /var/log/admin.log.3.gz does not exist</span><br><span class="line">renaming /var/log/admin.log.2.gz to /var/log/admin.log.3.gz (rotatecount 5, logstart 1, i 2),</span><br><span class="line">old log /var/log/admin.log.2.gz does not exist</span><br><span class="line">renaming /var/log/admin.log.1.gz to /var/log/admin.log.2.gz (rotatecount 5, logstart 1, i 1),</span><br><span class="line">old log /var/log/admin.log.1.gz does not exist</span><br><span class="line">renaming /var/log/admin.log.0.gz to /var/log/admin.log.1.gz (rotatecount 5, logstart 1, i 0),</span><br><span class="line">old log /var/log/admin.log.0.gz does not exist</span><br><span class="line">log /var/log/admin.log.6.gz doesn&apos;t exist -- won&apos;t try to dispose of it</span><br><span class="line">running prerotate script</span><br><span class="line">fscreate context set to system_u:object_r:var_log_t:s0</span><br><span class="line">renaming /var/log/admin.log to /var/log/admin.log.1</span><br><span class="line">running postrotate script</span><br><span class="line">compressing log with: /bin/gzip</span><br><span class="line"></span><br><span class="line">[root@study ~]# lsattr /var/log/admin.log*</span><br><span class="line">-----a---------- /var/log/admin.log</span><br><span class="line">---------------- /var/log/admin.log.1.gz  &lt;==有壓縮過喔！</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="command-true-patten"><a href="#command-true-patten" class="headerlink" title="command || true patten"></a><code>command || true</code> patten</h2><p>目前大部分的系統遵循 <code>set -e</code> (Exit immediately if a command exits with a non-zero status.) 規則，所以為了避免一些小錯誤中斷了 command 的執行，所以使用 <code>command || true</code> patten<br>例如 <code>rmdir ... || true</code>, 這樣就算 remove directory 失敗了， command 也不會中斷執行。</p>
<h2 id="timedatectl"><a href="#timedatectl" class="headerlink" title="timedatectl"></a>timedatectl</h2><h3 id="語法-33"><a href="#語法-33" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">timedatectl [commamd]</span><br><span class="line">選項與參數：</span><br><span class="line">list-timezones ：列出系統上所有支持的時區名稱</span><br><span class="line">set-timezone   ：設置時區位置</span><br><span class="line">set-time       ：設置時間</span><br><span class="line">set-ntp        ：設置網絡校時系統</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-19"><a href="#範例-19" class="headerlink" title="範例"></a>範例</h3><h4 id="顯示目前的時區與時間等信息"><a href="#顯示目前的時區與時間等信息" class="headerlink" title="顯示目前的時區與時間等信息"></a>顯示目前的時區與時間等信息</h4><ul>
<li><p>指令</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">timedatectl</span><br></pre></td></tr></table></figure>
</li>
<li><p>輸出</p>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">      Local time: Tue 2015-09-01 19:50:09 CST  # 本地時間</span><br><span class="line">  Universal time: Tue 2015-09-01 11:50:09 UTC  # UTC 時間，可稱為格林威治標準時間</span><br><span class="line">        RTC time: Tue 2015-09-01 11:50:12</span><br><span class="line">        Timezone: Asia/Taipei (CST, +0800)     # 就是時區囉！</span><br><span class="line">     NTP enabled: no</span><br><span class="line">NTP synchronized: no</span><br><span class="line"> RTC in local TZ: no</span><br><span class="line">      DST active: n/a</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h4 id="顯示出是否有-New-York-時區？若有，則請將目前的時區更新一下"><a href="#顯示出是否有-New-York-時區？若有，則請將目前的時區更新一下" class="headerlink" title="顯示出是否有 New_York 時區？若有，則請將目前的時區更新一下"></a>顯示出是否有 New_York 時區？若有，則請將目前的時區更新一下</h4><ul>
<li>查詢是否有 New York 時區<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">timedatectl list-timezones | grep -i new</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>輸出:<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">America/New_York</span><br><span class="line">America/North_Dakota/New_Salem</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>設定時區</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">timedatectl <span class="hljs-built_in">set</span>-timezone <span class="hljs-string">"America/New_York"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>確認結果</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">timedatectl</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>範例輸出：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">    Local time: Tue 2015-09-01 07:53:24 EDT</span><br><span class="line">Universal time: Tue 2015-09-01 11:53:24 UTC</span><br><span class="line">      RTC time: Tue 2015-09-01 11:53:28</span><br><span class="line">      Timezone: America/New_York (EDT, -0400)</span><br></pre></td></tr></table></figure></p>
<h4 id="時間點調整"><a href="#時間點調整" class="headerlink" title="時間點調整"></a>時間點調整</h4><ul>
<li><p>指令</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">timedatectl <span class="hljs-built_in">set</span>-time <span class="hljs-string">"2019-09-30 09:00"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>時間格式: <code>yyyy-mm-dd HH:MM</code></p>
</li>
</ul>
<h2 id="ntpdate"><a href="#ntpdate" class="headerlink" title="ntpdate"></a>ntpdate</h2><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">ntpdate tock.stdtime.gov.tw</span><br></pre></td></tr></table></figure>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">hwclock -w</span><br></pre></td></tr></table></figure>
<p>上述的 tock.stdtime.gov.tw 指的是臺灣地區國家標準實驗室提供的時間服務器，如果你在臺灣本島上，建議使用臺灣提供的時間服務器來更新你的服務器時間， 速度會比較快些～至於 hwclock 則是將正確的時間寫入你的 BIOS 時間記錄內！如果確認可以執行，未來應該可以使用 crontab 來更新系統時間吧！</p>
<p><br><br><br><br><br></p>
<h2 id="localectl"><a href="#localectl" class="headerlink" title="localectl"></a>localectl</h2><h3 id="語法-34"><a href="#語法-34" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">localectl</span><br><span class="line">   System Locale: LANG=zh_TW.utf8             # 下面這些數據就是“系統語系”</span><br><span class="line">                  LC_NUMERIC=zh_TW.UTF-8</span><br><span class="line">                  LC_TIME=zh_TW.UTF-8</span><br><span class="line">                  LC_MONETARY=zh_TW.UTF-8</span><br><span class="line">                  LC_PAPER=zh_TW.UTF-8</span><br><span class="line">                  LC_MEASUREMENT=zh_TW.UTF-8</span><br><span class="line">       VC Keymap: cn</span><br><span class="line">      X11 Layout: cn</span><br><span class="line">     X11 Options: grp:ctrl_shift_toggle</span><br><span class="line"></span><br><span class="line">[root@study ~]# locale</span><br><span class="line">LANG=zh_TW.utf8            # 下面的則是“當前這個軟件的語系”數據！</span><br><span class="line">LC_CTYPE=&quot;en_US.utf8&quot;</span><br><span class="line">LC_NUMERIC=&quot;en_US.utf8&quot;</span><br><span class="line">.....(中間省略).....</span><br><span class="line">LC_ALL=en_US.utf8</span><br></pre></td></tr></table></figure>
<h3 id="範例-20"><a href="#範例-20" class="headerlink" title="範例"></a>範例</h3><p>如何改成英文語系的登陸界面？</p>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">localectl set-locale LANG=en_US.utf8</span><br><span class="line">systemctl isolate multi-user.target</span><br><span class="line">systemctl isolate graphical.target</span><br></pre></td></tr></table></figure>
<h2 id="dpkg"><a href="#dpkg" class="headerlink" title="dpkg"></a>dpkg</h2><h3 id="列出所有-dpkg-安裝的套件"><a href="#列出所有-dpkg-安裝的套件" class="headerlink" title="列出所有 dpkg 安裝的套件"></a>列出所有 dpkg 安裝的套件</h3><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">dpkg -l | less</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="tee"><a href="#tee" class="headerlink" title="tee"></a>tee</h2><p>tee 可以讓 standard output 轉存一份到文件內並將同樣的數據繼續送到屏幕去處理！ 這樣除了可以讓我們同時分析一份數據並記錄下來之外，還可以作為處理一份數據的中間暫存盤記錄之用！ tee 這傢伙在很多選擇/填充的認證考試中很容易考呢！</p>
<p><img src="https://lh3.googleusercontent.com/pzdhfNflqtMI6cZjYXZVg9tJHaT5pJ-BxwH4MVG-niRbTDO4ex_SMTtevellUzgvtlI0UF1DlITGSe0cRjhsHF17f6HbMoVgrP665q0eJJ6mluUn9kmPhGjKG6t1QEQ6Mb8rB3oqLry8_-J06MMkEy2t_YJ6Kze2QVN_p7e72DRdHoNCmSCDUBGvHHRfJrystXFHqHq3kmN4zjTjaXIuXuapEgpLmxriroXgJP90pX5JUNylr60H20WEdT6WHHK9P2m7cDFVXUAvlIHv3P5l-AnxfmpWnnzxQDjYM_EzevIcs5-_xWMQ-E37PmFY2cISVZqJCy2-2sDhpi1aDVrFRK-yILq_yShfWcCiy-A2Lt2aIokyTbr05ISh6FlMAMmdXE5DU7mWYWfzNg7NruNJIwaD2BJiIQrXNvZB_W6ObUJeQqGXu8JI-oYLEm_SsLOuo-VBTY-ifmMZpJoaOMmaybwtRO-ZRWqhiOyT26Xse1a6rUkgCbmwRNFzjawQI9UF8dNRtJfQylNiUxFq8MD3XyNQH1kfPWDzSX_Uk2nDVB7MaRn5fX8btMxKM2a4DopA81ZYRXsc5WDcZe2cvFZlUJ5bRVEGETcznIESVnmA0GjhLBWBVeCc2no57UpB1bSmOUURZbkgcy3PQ-kyMEhY1ldFg2Kbp5GMPEoF5gJV60cOHg9NU9UwBS1sTuevj-HtH7WPa_hZ985HS3fZYc-xqFD7WPAxn0CfQYrOzxTqzw9-pyI2=w912-h234-no" alt></p>
<p><br></p>
<h3 id="語法-35"><a href="#語法-35" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[dmtsai@study ~]$ tee [-a] file</span><br><span class="line">選項與參數：</span><br><span class="line">-a  ：以累加 (append) 的方式，將數據加入 file 當中！</span><br><span class="line"></span><br><span class="line">[dmtsai@study ~]$ last | tee last.list | cut -d &quot; &quot; -f1</span><br><span class="line"># 這個範例可以讓我們將 last 的輸出存一份到 last.list 文件中；</span><br><span class="line"></span><br><span class="line">[dmtsai@study ~]$ ls -l /home | tee ~/homefile | more</span><br><span class="line"># 這個範例則是將 ls 的數據存一份到 ~/homefile ，同時屏幕也有輸出訊息！</span><br><span class="line"></span><br><span class="line">[dmtsai@study ~]$ ls -l / | tee -a ~/homefile | more</span><br><span class="line"># 要注意！ tee 後接的文件會被覆蓋，若加上 -a 這個選項則能將訊息累加。</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h2><h3 id="語法-36"><a href="#語法-36" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[dmtsai@study ~]$ sed [-nefr] [動作]</span><br><span class="line">選項與參數：</span><br><span class="line">-n  ：使用安靜(silent)模式。在一般 sed 的用法中，所有來自 STDIN 的數據一般都會被列出到屏幕上。</span><br><span class="line">      但如果加上 -n 參數後，則只有經過 sed 特殊處理的那一行(或者動作)才會被列出來。</span><br><span class="line">-e  ：直接在命令行界面上進行 sed 的動作編輯；</span><br><span class="line">-f  ：直接將 sed 的動作寫在一個文件內， -f filename 則可以執行 filename 內的 sed 動作；</span><br><span class="line">-r  ：sed 的動作支持的是延伸型正則表達式的語法。(默認是基礎正則表達式語法)</span><br><span class="line">-i  ：直接修改讀取的文件內容，而不是由屏幕輸出。</span><br><span class="line"></span><br><span class="line">動作說明：  [n1[,n2]]function</span><br><span class="line">n1, n2 ：不見得會存在，一般代表“選擇進行動作的行數”，舉例來說，如果我的動作</span><br><span class="line">         是需要在 10 到 20 行之間進行的，則“ 10,20[動作行為] ”</span><br><span class="line"></span><br><span class="line">function 有下面這些咚咚：</span><br><span class="line">a   ：新增， a 的後面可以接字串，而這些字串會在新的一行出現(目前的下一行)～</span><br><span class="line">c   ：取代， c 的後面可以接字串，這些字串可以取代 n1,n2 之間的行！</span><br><span class="line">d   ：刪除，因為是刪除啊，所以 d 後面通常不接任何咚咚；</span><br><span class="line">i   ：插入， i 的後面可以接字串，而這些字串會在新的一行出現(目前的上一行)；</span><br><span class="line">p   ：打印，亦即將某個選擇的數據印出。通常 p 會與參數 sed -n 一起運行～</span><br><span class="line">s   ：取代，可以直接進行取代的工作哩！通常這個 s 的動作可以搭配正則表達式！</span><br><span class="line">      例如 1,20s/old/new/g 就是啦！</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-21"><a href="#範例-21" class="headerlink" title="範例"></a>範例</h3><h4 id="範例一"><a href="#範例一" class="headerlink" title="範例一"></a>範例一</h4><p>將 /etc/passwd 的內容列出並且打印行號，同時，請將第 2~5 行刪除！<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">nl /etc/passwd | sed <span class="hljs-string">'2,5d'</span></span><br></pre></td></tr></table></figure></p>
<p>輸出：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">6  sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="line">7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br></pre></td></tr></table></figure></p>
<ul>
<li>原本應要下達 sed -e ，沒有 -e 也行</li>
<li>sed 後面接的動作，請務必以 ‘’ 兩個單引號括住</li>
<li>如果只要刪除第 2 行，可以使用 <code>nl /etc/passwd | sed &#39;2d&#39;</code> </li>
<li>若是要刪除第 3 到最後一行，則是 <code>nl /etc/passwd | sed &#39;3,$d&#39;</code></li>
</ul>
<p><br></p>
<h4 id="範例二"><a href="#範例二" class="headerlink" title="範例二"></a>範例二</h4><p>承上題，在第二行後(亦即是加在第三行)加上“drink tea?”字樣！<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">nl /etc/passwd | sed <span class="hljs-string">'2a drink tea'</span></span><br></pre></td></tr></table></figure></p>
<p>輸出：<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">2  bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">drink tea</span><br><span class="line">3  daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br></pre></td></tr></table></figure></p>
<ul>
<li>如果是要在第二行前呢？ <code>nl /etc/passwd | sed &#39;2i drink tea&#39;</code> </li>
</ul>
<p><br></p>
<h4 id="範例三"><a href="#範例三" class="headerlink" title="範例三"></a>範例三</h4><p>在第二行後面加入兩行字，例如“Drink tea or …..”與“drink beer?”<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">nl /etc/passwd | sed &apos;2a Drink tea or ......\</span><br><span class="line">&gt; drink beer ?&apos;</span><br></pre></td></tr></table></figure></p>
<p>輸出:<br><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">2  bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">Drink tea or ......</span><br><span class="line">drink beer ?</span><br><span class="line">3  daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br></pre></td></tr></table></figure></p>
<ul>
<li>可以新增好幾行”但是每一行之間都必須要以反斜線 <code>\</code></li>
</ul>
<p><br></p>
<h4 id="範例四"><a href="#範例四" class="headerlink" title="範例四"></a>範例四</h4><p>搜尋檔案中有 <strong>gzip_</strong> 的每一行, 將該行中的 <code>#</code> 取代為空白, 簡單來說, 就是 uncomment 啦<br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">sed -i <span class="hljs-string">'/gzip_/ s/#\ //g'</span> /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure></p>
<p>結果前後比較：<br><img src="https://lh3.googleusercontent.com/chhghZWzziGWqyIby201KuMqTvUYYYxhRHDtBxgHrR6GRDRwbt3OLGqK8KjxgfBDhpcBvDjAsRknThJ1Hbvtf571SsMs4zCZEnjNkO72bQ4VFqlG2NjN5Tqj16eTZyUl51rTIR1qxPccQCYLJgDLMc5MWrSZBxbnoOyxvVLugwYiTmodZCXnWfADCtKwWOS1cgWkFNzjOKfsNlGTPtzgEOXleGVV-kEArO7UfgrAe0GwGnu89adWeC1Ik2VYz0qLgJJlSrtiiXCQo6DwSwoBqwyikRph_aZrCdAGf3c0hmGQLzpYs3juia0wZjTsf41zk0vOO8V31RuwuqW8_GBNATPweny30XsXsN0ytAFet_yYTNOdmZEA7g8n_8SdvdhNT02VLMdG63BSoDl5NMQ8iacTFs9gFBg2orFLTpcS5d8uS5bmZ6lrJf1_ydFBhP7JCI9SZvlGfHzY8_ywqcyV_5329HOQZ8ZNE0nQ0o8w71Hc53LpXV9FKZ76iGnESBblQryhYm4taD4ri5crFGU3QmVXeCH2BE7oQ0JoQB_JLtHQNkzR20qwYixsKkeA0TbAajnEXiVgGZ4C70A2tVr_k4-vPxKq3JFopYmza1D3NfJsVLKLhW8JbGoUoy-0BC7zuMk0QhvjqVqP6eUGleQgY5nekURG-3xYX0jAlqwI7EYDKyD4YnhLZq3iFWZkFOT_V8ucAWsSp2KQMby7-1H5M67HWukvduDxfXe9EqFNdZsCVSrB=w955-h386-no" alt></p>
<p><br><br><br><br><br></p>
<h2 id="替換變量的值"><a href="#替換變量的值" class="headerlink" title="替換變量的值"></a>替換變量的值</h2><p>將變量中的 <strong>sbin</strong> 替換成 <strong>SBIN</strong><br><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;PATH//sbin/SBIN&#125;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="route"><a href="#route" class="headerlink" title="route"></a>route</h2><p>[root@www ~]# route [-n]<br>選項與參數：<br>-n ： 將主機名稱以 IP 的方式顯示</p>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@www ~]# route</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref  Use Iface</span><br><span class="line">192.168.0.0     *               255.255.255.0   U     0      0      0 eth0</span><br><span class="line">127.0.0.0       *               255.0.0.0       U     0      0      0 lo</span><br><span class="line">default         192.168.0.254   0.0.0.0         UG    0      0      0 eth0</span><br></pre></td></tr></table></figure>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@www ~]# route -n</span><br><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref  Use Iface</span><br><span class="line">192.168.0.0     0.0.0.0         255.255.255.0   U     0      0      0 eth0</span><br><span class="line">127.0.0.0       0.0.0.0         255.0.0.0       U     0      0      0 lo</span><br><span class="line">0.0.0.0         192.168.0.254   0.0.0.0         UG    0      0      0 eth0</span><br><span class="line"></span><br><span class="line"># 上面輸出的資料共有八個欄位，你需要注意的有幾個地方：</span><br><span class="line"># Destination ：其實就是 Network 的意思；</span><br><span class="line"># Gateway     ：就是該介面的 Gateway 那個 IP 啦！若為 0.0.0.0 表示不需要額外的 IP；</span><br><span class="line"># Genmask     ：就是 Netmask 啦！與 Destination 組合成為一部主機或網域；</span><br><span class="line"># Flags       ：共有多個旗標可以來表示該網域或主機代表的意義：</span><br><span class="line">#               U：代表該路由可用；</span><br><span class="line">#               G：代表該網域需要經由 Gateway 來幫忙轉遞；</span><br><span class="line">#               H：代表該行路由為一部主機，而非一整個網域；</span><br><span class="line"># Iface       ：就是 Interface (介面) 的意思。</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="jq"><a href="#jq" class="headerlink" title="jq"></a>jq</h2><ul>
<li>取得來源 object 裡的一個 property, 並轉為 raw 輸出<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">node test.js | jq -r <span class="hljs-string">'.propertyName'</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="arp"><a href="#arp" class="headerlink" title="arp"></a>arp</h2><h3 id="語法-37"><a href="#語法-37" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@www ~]# arp -[nd] hostname</span><br><span class="line">[root@www ~]# arp -s hostname(IP) Hardware_address</span><br><span class="line">選項與參數：</span><br><span class="line">-n ：將主機名稱以 IP 的型態顯示</span><br><span class="line">-d ：將 hostname 的 hardware_address 由 ARP table 當中刪除掉</span><br><span class="line">-s ：設定某個 IP 或 hostname 的 MAC 到 ARP table 當中</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-22"><a href="#範例-22" class="headerlink" title="範例"></a>範例</h3><ul>
<li>列出目前主機上記載的 IP/MAC 對應的 ARP 表格<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">arp -n</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">Address            HWtype  HWaddress           Flags Mask    Iface</span><br><span class="line">192.168.1.100      ether   00:01:03:01:02:03      C          eth0</span><br><span class="line">192.168.1.240      ether   00:01:03:01:DE:0A      C          eth0</span><br><span class="line">192.168.1.254      ether   00:01:03:55:74:AB      C          eth0</span><br></pre></td></tr></table></figure>
<ul>
<li>將 192.168.1.100 那部主機的網卡卡號直接寫入 ARP 表格中<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">arp -s 192.168.1.100  01:00:2D:23:A1:0E</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="SBIT"><a href="#SBIT" class="headerlink" title="SBIT"></a>SBIT</h2><h3 id="語法-38"><a href="#語法-38" class="headerlink" title="語法"></a>語法</h3><figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">chmod 1xxx directoryName</span><br></pre></td></tr></table></figure>
<p>或是建立時給予權限</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">insatll -d -o ownerName -g groupName -m 1xxx directoryName</span><br></pre></td></tr></table></figure>
<ul>
<li>只對目錄有效</li>
<li>一般來說, 任意的使用者, 只要對該目錄有 wx 的權限, 都可以 <code>進去該資料夾</code> 以及 <code>刪除該資料夾內的檔案(資料夾)</code></li>
<li>加上 SBIT 的屬性之後, 只有 <code>該目錄的擁有者</code>, <code>root</code>, <code>檔案的建立者</code> 才可以刪除該目錄內的檔案(或資料夾)</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h2><h3 id="語法-39"><a href="#語法-39" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">ifconfig &#123;interface&#125; &#123;up|down&#125;  &lt;== 觀察與啟動介面</span><br><span class="line">ifconfig interface &#123;options&#125;    &lt;== 設定與修改介面</span><br><span class="line">選項與參數：</span><br><span class="line">interface：網路卡介面代號，包括 eth0, eth1, ppp0 等等</span><br><span class="line">options  ：可以接的參數，包括如下：</span><br><span class="line">    up, down ：啟動 (up) 或關閉 (down) 該網路介面(不涉及任何參數)</span><br><span class="line">    mtu      ：可以設定不同的 MTU 數值，例如 mtu 1500 (單位為 byte)</span><br><span class="line">    netmask  ：就是子遮罩網路；</span><br><span class="line">    broadcast：就是廣播位址啊！</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-23"><a href="#範例-23" class="headerlink" title="範例"></a>範例</h3><ul>
<li>範例一：觀察所有的網路介面(直接輸入 ifconfig)<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@www ~]# ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr 08:00:27:71:85:BD</span><br><span class="line">          inet addr:192.168.1.100  Bcast:192.168.1.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe80::a00:27ff:fe71:85bd/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:2555 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:70 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000</span><br><span class="line">          RX bytes:239892 (234.2 KiB)  TX bytes:11153 (10.8 KiB)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>eth0：</strong> 就是網路卡的代號，也有 lo 這個 loopback ；<br><strong>HWaddr：</strong> 就是網路卡的硬體位址，俗稱的 MAC 是也；<br><strong>inet addr：</strong> IPv4 的 IP 位址，後續的 Bcast, Mask 分別代表的是 Broadcast 與 netmask 喔！<br><strong>inet6 addr：</strong> 是 IPv6 的版本的 IP ，我們沒有使用，所以略過；<br><strong>MTU：</strong> 就是第二章談到的 MTU 啊！<br><strong>RX：</strong> 那一行代表的是網路由啟動到目前為止的封包接收情況， packets 代表封包數、errors 代表封包發生錯誤的數量、 dropped 代表封包由於有問題而遭丟棄的數量等等<br><strong>TX：</strong> 與 RX 相反，為網路由啟動到目前為止的傳送情況；<br><strong>collisions：</strong> 代表封包碰撞的情況，如果發生太多次， 表示你的網路狀況不太好；<br><strong>txqueuelen：</strong> 代表用來傳輸資料的緩衝區的儲存長度；<br><strong>RX bytes, TX bytes：</strong> 總接收、傳送的位元組總量</p>
<p><br></p>
<ul>
<li>範例二：暫時修改網路介面，給予 eth0 一個 192.168.100.100/24 的參數</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@www ~]# ifconfig eth0 192.168.100.100</span><br><span class="line"># 如果不加任何其他參數，則系統會依照該 IP 所在的 class 範圍，自動的計算出</span><br><span class="line"># netmask 以及 network, broadcast 等 IP 參數，若想改其他參數則：</span><br><span class="line"></span><br><span class="line">[root@www ~]# ifconfig eth0 192.168.100.100 \</span><br><span class="line">&gt; netmask 255.255.255.128 mtu 8000 </span><br><span class="line"># 設定不同參數的網路介面，同時設定 MTU 的數值！</span><br><span class="line"></span><br><span class="line">[root@www ~]# ifconfig eth0 mtu 9000</span><br><span class="line"># 僅修改該介面的 MTU 數值，其他的保持不動！</span><br><span class="line"></span><br><span class="line">[root@www ~]# ifconfig eth0:0 192.168.50.50</span><br><span class="line"># 仔細看那個介面是 eth0:0 喔！那就是在該實體網卡上，再模擬一個網路介面，</span><br><span class="line"># 亦即是在一張網路卡上面設定多個 IP 的意思啦！</span><br><span class="line"></span><br><span class="line">[root@www ~]# ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr 08:00:27:71:85:BD</span><br><span class="line">          inet addr:192.168.100.100  Bcast:192.168.100.127  Mask:255.255.255.128</span><br><span class="line">          inet6 addr: fe80::a00:27ff:fe71:85bd/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:9000  Metric:1</span><br><span class="line">          RX packets:2555 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:70 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000</span><br><span class="line">          RX bytes:239892 (234.2 KiB)  TX bytes:11153 (10.8 KiB)</span><br><span class="line"></span><br><span class="line">eth0:0    Link encap:Ethernet  HWaddr 08:00:27:71:85:BD</span><br><span class="line">          inet addr:192.168.50.50  Bcast:192.168.50.255  Mask:255.255.255.0</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:9000  Metric:1</span><br><span class="line"># 仔細看，是否與硬體有關的資訊都相同啊！沒錯！因為是同一張網卡嘛！</span><br><span class="line"># 那如果想要將剛剛建立的那張 eth0:0 關閉就好，不影響原有的 eth0 呢？</span><br><span class="line"></span><br><span class="line">[root@www ~]# ifconfig eth0:0 down</span><br><span class="line"># 關掉 eth0:0 這個介面。那如果想用預設值啟動 eth1：『ifconfig eth1 up』即可達成</span><br></pre></td></tr></table></figure>
<p><br></p>
<ul>
<li>範例三：將手動的處理全部取消，使用原有的設定值重建網路參數:<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@www ~]# /etc/init.d/network restart</span><br><span class="line"># 剛剛設定的資料全部失效，會以 ifcfg-ethX 的設定為主！</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h2><p><br><br><br><br><br></p>
<h2 id="route-1"><a href="#route-1" class="headerlink" title="route"></a>route</h2><h3 id="語法-40"><a href="#語法-40" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@www ~]# route [-nee]</span><br><span class="line">[root@www ~]# route add [-net|-host] [網域或主機] netmask [mask] [gw|dev]</span><br><span class="line">[root@www ~]# route del [-net|-host] [網域或主機] netmask [mask] [gw|dev]</span><br><span class="line">觀察的參數：</span><br><span class="line">   -n  ：不要使用通訊協定或主機名稱，直接使用 IP 或 port number；</span><br><span class="line">   -ee ：使用更詳細的資訊來顯示</span><br><span class="line">增加 (add) 與刪除 (del) 路由的相關參數：</span><br><span class="line">   -net    ：表示後面接的路由為一個網域；</span><br><span class="line">   -host   ：表示後面接的為連接到單部主機的路由；</span><br><span class="line">   netmask ：與網域有關，可以設定 netmask 決定網域的大小；</span><br><span class="line">   gw      ：gateway 的簡寫，後續接的是 IP 的數值喔，與 dev 不同；</span><br><span class="line">   dev     ：如果只是要指定由那一塊網路卡連線出去，則使用這個設定，後面接 eth0 等</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="範例-24"><a href="#範例-24" class="headerlink" title="範例"></a>範例</h3><h4 id="單純的觀察路由狀態"><a href="#單純的觀察路由狀態" class="headerlink" title="單純的觀察路由狀態"></a>單純的觀察路由狀態</h4><ul>
<li><p>指令1</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">route -n</span><br></pre></td></tr></table></figure>
</li>
<li><p>範例輸出1</p>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 eth0</span><br><span class="line">169.254.0.0     0.0.0.0         255.255.0.0     U     1002   0        0 eth0</span><br><span class="line">0.0.0.0         192.168.1.254   0.0.0.0         UG    0      0        0 eth0</span><br></pre></td></tr></table></figure>
</li>
<li><p>指令2</p>
<figure class="highlight bash hljs"><table><tr><td class="code"><pre><span class="line">route</span><br></pre></td></tr></table></figure>
</li>
<li><p>範例輸出2</p>
</li>
</ul>
<figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">Kernel IP routing table</span><br><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">192.168.1.0     *               255.255.255.0   U     0      0        0 eth0</span><br><span class="line">link-local      *               255.255.0.0     U     1002   0        0 eth0</span><br><span class="line">default         192.168.1.254   0.0.0.0         UG    0      0        0 eth0</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="路由的增加與刪除"><a href="#路由的增加與刪除" class="headerlink" title="路由的增加與刪除"></a>路由的增加與刪除</h4><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@www ~]# route del -net 169.254.0.0 netmask 255.255.0.0 dev eth0</span><br><span class="line"># 上面這個動作可以刪除掉 169.254.0.0/16 這個網域！</span><br><span class="line"># 請注意，在刪除的時候，需要將路由表上面出現的資訊都寫入</span><br><span class="line"># 包括 netmask , dev 等等參數喔！注意注意</span><br><span class="line"></span><br><span class="line">[root@www ~]# route add -net 192.168.100.0 \</span><br><span class="line">&gt; netmask 255.255.255.0 dev eth0</span><br><span class="line"># 透過 route add 來增加一個路由！請注意，這個路由的設定必須要能夠與你的網路互通。</span><br><span class="line"># 舉例來說，如果我下達底下的指令就會顯示錯誤：</span><br><span class="line"># route add -net 192.168.200.0 netmask 255.255.255.0 gw 192.168.200.254</span><br><span class="line"># 因為我的主機內僅有 192.168.1.11 這個 IP ，所以不能直接與 192.168.200.254</span><br><span class="line"># 這個網段直接使用 MAC 互通！這樣說，可以理解嗎？</span><br><span class="line"></span><br><span class="line">[root@www ~]# route add default gw 192.168.1.250</span><br><span class="line"># 增加預設路由的方法！請注意，只要有一個預設路由就夠了喔！</span><br><span class="line"># 同樣的，那個 192.168.1.250 的 IP 也需要能與你的 LAN 溝通才行！</span><br><span class="line"># 在這個地方如果你隨便設定後，記得使用底下的指令重新設定你的網路</span><br><span class="line"># /etc/init.d/network restart</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="輸出資訊意義"><a href="#輸出資訊意義" class="headerlink" title="輸出資訊意義"></a>輸出資訊意義</h3><ul>
<li><p><strong>Destination, Genmask</strong>：這兩個玩意兒就是分別是 network 與 netmask 啦！所以這兩個咚咚就組合成為一個完整的網域囉！</p>
</li>
<li><p><strong>Gateway</strong>：該網域是通過哪個 gateway 連接出去的？如果顯示 0.0.0.0 表示該路由是直接由本機傳送，亦即可以透過區域網路的 MAC 直接傳訊；如果有顯示 IP 的話，表示該路由需要經過路由器 (通訊閘) 的幫忙才能夠傳送出去。</p>
</li>
<li><p><strong>Flags</strong>：總共有多個旗標，代表的意義如下：</p>
<ul>
<li>U (route is up)：該路由是啟動的；</li>
<li>H (target is a host)：目標是一部主機 (IP) 而非網域；</li>
<li>G (use gateway)：需要透過外部的主機 (gateway) 來轉遞封包；</li>
<li>R (reinstate route for dynamic routing)：使用動態路由時，恢復路由資訊的旗標；</li>
<li>D (dynamically installed by daemon or redirect)：已經由服務或轉 port 功能設定為動態路由</li>
<li>M (modified from routing daemon or redirect)：路由已經被修改了；</li>
<li>! (reject route)：這個路由將不會被接受(用來抵擋不安全的網域！)</li>
</ul>
</li>
<li><p><strong>Iface</strong>：這個路由傳遞封包的介面。</p>
</li>
</ul>
<p><br><br><br><br><br></p>
<h2 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h2><h3 id="語法-41"><a href="#語法-41" class="headerlink" title="語法"></a>語法</h3><figure class="highlight plain hljs"><table><tr><td class="code"><pre><span class="line">[root@www ~]# ip [option] [動作] [指令]</span><br><span class="line">選項與參數：</span><br><span class="line">option ：設定的參數，主要有：</span><br><span class="line">    -s ：顯示出該裝置的統計數據(statistics)，例如總接受封包數等；</span><br><span class="line">動作：亦即是可以針對哪些網路參數進行動作，包括有：</span><br><span class="line">    link  ：關於裝置 (device) 的相關設定，包括 MTU, MAC 位址等等</span><br><span class="line">    addr/address ：關於額外的 IP 協定，例如多 IP 的達成等等；</span><br><span class="line">    route ：與路由有關的相關設定</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br></p>
<h2 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h2><ul>
<li><strong>apt 底層包的是？</strong> dpkg</li>
<li><strong>dpkg 安裝 package 時, 會將 *.deb 放在?</strong> /var/cache/apt/archives/</li>
<li><strong>路由的排列有順序之分嗎？</strong> 有哦</li>
<li><strong>路由排列的規則？</strong> 由小網域到大網域</li>
</ul>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/zh-tw/tags/Linux/">#Linux</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/zh-tw/buildSftpServerOnLinux/">在 Linux 上建立一個 SFTP Server</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/zh-tw/cloudFunctionsQwikStartCommandLine/">Cloud Functions 初探 - Command Line</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="sharethis-inline-share-buttons"></div>
<script type="text/javascript" src="//platform-api.sharethis.com/js/sharethis.js#property=5c72643b9ea706001139fd89&amp;product=inline-share-buttons" async="async"></script>

</div>



<div class="comments">
    <h3 class="title is-4">留言</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'https://tn710617.github.io/zh-tw/Linux/';
        this.page.identifier = 'zh-tw/Linux/';
        
        this.language = 'zh';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'rayscodingjourney' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2019 Ray&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            
                       <a class="navbar-item" title="GitHub" href="https://github.com/tn710617">
                           
                           <i class="fab fa-github"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="E-Mail" href="mailto:tn710617@gmail.com">
                           
                           <i class="far fa-envelope"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="Linkedin" href="https://www.linkedin.com/in/ray-lee-99315315a">
                           
                           <i class="fab fa-linkedin"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="Facebook" href="https://www.facebook.com/profile.php?id=100001626039430">
                           
                           <i class="fab fa-facebook"></i>
                           
                       </a>
                          
                       <a class="navbar-item" title="Skype" href="skype:adad0310?call|chat">
                           
                           <i class="fab fa-skype"></i>
                           
                       </a>
                          
                       
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    


<script src="/js/script.js"></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="站內搜尋">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '頁面',
                CATEGORIES: '分類',
                TAGS: '標籤',
                UNTITLED: '(無標題)',
            },
            CONTENT_URL: '/content.zh-tw.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script>
    
</body>
</html>